<!DOCTYPE html>
<html lang="fr-FR">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>13 Décomposition de la diversité phylogénétique et fonctionnelle | Mesures de la Biodiversité</title>
<meta name="author" content="Eric Marcon">
<meta name="description" content="L’entropie phylogénétique et l’entropie de Ricotta et Szeidl se décomposent comme l’entropie HCDT. La diversité \(\beta\) phylogénétique et la diversité \(\beta\) de Leinster et Cobbold sont des...">
<meta name="generator" content="bookdown 0.41 with bs4_book()">
<meta property="og:title" content="13 Décomposition de la diversité phylogénétique et fonctionnelle | Mesures de la Biodiversité">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/EricMarcon/MesuresBioDiv2/décomposition-de-la-diversité-phylogénétique-et-fonctionnelle.html">
<meta property="og:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<meta property="og:description" content="L’entropie phylogénétique et l’entropie de Ricotta et Szeidl se décomposent comme l’entropie HCDT. La diversité \(\beta\) phylogénétique et la diversité \(\beta\) de Leinster et Cobbold sont des...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="13 Décomposition de la diversité phylogénétique et fonctionnelle | Mesures de la Biodiversité">
<meta name="twitter:description" content="L’entropie phylogénétique et l’entropie de Ricotta et Szeidl se décomposent comme l’entropie HCDT. La diversité \(\beta\) phylogénétique et la diversité \(\beta\) de Leinster et Cobbold sont des...">
<meta name="twitter:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-C1B3PLBCM6"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-C1B3PLBCM6');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Mesures de la Biodiversité</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Motivation</a></li>
<li><a class="" href="calculs-et-donn%C3%A9es.html">Calculs et données</a></li>
<li><a class="" href="notations.html">Notations</a></li>
<li class="book-part">Notions</li>
<li><a class="" href="chap-Notions.html"><span class="header-section-number">1</span> Notions de Diversité</a></li>
<li><a class="" href="chap-Outils.html"><span class="header-section-number">2</span> Outils</a></li>
<li class="book-part">Diversité neutre d’une communauté</li>
<li><a class="" href="chap-MesuresNeutres.html"><span class="header-section-number">3</span> Mesures neutres de la diversité \(\alpha\) ou \(\gamma\)</a></li>
<li><a class="" href="entropie.html"><span class="header-section-number">4</span> Entropie</a></li>
<li><a class="" href="sec-Equitabilite.html"><span class="header-section-number">5</span> Équitabilité</a></li>
<li class="book-part">Diversité fonctionnelle et phylogénétique</li>
<li><a class="" href="chap-cadrephyfonc.html"><span class="header-section-number">6</span> Cadre</a></li>
<li><a class="" href="mesures-particuli%C3%A8res.html"><span class="header-section-number">7</span> Mesures particulières</a></li>
<li><a class="" href="chap-Phyloentropie.html"><span class="header-section-number">8</span> Entropie phylogénétique</a></li>
<li><a class="" href="chap-LeinsterCobbold.html"><span class="header-section-number">9</span> Diversité de Leinster et Cobbold</a></li>
<li class="book-part">Diversité beta et décomposition</li>
<li><a class="" href="sec-betaCadre.html"><span class="header-section-number">10</span> Cadre</a></li>
<li><a class="" href="chap-BetaPaires.html"><span class="header-section-number">11</span> Diversité de différentiation</a></li>
<li><a class="" href="chap-DedompHCDT.html"><span class="header-section-number">12</span> Décomposition de l’entropie HCDT</a></li>
<li><a class="active" href="d%C3%A9composition-de-la-diversit%C3%A9-phylog%C3%A9n%C3%A9tique-et-fonctionnelle.html"><span class="header-section-number">13</span> Décomposition de la diversité phylogénétique et fonctionnelle</a></li>
<li><a class="" href="tests-de-significativit%C3%A9.html"><span class="header-section-number">14</span> Tests de significativité</a></li>
<li><a class="" href="sec-betaAutres.html"><span class="header-section-number">15</span> Autres approches</a></li>
<li class="book-part">Diversité jointe, diversité structurelle</li>
<li><a class="" href="sec-jointeCadre.html"><span class="header-section-number">16</span> Cadre</a></li>
<li><a class="" href="information-mutuelle.html"><span class="header-section-number">17</span> Information mutuelle</a></li>
<li><a class="" href="chap-DiversiteJointe.html"><span class="header-section-number">18</span> Décomposition de la diversité jointe</a></li>
<li class="book-part">Diversité spatialement explicite</li>
<li><a class="" href="sec-spatialCadre.html"><span class="header-section-number">19</span> Cadre</a></li>
<li><a class="" href="chap-Fisher.html"><span class="header-section-number">20</span> Indice \(\alpha\) de Fisher</a></li>
<li><a class="" href="chap-Accumulation.html"><span class="header-section-number">21</span> Accumulation de la diversité locale</a></li>
<li><a class="" href="diversit%C3%A9-r%C3%A9gionale.html"><span class="header-section-number">22</span> Diversité régionale</a></li>
<li><a class="" href="chap-betasp.html"><span class="header-section-number">23</span> Diversité \(\beta\) spatialement explicite</a></li>
<li class="book-part">Conclusion</li>
<li><a class="" href="sec-conclusionSynthese.html"><span class="header-section-number">24</span> Synthèse</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/EricMarcon/MesuresBioDiv2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="décomposition-de-la-diversité-phylogénétique-et-fonctionnelle" class="section level1" number="13">
<h1>
<span class="header-section-number">13</span> Décomposition de la diversité phylogénétique et fonctionnelle<a class="anchor" aria-label="anchor" href="#d%C3%A9composition-de-la-diversit%C3%A9-phylog%C3%A9n%C3%A9tique-et-fonctionnelle"><i class="fas fa-link"></i></a>
</h1>
<div class="Summary">
<p>L’entropie phylogénétique et l’entropie de Ricotta et Szeidl se décomposent comme l’entropie HCDT.
La diversité <span class="math inline">\(\beta\)</span> phylogénétique et la diversité <span class="math inline">\(\beta\)</span> de Leinster et Cobbold sont des nombres effectifs de communautés, c’est-à-dire des communautés de même poids et dont les espèces seraient totalement dissimilaires qui fourniraient la même entropie <span class="math inline">\(\beta\)</span> que les communautés réelles.</p>
</div>
<p>L’entropie phylogénétique est une combinaison linéaire de l’entropie HCDT donc sa décomposition est identique <span class="citation">(<a href="references.html#ref-Marcon2014b">Marcon et Hérault 2015a</a>)</span>.</p>
<div id="décomposition-de-la-diversité-phylogénétique" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> Décomposition de la diversité phylogénétique<a class="anchor" aria-label="anchor" href="#d%C3%A9composition-de-la-diversit%C3%A9-phylog%C3%A9n%C3%A9tique"><i class="fas fa-link"></i></a>
</h2>
<p>En combinant l’équation <a href="chap-Phyloentropie.html#eq:Hbarq">(8.1)</a> et le tableau <a href="chap-DedompHCDT.html#tab:Decomposition">12.3</a>, on obtient</p>
<p><span class="math display" id="eq:Hqbar">\[\begin{equation}
  \tag{13.1}
  ^{q}\!\bar{H}_{\gamma}\left(T\right)
  = ^{q}\!\bar{H}_{\alpha}\left(T\right)
  + ^{q}\!\bar{H}_{\beta}\left(T\right).
\end{equation}\]</span></p>
<p>L’entropie <span class="math inline">\(\gamma\)</span> est celle de la méta-communauté, l’entropie <span class="math inline">\(\alpha\)</span> est la somme pondérée de celles des communautés, la pondération est libre mais doit respecter <span class="math inline">\(p_s=\sum_i{w_ip_{s|i}}\)</span> :</p>
<p><span class="math display" id="eq:Hqbaralpha">\[\begin{equation}
  \tag{13.2}
  ^{q}\!\bar{H}_{\alpha}\left(T\right)
  = \sum_i{w_i{^{q}_{i}\!\bar{H}_{\alpha}}\left(T\right)}.
\end{equation}\]</span></p>
<p>L’entropie <span class="math inline">\(\beta\)</span> est</p>
<p><span class="math display" id="eq:Hqbarbeta">\[\begin{align}
  \tag{13.3}
  ^{q}\!\bar{H}_{\beta}\left(T\right)
  &amp;= \sum_i{w_i}^{q}_{i}\!\bar{H}_{\beta}\left(T\right)\\
  &amp;= \sum_i{w_i}\sum_k{\frac{T_k}{T}^{q}_{ik}\!H_{\beta}}\\
  &amp;= \sum_i{w_i}\sum_k{\frac{T_k}{T}\sum_u{p^{q}_{k,u,i}\ln_q\frac{p_{k,u,i}}{p_{k,u}}}}
\end{align}\]</span></p>
<p>où <span class="math inline">\(p_{k,u}\)</span> est la probabilité d’observer une des espèces de la branche <span class="math inline">\(u\)</span> de l’arbre à la période <span class="math inline">\(k\)</span> (figure <a href="mesures-particuli%C3%A8res.html#fig:Arbre">7.7</a>) dans la méta-communauté, et <span class="math inline">\(p_{k,u,i}\)</span> la même probabilité dans la communauté <span class="math inline">\(i\)</span>.</p>
<p>La décomposition de l’entropie phylogénétique au sens de <span class="citation">Allen, Kon, et Bar-Yam (<a href="references.html#ref-Allen2009">2009</a>)</span>, c’est-à-dire dans la cas particulier <span class="math inline">\(q=1\)</span>, a été établie par <span class="citation">Mouchet et Mouillot (<a href="references.html#ref-Mouchet2011">2011</a>)</span>.</p>
<p>La fonction <code>DivPart</code> de <em>entropart</em> permet de décomposer l’entropie.
Les résultats contiennent la valeur de la diversité :</p>
<p></p>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Paracou618</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/DivPart.html">DivPart</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">1</span>, <span class="va">Paracou618.MC</span>, Biased <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                Tree <span class="op">=</span> <span class="va">Paracou618.Taxonomy</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## HCDT diversity partitioning of order 1 of metaCommunity 
## Paracou618.MC
##  with correction: UnveilJ UnveilJ UnveilJ
## Phylogenetic or functional diversity was calculated
## according to the tree 
## Paracou618.Taxonomy 
## 
## Diversity is normalized 
## 
## Alpha diversity of communities: 
##     P006     P018 
## 37.42057 53.73643 
## Total alpha diversity of the communities: 
## [1] 43.6882
## Beta diversity of the communities: 
## [1] 1.273686
## Gamma diversity of the metacommunity: 
## [1] 55.64502</code></pre>
<p></p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:DivPartFig"></span>
<img src="MesuresBD_files/figure-html/DivPartFig-1.png" alt="Représentation graphique de la diversité des deux parcelles du jeu de données Paracou618. Les rectangles transparents représentent la diversité neutre, les rectangles hachurés la diversité phylogénétique (l’arbre est la taxonomie des espèces, \(q=1\)). Dans chaque cas, le rectangle le plus large, de hauteur 1, représente la diversité \(\\gamma\). Le rectangle plus haut a pour largeur et longueur les diversités \(\alpha\) et \(\beta\). Les surfaces des deux rectangles sont identiques." width="80%"><p class="caption">
Figure 13.1: Représentation graphique de la diversité des deux parcelles du jeu de données <code>Paracou618</code>. Les rectangles transparents représentent la diversité neutre, les rectangles hachurés la diversité phylogénétique (l’arbre est la taxonomie des espèces, <span class="math inline">\(q=1\)</span>). Dans chaque cas, le rectangle le plus large, de hauteur 1, représente la diversité <span class="math inline">\(\\gamma\)</span>. Le rectangle plus haut a pour largeur et longueur les diversités <span class="math inline">\(\alpha\)</span> et <span class="math inline">\(\beta\)</span>. Les surfaces des deux rectangles sont identiques.
</p>
</div>
<p></p>
<p>La figure <a href="d%C3%A9composition-de-la-diversit%C3%A9-phylog%C3%A9n%C3%A9tique-et-fonctionnelle.html#fig:DivPartFig">13.1</a> donne une représentation graphique de la décomposition de la diversité.
La différence de taille entre les rectangles hachurés et les rectangles transparents est due à la prise en compte de la phylogénie.
La diversité <span class="math inline">\(\gamma\)</span> (rectangles de hauteur 1) est égale au produit des diversités <span class="math inline">\(\alpha\)</span> et <span class="math inline">\(\beta\)</span> (côtés du rectangle plus haut).
Si les communautés étaient de même poids et complètement différentes, c’est à dire contenant des espèces totalement dissimilaires entre communautés <span class="citation">(<a href="references.html#ref-Pavoine2015a">Pavoine, Marcon, et Ricotta 2016</a>)</span>, la hauteur du rectangle serait égale à leur nombre (2 ici).</p>
<p>Code pour réaliser la figure :</p>
<p></p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">Neutre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/DivPart.html">DivPart</a></span><span class="op">(</span><span class="va">q</span>, <span class="va">Paracou618.MC</span>, Biased <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">Neutre</span><span class="op">$</span><span class="va">GammaDiversity</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Ncommunities</span><span class="op">)</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"n"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="st">" / "</span>, <span class="va">gamma</span>, <span class="st">" diversity"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">beta</span>, <span class="st">" diversity"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html">rect</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Neutre</span><span class="op">$</span><span class="va">GammaDiversity</span>, <span class="fl">1</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html">rect</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Neutre</span><span class="op">$</span><span class="va">TotalAlphaDiversity</span>, <span class="va">Neutre</span><span class="op">$</span><span class="va">TotalBetaDiversity</span>, </span>
<span>     lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Phylo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/DivPart.html">DivPart</a></span><span class="op">(</span><span class="va">q</span>, <span class="va">Paracou618.MC</span>, Biased <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                 Tree <span class="op">=</span> <span class="va">Paracou618.Taxonomy</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html">rect</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Phylo</span><span class="op">$</span><span class="va">GammaDiversity</span>, <span class="fl">1</span>, angle<span class="op">=</span><span class="fl">135</span>, density<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html">rect</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Phylo</span><span class="op">$</span><span class="va">TotalAlphaDiversity</span>, <span class="va">Phylo</span><span class="op">$</span><span class="va">TotalBetaDiversity</span>,</span>
<span>     density <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
<div id="partitionnement-de-la-diversité-de-leinster-et-cobbold" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> Partitionnement de la diversité de Leinster et Cobbold<a class="anchor" aria-label="anchor" href="#partitionnement-de-la-diversit%C3%A9-de-leinster-et-cobbold"><i class="fas fa-link"></i></a>
</h2>
<p>Selon les mêmes principes que pour la décomposition de l’entropie HCDT, <span class="citation">Marcon, Zhang, et Hérault (<a href="references.html#ref-Marcon2014e">2014</a>)</span> ont décomposé l’entropie de <span class="citation">Ricotta et Szeidl (<a href="references.html#ref-Ricotta2006b">2006</a>)</span>.
L’entropie <span class="math inline">\(\alpha\)</span> de la communauté <span class="math inline">\(i\)</span> est</p>
<p><span class="math display" id="eq:Hqzialpha">\[\begin{equation}
  \tag{13.4}
  ^q_i\!H^{\mathbf{Z}}_\alpha
  = \frac{1-\sum_s{p_{s|i}{\left(\mathbf{Zp}\right)}^{q-1}_{s|i}}}{q-1}.
\end{equation}\]</span></p>
<p>L’entropie <span class="math inline">\(\alpha\)</span> est la somme pondérée des entropies des communautés :</p>
<p><span class="math display" id="eq:Hqzalpha">\[\begin{equation}
  \tag{13.5}
  ^q\!H^{\mathbf{Z}}_\alpha
  = \sum_i{w_i \, ^q_i\!H^{\mathbf{Z}}_\alpha}
  = \frac{1-\sum_i{w_i\sum_s{p_{s|i}{\left(\mathbf{Zp}\right)}^{q-1}_{s|i}}}}{q-1}.
\end{equation}\]</span></p>
<p>L’entropie <span class="math inline">\(\beta\)</span> est similaire à l’entropie <span class="math inline">\(\beta\)</span> HCDT : c’est la divergence généralisée de Jensen-Shannon entre les distributions de <span class="math inline">\(\mathbf{Zp}\)</span> des communautés.
Formellement :</p>
<p><span class="math display" id="eq:Hqzbeta">\[\begin{equation}
  \tag{13.6}
  ^q\!H^{\mathbf{Z}}_\beta
  =\sum_i{w_i}\sum_{s}{p_{s|i}\left(\ln_q\frac{1}{{\left(\mathbf{Zp}\right)}_s}-\ln_q\frac{1}{{\left(\mathbf{Zp}\right)}_{s|i}}\right)}.
\end{equation}\]</span></p>
<p>La diversité <span class="math inline">\(\beta\)</span> est obtenue en calculant l’exponentielle déformée de la décomposition additive de l’entropie :</p>
<p><span class="math display" id="eq:Dqzbeta">\[\begin{equation}
  \tag{13.7}
  ^q\!D^{\mathbf{Z}}_\beta
  =e^{\frac{^qH^{\mathbf{Z}}}{1+\left(1-q\right)\,{^qH^{\mathbf{Z}}_\alpha}}}_q.
\end{equation}\]</span></p>
<p>La décomposition de la diversité peut être faite directement, sans passer par l’entropie.</p>
<p>L’inverse de <span class="math inline">\(^q\!D^{\mathbf{Z}}_\gamma\)</span> est la moyenne généralisée d’ordre <span class="math inline">\(q-1\)</span> de <span class="math inline">\({\left(\mathbf{Zp}\right)}_s\)</span> :</p>
<p><span class="math display" id="eq:Dqzgamma">\[\begin{equation}
  \tag{13.8}
  \frac{1}{^q\!D^{\mathbf{Z}}_\gamma}
  ={\left[\sum_s{p_s{{\left(\mathbf{Zp}\right)}_s}^{q-1}}\right]}^{\frac{1}{q-1}}
\end{equation}\]</span></p>
<p>Partant de <span class="math inline">\(^{q}\!D_{\gamma} = {^{q}\!D_{\alpha}} {^{q}\!D_{\beta}}\)</span> et de la définition de Routledge de la diversité <span class="math inline">\(\alpha\)</span>, on obtient</p>
<p><span class="math display" id="eq:Dbeta">\[\begin{equation}
  \tag{13.9}
  ^q\!D^{\mathbf{Z}}_\beta
  ={\left[\sum_i{w_i}{\left(\frac{1/^q_i\!D^{\mathbf{Z}}_\alpha}{1/^q\!D^{\mathbf{Z}}_\gamma}\right)}^{q-1}\right]}^{\frac{1}{q-1}}.
\end{equation}\]</span></p>
<p>De la même façon que <span class="math inline">\(1/^q\!D^{\mathbf{Z}}_\gamma\)</span> est la banalité moyenne des espèces, <span class="math inline">\(^q\!D^{\mathbf{Z}}_\beta\)</span> est la banalité moyenne normalisée des communautés, où la banalité normalisée de la communauté <span class="math inline">\(i\)</span> est définie comme <span class="math inline">\({\left(1/^q_i\!D^{\mathbf{Z}}_\alpha\right)}/{\left(1/^q\!D^{\mathbf{Z}}_\gamma\right)}\)</span>, c’est-à-dire la banalité moyenne de ses espèces divisée par celle de la méta-communauté.</p>
<p>La fonction <code>DivPart</code> (comme les autres fonctions avancées de <em>entropart</em>) supporte la décomposition de la diversité de Leinster et Cobbold quand une matrice de similarité lui est passée comme argument à la place d’un arbre phylogénétique pour le calcul de la phylodiversité HCDT :</p>
<p></p>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Matrice de distances fonctionnelles</span></span>
<span><span class="va">DistanceMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Paracou618.dist</span><span class="op">)</span></span>
<span><span class="co"># Transformation en matrice de similarité</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">DistanceMatrix</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">DistanceMatrix</span><span class="op">)</span></span>
<span><span class="co"># Partition de la diversité</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/DivPart.html">DivPart</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">1</span>, <span class="va">Paracou618.MC</span>, Z <span class="op">=</span> <span class="va">Z</span>, Biased <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Similarity-based diversity partitioning of order 1 
## of metaCommunity Paracou618.MC
##  with correction: Best
## Phylogenetic or functional entropy was calculated
## according to the similarity matrix 
## Z 
## 
## Alpha diversity of communities: 
##     P006     P018 
## 1.483722 1.482119 
## Total alpha diversity of the communities: 
## [1] 1.483036
## Beta diversity of the communities: 
##     Best 
## 1.003403 
## Gamma diversity of the metacommunity: 
##     Best 
## 1.488083</code></pre>
<p></p>
<p>Le partitionnement de la diversité fonctionnelle de la méta-communauté <code>Paracou618.MC</code> selon la matrice de distances des traits fonctionnels montre que la diversité <span class="math inline">\(\beta\)</span> est extrêmement faible entre les deux parcelles.</p>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="chap-DedompHCDT.html"><span class="header-section-number">12</span> Décomposition de l’entropie HCDT</a></div>
<div class="next"><a href="tests-de-significativit%C3%A9.html"><span class="header-section-number">14</span> Tests de significativité</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#d%C3%A9composition-de-la-diversit%C3%A9-phylog%C3%A9n%C3%A9tique-et-fonctionnelle"><span class="header-section-number">13</span> Décomposition de la diversité phylogénétique et fonctionnelle</a></li>
<li><a class="nav-link" href="#d%C3%A9composition-de-la-diversit%C3%A9-phylog%C3%A9n%C3%A9tique"><span class="header-section-number">13.1</span> Décomposition de la diversité phylogénétique</a></li>
<li><a class="nav-link" href="#partitionnement-de-la-diversit%C3%A9-de-leinster-et-cobbold"><span class="header-section-number">13.2</span> Partitionnement de la diversité de Leinster et Cobbold</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/EricMarcon/MesuresBioDiv2/blob/master/04-Beta.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/EricMarcon/MesuresBioDiv2/edit/master/04-Beta.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Mesures de la Biodiversité</strong>" was written by Eric Marcon. It was last built on 05/12/2024.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
