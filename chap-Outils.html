<!DOCTYPE html>
<html lang="fr-FR">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2 Outils | Mesures de la Biodiversité</title>
<meta name="author" content="Eric Marcon">
<meta name="description" content="La diversité peut être décrite localement par une courbe d’accumulation (SAC) qui représente le nombre d’espèces échantillonnées en fonction de l’effort. À une échelle plus large, cette courbe...">
<meta name="generator" content="bookdown 0.38 with bs4_book()">
<meta property="og:title" content="2 Outils | Mesures de la Biodiversité">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/EricMarcon/MesuresBioDiv2/chap-Outils.html">
<meta property="og:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<meta property="og:description" content="La diversité peut être décrite localement par une courbe d’accumulation (SAC) qui représente le nombre d’espèces échantillonnées en fonction de l’effort. À une échelle plus large, cette courbe...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2 Outils | Mesures de la Biodiversité">
<meta name="twitter:description" content="La diversité peut être décrite localement par une courbe d’accumulation (SAC) qui représente le nombre d’espèces échantillonnées en fonction de l’effort. À une échelle plus large, cette courbe...">
<meta name="twitter:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-C1B3PLBCM6"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-C1B3PLBCM6');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Mesures de la Biodiversité</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Motivation</a></li>
<li><a class="" href="calculs-et-donn%C3%A9es.html">Calculs et données</a></li>
<li><a class="" href="notations.html">Notations</a></li>
<li class="book-part">Notions</li>
<li><a class="" href="chap-Notions.html"><span class="header-section-number">1</span> Notions de Diversité</a></li>
<li><a class="active" href="chap-Outils.html"><span class="header-section-number">2</span> Outils</a></li>
<li class="book-part">Diversité neutre d’une communauté</li>
<li><a class="" href="chap-MesuresNeutres.html"><span class="header-section-number">3</span> Mesures neutres de la diversité \(\alpha\) ou \(\gamma\)</a></li>
<li><a class="" href="entropie.html"><span class="header-section-number">4</span> Entropie</a></li>
<li><a class="" href="sec-Equitabilite.html"><span class="header-section-number">5</span> Équitabilité</a></li>
<li class="book-part">Diversité fonctionnelle et phylogénétique</li>
<li><a class="" href="chap-cadrephyfonc.html"><span class="header-section-number">6</span> Cadre</a></li>
<li><a class="" href="mesures-particuli%C3%A8res.html"><span class="header-section-number">7</span> Mesures particulières</a></li>
<li><a class="" href="chap-Phyloentropie.html"><span class="header-section-number">8</span> Entropie phylogénétique</a></li>
<li><a class="" href="chap-LeinsterCobbold.html"><span class="header-section-number">9</span> Diversité de Leinster et Cobbold</a></li>
<li class="book-part">Diversité beta et décomposition</li>
<li><a class="" href="sec-betaCadre.html"><span class="header-section-number">10</span> Cadre</a></li>
<li><a class="" href="chap-BetaPaires.html"><span class="header-section-number">11</span> Diversité de différentiation</a></li>
<li><a class="" href="chap-DedompHCDT.html"><span class="header-section-number">12</span> Décomposition de l’entropie HCDT</a></li>
<li><a class="" href="d%C3%A9composition-de-la-diversit%C3%A9-phylog%C3%A9n%C3%A9tique-et-fonctionnelle.html"><span class="header-section-number">13</span> Décomposition de la diversité phylogénétique et fonctionnelle</a></li>
<li><a class="" href="tests-de-significativit%C3%A9.html"><span class="header-section-number">14</span> Tests de significativité</a></li>
<li><a class="" href="sec-betaAutres.html"><span class="header-section-number">15</span> Autres approches</a></li>
<li class="book-part">Diversité jointe, diversité structurelle</li>
<li><a class="" href="sec-jointeCadre.html"><span class="header-section-number">16</span> Cadre</a></li>
<li><a class="" href="information-mutuelle.html"><span class="header-section-number">17</span> Information mutuelle</a></li>
<li><a class="" href="chap-DiversiteJointe.html"><span class="header-section-number">18</span> Décomposition de la diversité jointe</a></li>
<li class="book-part">Diversité spatialement explicite</li>
<li><a class="" href="sec-spatialCadre.html"><span class="header-section-number">19</span> Cadre</a></li>
<li><a class="" href="chap-Fisher.html"><span class="header-section-number">20</span> Indice \(\alpha\) de Fisher</a></li>
<li><a class="" href="chap-Accumulation.html"><span class="header-section-number">21</span> Accumulation de la diversité locale</a></li>
<li><a class="" href="diversit%C3%A9-r%C3%A9gionale.html"><span class="header-section-number">22</span> Diversité régionale</a></li>
<li><a class="" href="chap-betasp.html"><span class="header-section-number">23</span> Diversité \(\beta\) spatialement explicite</a></li>
<li class="book-part">Conclusion</li>
<li><a class="" href="sec-conclusionSynthese.html"><span class="header-section-number">24</span> Synthèse</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/EricMarcon/MesuresBioDiv2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-Outils" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Outils<a class="anchor" aria-label="anchor" href="#chap-Outils"><i class="fas fa-link"></i></a>
</h1>
<div class="Summary">
<p>La diversité peut être décrite localement par une courbe d’accumulation (SAC) qui représente le nombre d’espèces échantillonnées en fonction de l’effort.
À une échelle plus large, cette courbe s’appelle relation aire-espèces (SAR).</p>
<p>La distribution des abondances des espèces (SAD) est représentée par une histogramme des fréquences ou un diagramme rang-abondance.</p>
<p>Le taux de couverture est la somme des probabilités des espèces observées étant donné l’effort d’échantillonnage.
Il peut être estimé précisément à partir des données d’inventaire.
Le taux de complétude est la proportion (en nombre) des espèces observées.</p>
</div>
<p>Quelques outils sont nécessaires avant d’entrer dans le coeur du sujet.
Les relations décrivant le nombre d’espèces en fonction de la taille de l’échantillon (relations aire-espèces) et la distribution de l’abondance des espèces sont importants pour les écologues.
La mesure de l’exhaustivité de l’échantillonnage par le taux de couverture sera la base de l’estimation de la diversité à partir de données réelles.</p>
<div id="courbes-daccumulation" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Courbes d’accumulation<a class="anchor" aria-label="anchor" href="#courbes-daccumulation"><i class="fas fa-link"></i></a>
</h2>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SACFig"></span>
<img src="MesuresBD_files/figure-html/SACFig-1.png" alt="Courbe d’accumulation des espèces d’arbres du dispositif de Barro Colorado Island. Le nombre d’espèces est cumulé dans l’ordre des carrés d’un hectare du dispositif." width="80%"><p class="caption">
Figure 2.1: Courbe d’accumulation des espèces d’arbres du dispositif de Barro Colorado Island. Le nombre d’espèces est cumulé dans l’ordre des carrés d’un hectare du dispositif.
</p>
</div>
<p></p>
<p>Evaluer la diversité d’une communauté nécessite en pratique de l’inventorier.
Le nombre d’espèces découvertes en fonction de l’effort d’échantillonnage permet de tracer une courbe d’accumulation (SAC : <em>Species Acumulation Curve</em>).
Une courbe de raréfaction (<em>Rarefaction Curve</em>) peut être calculée en réduisant par des outils statistiques l’effort d’échantillonnage réel pour obtenir une SAC théorique, libérée des aléas de l’ordre de prise en compte des données.</p>
<p>La figure <a href="chap-Outils.html#fig:SACFig">2.1</a> montre l’accumulation des espèces pour les données de BCI.
Une SAC peut être tracée en fonction de la surface, du nombre d’individus ou du nombres de placettes d’échantillonnage, selon les besoins.</p>
<p>Code R pour réaliser la figure <a href="chap-Outils.html#fig:SACFig">2.1</a> :</p>
<p></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/vegandevs/vegan">"vegan"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span>
<span><span class="va">Cumul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">BCI</span>, <span class="fl">2</span>, <span class="va">cumsum</span><span class="op">)</span></span>
<span><span class="va">Richesse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Cumul</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SARplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">50</span>, </span>
<span>                             S <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">Richesse</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">aes</span><span class="op">(</span><span class="va">A</span>, <span class="va">S</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Surface (ha)"</span><span class="op">)</span></span>
<span><span class="va">SARplot</span></span></code></pre></div>
<p></p>
<p>Les courbes d’accumulation peuvent aussi concerner la diversité (voir le chapitre <a href="chap-Accumulation.html#chap-Accumulation">21</a>), mesurée au-delà du nombre d’espèces.</p>
<p>Plus généralement, une courbe aire-espèces (SAR : <em>Species Area Relationship</em>) représente le nombre d’espèces observées en fonction de la surface échantillonnée (figure <a href="diversit%C3%A9-r%C3%A9gionale.html#fig:Williamson2001">22.1</a>).
Il existe plusieurs façons de prendre en compte cette relation <span class="citation">(<a href="references.html#ref-Scheiner2003">Scheiner 2003</a>)</span>, classables en deux grandes familles <span class="citation">(<a href="references.html#ref-Dengler2009">Dengler 2009</a>)</span> :</p>
<ul>
<li>Dans une SAR au sens strict, chaque point représente une communauté.
La question traitée est la relation entre le nombre d’espèces et la taille de chaque communauté, en lien avec des processus <span style="white-space:nowrap">écologiques ;</span>
</li>
<li>Une courbe d’accumulation (SAC) ne représente que l’effet statistique de l’échantillonnage.
Pour éviter toute confusion, le terme SAR ne doit pas être utilisé pour décrire une SAC.</li>
</ul>
</div>
<div id="diversité-asymptotique" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Diversité asymptotique<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-asymptotique"><i class="fas fa-link"></i></a>
</h2>
<p>Augmenter l’effort d’échantillonnage peut permettre d’atteindre un stade où la diversité n’augmente plus : sa valeur est appelée <em>diversité asymptotique</em>.
Dans des communautés très diverses comme les forêts tropicales, la diversité asymptotique ne peut en général pas être observée sur le terrain à cause de la variabilité de l’environnement : l’augmentation de la surface inventoriée amène à échantillonner dans des communautés différentes avant d’atteindre la diversité asymptotique de la communauté étudiée.
La diversité asymptotique est donc celle d’une communauté théorique qui n’existe généralement pas.
En d’autres termes, c’est la diversité d’une communauté dont l’inventaire disponible serait un échantillon représentatif.</p>
<p>Evaluer la diversité asymptotique nécessite d’utiliser des estimateurs de diversité, dont la précision dépend de l’exhaustivité de l’échantillonnage.
La diversité peut aussi être estimée pour un effort donné : un hectare de forêt ou 5000 arbres par exemple, ou encore un taux de couverture choisi, qui décrit mieux la qualité de l’échantillonnage.</p>
</div>
<div id="sec-Couverture" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Taux de couverture<a class="anchor" aria-label="anchor" href="#sec-Couverture"><i class="fas fa-link"></i></a>
</h2>
<div id="formule-des-fréquences-de-good-turing" class="section level3" number="2.3.1">
<h3>
<span class="header-section-number">2.3.1</span> Formule des fréquences de Good-Turing<a class="anchor" aria-label="anchor" href="#formule-des-fr%C3%A9quences-de-good-turing"><i class="fas fa-link"></i></a>
</h3>
<p>La relation fondamentale entre les fréquences des espèces dans un échantillon est due à Turing et a été publiée par <span class="citation">Good (<a href="references.html#ref-Good1953">1953</a>)</span>.
En absence de toute information sur la loi de distribution des espèces, en supposant seulement que les individus sont tirés indépendamment les uns des autres selon une loi multinomiale respectant ces probabilités, la formule de Good-Turing relie la probabilité moyenne <span class="math inline">\(\alpha_\nu\)</span> d’une espèce représentée <span class="math inline">\(\nu\)</span> fois (c’est-à-dire par <span class="math inline">\(\nu\)</span> individus) au rapport entre les nombres d’espèces représentées <span class="math inline">\(\nu+1\)</span> fois et <span class="math inline">\(\nu\)</span> fois :</p>
<p><span class="math display" id="eq:alphanu">\[\begin{equation}
  \tag{2.1}
  \alpha_\nu \approx \frac{(\nu+1)}{n} \frac{s^{n}_{\nu+1}}{s^{n}_{\nu}}.
\end{equation}\]</span></p>
<p>Les singletons (<span class="math inline">\(s^{n}_{1}\)</span> : le nombre d’espèces observées une seule fois) et les doubletons (<span class="math inline">\(s^{n}_{2}\)</span> : le nombre d’espèces observées deux fois) ont une importance centrale.
Pour <span class="math inline">\(\nu=1\)</span>, on a : <span class="math inline">\(\alpha_1 = 2 s^{n}_{2}/(ns^{n}_{1})\)</span> : la fréquence d’une espèce typiquement représentée par un singleton est proportionnelle au rapport entre le nombre des doubletons et des singletons.
Pour <span class="math inline">\(\nu=0\)</span>, l’ignorance du nombre d’espèces non échantillonnées <span class="math inline">\(s^{n}_{0}\)</span> pose problème mais le produit <span class="math inline">\(\alpha_0 \times s^{n}_{0} = \pi_0\)</span>, la probabilité totale des espèces non représentées, peut être estimée par <span class="math inline">\(s^{n}_{1}/n\)</span>.
Ces relations sont le fondement des estimateurs de richesse de Chao présentées ci-dessous.</p>
<p>La relation a été précisée <span class="citation">(<a href="references.html#ref-Chiu2014a">Chiu et al. 2014</a>, eq. 6 et 7a)</span> en limitant les approximations dans les calculs.
La seule nécessaire est que les probabilités des espèces représentées le même nombre de fois <span class="math inline">\(\nu\)</span> varient peu et puissent être considérées toutes égales à <span class="math inline">\(\alpha_\nu\)</span>.
Alors, <span class="math inline">\(\alpha_\nu\)</span> est estimé par
<span class="math display" id="eq:GoodTuring2014">\[\begin{equation}
  \tag{2.2}
  \hat{\alpha}_\nu = \frac{\left(\nu+1 \right) s^{n}_{\nu+1}}{\left(n-\nu \right) s^{n}_{\nu} + \left(\nu+1 \right) s^{n}_{\nu+1}}.
\end{equation}\]</span></p>
<p>Ce nouvel estimateur est à la base de l’estimateur de Chao amélioré et des estimateurs d’entropie de Chao et Jost (sections <a href="chap-MesuresNeutres.html#sec-BiaisShannon">3.3.2</a> et <a href="entropie.html#sec-BiaisHCDT">4.6.2</a>).</p>
</div>
<div id="taux-de-couverture-et-déficit-de-couverture" class="section level3" number="2.3.2">
<h3>
<span class="header-section-number">2.3.2</span> Taux de couverture et déficit de couverture<a class="anchor" aria-label="anchor" href="#taux-de-couverture-et-d%C3%A9ficit-de-couverture"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Good (<a href="references.html#ref-Good1953">1953</a>)</span> définit le taux de couverture (<em>sample coverage</em>) de l’échantillonnage comme la proportion des espèces découvertes,
<span class="math display" id="eq:C">\[\begin{equation}
  \tag{2.3}
  C=\sum^S_{s=1}{{\mathbf 1}\left(n_s&gt;0\right)p_s},
\end{equation}\]</span></p>
<p>où <span class="math inline">\({\mathbf 1}(\cdot)\)</span> est la fonction indicatrice.
Son complément à 1 est appelé déficit de couverture (<em>coverage deficit</em>).</p>
<p>Le taux de couverture augmente avec l’effort d’échantillonnage.
Plus il est élevé, meilleures seront les estimations de la diversité.
Pour comparer deux communautés par des courbes de raréfaction, <span class="citation">Chao et Jost (<a href="references.html#ref-Chao2012b">2012</a>)</span> montrent que le taux de couverture plutôt que la taille de l’échantillon doit être identique.
Les estimateurs de la diversité développés plus loin reposent largement sur cette notion pour la correction du biais d’échantillonnage <span class="citation">(<a href="references.html#ref-Dauby2012">Dauby et Hardy 2012</a>)</span> (la sous-estimation systématique de la diversité due aux espèces non observées, un des éléments du biais d’estimation).</p>
<p>L’estimateur du taux de couverture, que Good attribue à Turing, est selon la relation des fréquences vues plus haut :</p>
<p><span class="math display" id="eq:CGood">\[\begin{equation}
  \tag{2.4}
  \hat{C} = 1-\frac{s^{n}_{1}}{n}.
\end{equation}\]</span></p>
<p>Cet estimateur est biaisé <span class="citation">(<a href="references.html#ref-Zhang2007">Z. Zhang et Huang 2007</a>)</span>. En réalité,
<span class="math display" id="eq:CsansBiais">\[\begin{equation}
  \tag{2.5}
  C = 1-\frac{{\mathbb E}(S^{n}_{1}) - \pi_1}{n}.
\end{equation}\]</span></p>
<p>L’estimateur de Good néglige le terme <span class="math inline">\(\pi_1\)</span>, la somme des probabilités des espèces observées une fois.
Ce terme peut être estimé avec un biais plus petit.
<span class="citation">Chao, Lee, et Chen (<a href="references.html#ref-Chao1988">1988</a>)</span> puis <span class="citation">Z. Zhang et Huang (<a href="references.html#ref-Zhang2007">2007</a>)</span> proposent l’estimateur suivant, qui utilise toute l’information disponible et a le plus petit biais possible :</p>
<p><span class="math display" id="eq:CZhang">\[\begin{equation}
  \tag{2.6}
  \hat{C}=1-\sum^{n}_{\nu=1}{\left(-1\right)}^{\nu+1}{\binom{n}{\nu}}^{-1}s^{n}_{\nu}.
\end{equation}\]</span></p>
<p>Les termes de la somme décroissent très vite avec <span class="math inline">\(\nu\)</span>.
En se limitant à <span class="math inline">\(\nu=1\)</span>, l’estimateur se réduit à celui de Good.</p>
<p><span class="citation">Esty (<a href="references.html#ref-Esty1983">1983</a>)</span>, complété par <span class="citation">C.-H. Zhang et Zhang (<a href="references.html#ref-Zhang2009">2009</a>)</span>, a montré que l’estimateur était asymptotiquement normal et a calculé l’intervalle de confiance de <span class="math inline">\(\hat{C}\)</span> :</p>
<p><span class="math display" id="eq:hatC">\[\begin{equation}
  \tag{2.7}
  C=\hat{C}\pm t^{n}_{1-\alpha/2} \frac{\sqrt{s^{n}_{1}\left(1-\frac{s^{n}_{1}}{n}\right)+2s^{n}_{2}}}{n}.
\end{equation}\]</span></p>
<p>Où <span class="math inline">\(t^{n}_{1-\alpha/2}\)</span> est le quantile d’une loi de Student à <span class="math inline">\(n\)</span> degrés de libertés au seuil de risque <span class="math inline">\(\alpha\)</span>, classiquement 1,96 pour <span class="math inline">\(n\)</span> grand et <span class="math inline">\(\alpha=5\%\)</span>.</p>
<p>Un autre estimateur est utilisé dans le logiciel SPADE <span class="citation">(<a href="references.html#ref-Chao2010a">Chao et Shen 2010</a>)</span> et son portage sous R, le package <em>spadeR</em> <span class="citation">(<a href="references.html#ref-Chao2016c">Chao et al. 2016</a>)</span>.
Il est la base des estimateurs d’entropie de Chao et Jost (section <a href="entropie.html#sec-BiaisHCDT">4.6.2</a>).
L’estimation de l’équation <a href="chap-Outils.html#eq:CsansBiais">(2.5)</a> donne la relation
<span class="math display" id="eq:hatC2">\[\begin{equation}
  \tag{2.8}
  \hat{C} = 1-\frac{s^{n}_{1} - \hat{\pi}_1}{n}.
\end{equation}\]</span></p>
<p>Or, <span class="math inline">\(\hat{\pi}_1 = s^{n}_{1} \hat{\alpha}_1\)</span>.
<span class="math inline">\(\alpha_1\)</span> peut être estimé par la relation de Good-Turing <a href="chap-Outils.html#eq:GoodTuring2014">(2.2)</a>, en remplaçant <span class="math inline">\(s^{n}_{0}\)</span> par l’estimateur Chao1 <a href="chap-MesuresNeutres.html#eq:Chao1">(3.5)</a>.
Alors :</p>
<p><span class="math display" id="eq:CChao">\[\begin{equation}
  \tag{2.9}
  \hat{C} = 1-\frac{s^{n}_{1}}{n}(1 - \hat{\alpha}_1)
  = 1-\frac{s^{n}_{1}}{n}\left[\frac{\left(n-1\right)s^{n}_{1}}{\left(n-1\right)s^{n}_{1}+2s^{n}_{2}}\right].
\end{equation}\]</span></p>
<p>Dans le package <em>entropart</em>, la fonction <code>Coverage</code> calcule les trois estimateurs (celui de Zhang et Huang par défaut) :</p>
<p></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/EricMarcon/entropart">"entropart"</a></span><span class="op">)</span></span>
<span><span class="va">Ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/entropart/man/Coverage.html">Coverage</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span></span></code></pre></div>
<pre><code>## ZhangHuang 
##  0.9991146</code></pre>
<p></p>
<p>Le taux de couverture de BCI est proche de 1 parce que l’inventaire couvre 50 ha.
Il est moindre sur les 6.25 ha de la parcelle 6 de Paracou :</p>
<p></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/EricMarcon/SpatDiv">"SpatDiv"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/entropart/man/Coverage.html">Coverage</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/entropart/man/SpeciesDistribution.html">as.AbdVector</a></span><span class="op">(</span><span class="va">Paracou6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## ZhangHuang 
##  0.9723258</code></pre>
<p></p>
<p><span class="citation">Chao et Jost (<a href="references.html#ref-Chao2012b">2012</a>)</span> montrent que la pente de la courbe d’accumulation donnant l’espérance du nombre d’espèces en fonction du nombre d’individus (courbe de raréfaction de la figure <a href="chap-Accumulation.html#fig:Gotelli2001">21.1</a>) est égale au déficit de couverture,</p>
<p><span class="math display" id="eq:DefC">\[\begin{equation}
  \tag{2.10}
  1-{\mathbb E}\left(C^{n}\right)={\mathbb E}\left(S^{n+1}\right)-{\mathbb E}\left(S^{n}\right),
\end{equation}\]</span></p>
<p>où <span class="math inline">\(C^{n}\)</span> est le taux de couverture d’un échantillon de taille <span class="math inline">\(n\)</span> et <span class="math inline">\(S^{n}\)</span> le nombre d’espèces découvertes dans cet échantillon.</p>
<p>Les estimateurs présentés ici supposent une population de taille infinie (de façon équivalente, les individus sont tirés avec remise).
Le cas des populations de taille finie est traité par <span class="citation">Chao et Lin (<a href="references.html#ref-Chao2012">2012</a>)</span> et <span class="citation">Hwang, Lin, et Shen (<a href="references.html#ref-Hwang2014">2014</a>)</span>.</p>
</div>
<div id="complétude" class="section level3" number="2.3.3">
<h3>
<span class="header-section-number">2.3.3</span> Complétude<a class="anchor" aria-label="anchor" href="#compl%C3%A9tude"><i class="fas fa-link"></i></a>
</h3>
<p>La complétude de l’échantillonnage est la proportion du nombre d’espèces observées : <span class="math inline">\(s^{n}_{\ne 0}/{S}\)</span>.
Elle compte simplement les espèces et ne doit pas être confondue avec la couverture qui somme leurs probabilités : le taux de complétude est toujours très inférieur au taux de couverture parce que les espèces non échantillonnées sont les plus rares.</p>
<p>La complétude du même échantillon d’arbres de forêt tropicale que dans l’exemple précédent peut être estimée en divisant le nombre d’espèces observées par le nombre d’espèces estimées (voir section <a href="chap-MesuresNeutres.html#sec-Richesse">3.1</a>).
À BCI :</p>
<p></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Espèces observées</span></span>
<span><span class="op">(</span><span class="va">Obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/entropart/man/Richness.html">Richness</a></span><span class="op">(</span><span class="va">Ns</span>, Correction <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## None 
##  225</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Richesse estimée</span></span>
<span><span class="op">(</span><span class="va">Est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/entropart/man/Richness.html">Richness</a></span><span class="op">(</span><span class="va">Ns</span>, Correction <span class="op">=</span> <span class="st">"Jackknife"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Jackknife 1 
##         244</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Complétude</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Obs</span><span class="op">/</span><span class="va">Est</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.9221311</code></pre>
<p></p>
<p>À Paracou :</p>
<p></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Espèces observées</span></span>
<span><span class="op">(</span><span class="va">Obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/entropart/man/Richness.html">Richness</a></span><span class="op">(</span><span class="va">Paracou6</span>, Correction <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## None 
##  334</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Richesse estimée</span></span>
<span><span class="op">(</span><span class="va">Est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/entropart/man/Richness.html">Richness</a></span><span class="op">(</span><span class="va">Paracou6</span>, Correction <span class="op">=</span> <span class="st">"Jackknife"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Jackknife 2 
##         471</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Complétude</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Obs</span><span class="op">/</span><span class="va">Est</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.7091295</code></pre>
<p></p>
</div>
</div>
<div id="distribution-de-labondance-des-espèces-sad" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Distribution de l’abondance des espèces (SAD)<a class="anchor" aria-label="anchor" href="#distribution-de-labondance-des-esp%C3%A8ces-sad"><i class="fas fa-link"></i></a>
</h2>
<p>La distribution de l’abondance des espèces (SAD : <em>Species Abundance Distribution</em>) est la loi statistique qui donne l’abondance attendue de chaque espèce d’une communauté.
Les espèces ne sont pas identifiées individuellement, mais par le nombre d’individus leur appartenant.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SADFig"></span>
<img src="MesuresBD_files/figure-html/SADFig-1.png" alt="Histogramme des fréquences (diagramme de Preston) des arbres du dispositif de Barro Colorado Island. En abscisse : le nombre d’arbres de chaque espèce (en logarithme) ; en ordonnée : le nombre d’espèces." width="80%"><p class="caption">
Figure 2.2: Histogramme des fréquences (diagramme de Preston) des arbres du dispositif de Barro Colorado Island. En abscisse : le nombre d’arbres de chaque espèce (en <span style="white-space:nowrap">logarithme) ;</span> en ordonnée : le nombre d’espèces.
</p>
</div>
<p></p>
<p>Elle peut être représentée sous la forme d’un histogramme des fréquences (diagramme de <span class="citation">Preston (<a href="references.html#ref-Preston1948">1948</a>)</span>, figure <a href="chap-Outils.html#fig:SADFig">2.2</a>) ou bien d’un diagramme rang-abondance (RAC : <em>Rank Abundance Curve</em> ou diagramme de <span class="citation">Whittaker (<a href="references.html#ref-Whittaker1965">1965</a>)</span>, figure <a href="chap-Outils.html#fig:RACFig">2.3</a>).
Le RAC est souvent utilisé pour reconnaître des distributions connues.
<span class="citation">Izsák et Pavoine (<a href="references.html#ref-Izsak2012">2012</a>)</span> ont étudié les propriétés des RAC pour les principales SAD.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:RACFig"></span>
<img src="MesuresBD_files/figure-html/RACFig-1.png" alt="Diagramme rang-abondance (diagramme de Whittaker) des arbres du dispositif de Barro Colorado Island. Les points sont les données : en abscisse : le rang de l’espèce, à partir de la plus abondante ; en ordonnée : l’abondance de l’espèce. La courbe est l’ajustement d’une distribution log-normale." width="80%"><p class="caption">
Figure 2.3: Diagramme rang-abondance (diagramme de Whittaker) des arbres du dispositif de Barro Colorado Island. Les points sont les données : en abscisse : le rang de l’espèce, à partir de la plus <span style="white-space:nowrap">abondante ;</span> en ordonnée : l’abondance de l’espèce. La courbe est l’ajustement d’une distribution log-normale.
</p>
</div>
<p></p>
<p>Code de la figure <a href="chap-Outils.html#fig:SADFig">2.2</a> :</p>
<p></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span></span>
<span><span class="va">SADhist</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/nclass.html">nclass.Sturges</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       color<span class="op">=</span><span class="st">"black"</span>, fill<span class="op">=</span><span class="st">"white"</span>, boundary <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Effectifs (échelle logarithmique)"</span>, </span>
<span>       y<span class="op">=</span><span class="st">"Nombre d'espèces"</span><span class="op">)</span></span>
<span><span class="va">SADhist</span></span></code></pre></div>
<p></p>
<p>Code de la figure <a href="chap-Outils.html#fig:RACFig">2.3</a> :</p>
<p></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/EricMarcon/entropart">"entropart"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/entropart/man/SpeciesDistribution.html">as.AbdVector</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span>, Distribution <span class="op">=</span> <span class="st">"lnorm"</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>Les SAD sont traitées en détail par <span class="citation">Magurran (<a href="references.html#ref-Magurran1988">1988</a>)</span> ou <span class="citation">McGill et al. (<a href="references.html#ref-McGill2007">2007</a>)</span>.
Les principales distributions, nécessaires à la compréhension de la suite sont présentées ici :</p>
<ul>
<li>La distribution en log-séries de <span class="citation">Fisher, Corbet, et Williams (<a href="references.html#ref-Fisher1943">1943</a>)</span><span style="white-space:nowrap"> ;</span>
</li>
<li>La distribution géométrique <span class="citation">(<a href="references.html#ref-Motomura1932">Motomura 1932</a>; <a href="references.html#ref-Whittaker1972">Whittaker 1972</a>)</span><span style="white-space:nowrap"> ;</span>
</li>
<li>La distribution log-normale <span class="citation">(<a href="references.html#ref-Preston1948">Preston 1948</a>)</span><span style="white-space:nowrap"> ;</span>
</li>
<li>Le modèle Broken Stick <span class="citation">(<a href="references.html#ref-MacArthur1957">MacArthur 1957</a>)</span>.</li>
</ul>
<p>Formellement, la distribution des probabilités des espèces, notées <span class="math inline">\(p_s\)</span>, est à établir.</p>
<div id="la-distribution-en-log-séries" class="section level3" number="2.4.1">
<h3>
<span class="header-section-number">2.4.1</span> La distribution en log-séries<a class="anchor" aria-label="anchor" href="#la-distribution-en-log-s%C3%A9ries"><i class="fas fa-link"></i></a>
</h3>
<p>Cette distribution est traitée en détail dans le chapitre <a href="chap-Fisher.html#chap-Fisher">20</a>.</p>
<p>Le nombre d’espèces est lié au nombre d’individus par la relation <span class="math inline">\({\mathbb E}(S^n)=\alpha\ln(1+n/\alpha)\)</span> où <span class="math inline">\(S^n\)</span> indique le nombre d’espèces observées dans un échantillon de <span class="math inline">\(n\)</span> individus.
<span class="math inline">\(\alpha\)</span> est le paramètre qui fixe la pente de la partie linéaire de la relation, valide dès que <span class="math inline">\(n&gt;&gt;\alpha\)</span>, où le nombre d’espèces <span class="math inline">\(S^n\)</span> augmente proportionnellement au logarithme du nombre d’individus <span class="math inline">\(\ln(n)\)</span>.</p>
<p>La distribution a été obtenue à partir d’inventaires de communautés de papillons en Malaisie et en Angleterre.
Le modèle est tombé en désuétude faute de confirmation empirique à l’échelle de la communauté, avant d’être remis en valeur par la théorie neutre <span class="citation">(<a href="references.html#ref-Hubbell2001">Stephen P. Hubbell 2001</a>)</span> dans lequel la distribution de la <em>méta-communauté</em> est en log-séries.</p>
</div>
<div id="la-distribution-broken-stick" class="section level3" number="2.4.2">
<h3>
<span class="header-section-number">2.4.2</span> La distribution Broken Stick<a class="anchor" aria-label="anchor" href="#la-distribution-broken-stick"><i class="fas fa-link"></i></a>
</h3>
<p>Si les espèces se partagent les ressources ou l’espace des niches, représentées par un bâton, par un processus de cassure aléatoire et simultanée (précisément, les <span class="math inline">\(S-1\)</span> cassures du bâton sont distribuées uniformément sur sa longueur) et que leur abondance est proportionnelle à la quantité de ressources ou d’espace de niche obtenus, alors leur distribution suit le modèle Broken Stick de <span class="citation">MacArthur (<a href="references.html#ref-MacArthur1957">1957</a>)</span>.</p>
<p>Parmi les distributions classiques, c’est la plus équitable : la distribution uniforme des probabilités (<span class="math inline">\(p_s=1/S\)</span> pour tout <span class="math inline">\(s\)</span>) n’est jamais approchée.</p>
<p>Elle est peu observée empiriquement.</p>
</div>
<div id="la-distribution-log-normale" class="section level3" number="2.4.3">
<h3>
<span class="header-section-number">2.4.3</span> La distribution log-normale<a class="anchor" aria-label="anchor" href="#la-distribution-log-normale"><i class="fas fa-link"></i></a>
</h3>
<p>Dans une distribution log-normale, le logarithme des probabilités des espèces (notées <span class="math inline">\(p_s\)</span> pour l’espèce <span class="math inline">\(s\)</span>) suit une loi normale.
L’écart-type <span class="math inline">\(\sigma\)</span> de cette distribution règle l’équitabilité de la distribution.
Son espérance est obtenue à partir du nombre d’espèces et de <span class="math inline">\(\sigma\)</span>, pour que la somme des probabilités égale 1.</p>
<p><span class="citation">May (<a href="references.html#ref-May1975">1975</a>)</span> explique cette distribution par le théorème de la limite centrale : la variable aléatoire valant 1 si un individu est de l’espèce <span class="math inline">\(s\)</span> et 0 sinon est le produit de nombreuses variables de loi inconnues valant 1 en cas de succès (germination d’une graine, survie à de nombreux évènements…).
Le logarithme de ce produit est une somme de variables aléatoire dont la loi est forcément normale par application du théorème de la limite centrale.</p>
<p>La distribution est aussi le résultat d’un algorithme de bâton brisé (<em>broken stick</em>) hiérarchique <span class="citation">(<a href="references.html#ref-Bulmer1974">Bulmer 1974</a>)</span> :</p>
<ul>
<li>Si les ressources (représentées par un bâton) sont partagées une première fois aléatoirement, selon une loi quelconque,</li>
<li>Si chaque bâton obtenu est partagé à nouveau selon le même procédé, et que l’opération est répétée un assez grand nombre de fois,</li>
<li>Si l’abondance de chaque espèce est proportionnelle aux ressources dont elle dispose,</li>
<li>Alors la distribution des espèces est log-normale.</li>
</ul>
<p>Ce mécanisme décrit assez bien un mécanisme de partage successif des ressources, par exemple entre groupes d’espèces de plus en plus petits, correspondant à des niches écologiques de plus en plus étroites.</p>
<p>D’autres arguments existent dans la littérature.
Par exemple, <span class="citation">Engen et Lande (<a href="references.html#ref-Engen1996">1996</a>)</span> obtiennent une distribution normale à partir d’un modèle de dynamique des populations.</p>
<p>La distribution log-normale décrit assez bien (mais pas exactement) une communauté locale dans le cadre de la théorie neutre <span class="citation">(<a href="references.html#ref-Hubbell2001">Stephen P. Hubbell 2001</a>)</span> comme le montre la figure <a href="chap-Outils.html#fig:RACFig">2.3</a>.
Le nombre d’espèces rares est un peu surestimé.
La distribution exacte est donnée par <span class="citation">Volkov et al. (<a href="references.html#ref-Volkov2003">2003</a>)</span>.</p>
</div>
<div id="la-distribution-géométrique" class="section level3" number="2.4.4">
<h3>
<span class="header-section-number">2.4.4</span> La distribution géométrique<a class="anchor" aria-label="anchor" href="#la-distribution-g%C3%A9om%C3%A9trique"><i class="fas fa-link"></i></a>
</h3>
<p>Si les espèces se partagent les ressources selon un algorithme <em>broken stick</em> séquentiel (comme dans la distribution log-normale) mais de proportion fixe <span class="math inline">\(0&lt;k&lt;1\)</span>, alors la distribution obtenue est géométrique.
Les abondances successives sont proportionnelles à <span class="math inline">\(k, k(1-k), k(1-k)^2, \dots, k(1-k)^s, \dots, k(1-k)^S\)</span>.</p>
<p>Ce modèle a été établi par <span class="citation">Motomura (<a href="references.html#ref-Motomura1932">1932</a>)</span> cité par <span class="citation">May (<a href="references.html#ref-May1975">1975</a>)</span>.
Ses propriétés ont été étudiées par <span class="citation">Whittaker (<a href="references.html#ref-Whittaker1972">1972</a>)</span>.</p>
<p>C’est la distribution qui traduit l’absence de relation entre la taille de l’échantillon et l’abondance des espèces <span class="citation">(<a href="references.html#ref-Pueyo2007">Pueyo, He, et Zillio 2007</a>)</span> : la distribution du logarithme de ses probabilités est uniforme.
En d’autre termes, l’ordre de grandeur de l’abondance d’une espèce est uniformément distribué.</p>
<p>La distribution est observée dans les communautés pionnières <span class="citation">(<a href="references.html#ref-Bazzaz1975">Bazzaz 1975</a>)</span>, peu diverses, ou les communautés microbiennes <span class="citation">(<a href="references.html#ref-Haegeman2013">Haegeman et al. 2013</a>)</span>.</p>
</div>
<div id="synthèse" class="section level3" number="2.4.5">
<h3>
<span class="header-section-number">2.4.5</span> Synthèse<a class="anchor" aria-label="anchor" href="#synth%C3%A8se"><i class="fas fa-link"></i></a>
</h3>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:DistributionsFig"></span>
<img src="MesuresBD_files/figure-html/DistributionsFig-1.png" alt="Diagramme rang-fréquence des distributions de probabilité classiques. Toutes les distributions sont de 100 espèces. Les probabilités inférieures à \(10^{-6}\) ne sont pas affichées. Les paramètres choisis sont \(\alpha=11\) pour la distribution log-séries, \(k=0,2\) pour la distribution géométrique et \(\sigma=2\) pour la distribution log-normale." width="100%"><p class="caption">
Figure 2.4: Diagramme rang-fréquence des distributions de probabilité classiques. Toutes les distributions sont de 100 espèces. Les probabilités inférieures à <span class="math inline">\(10^{-6}\)</span> ne sont pas affichées. Les paramètres choisis sont <span class="math inline">\(\alpha=11\)</span> pour la distribution log-séries, <span class="math inline">\(k=0,2\)</span> pour la distribution géométrique et <span class="math inline">\(\sigma=2\)</span> pour la distribution log-normale.
</p>
</div>
<p></p>
<p>La figure <a href="chap-Outils.html#fig:DistributionsFig">2.4</a> est inspirée de la figure très connue de <span class="citation">Magurran (<a href="references.html#ref-Magurran1988">1988</a>)</span>.
Elle montre bien une gradation en termes de décroissance de probabilité entre des distributions de même richesse : de la plus équitable (broken stick) à la plus inéquitable (géométrique).
Elle doit être nuancée : la proportion <span class="math inline">\(k\)</span> de la distribution géométrique fixe la pente de la droite qui la représente sur la figure.
<span class="math inline">\(k=10\%\)</span> sur la figure : une valeur plus faible diminuerait la pente.
De même, l’écart-type de la distribution log-normale décrit sa dispersion.
Une valeur supérieure augmenterait sa décroissance.</p>
<p>Le code utilisé pour produire la figure <a href="chap-Outils.html#fig:DistributionsFig">2.4</a> est le suivant :</p>
<p></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/EricMarcon/entropart">"entropart"</a></span><span class="op">)</span></span>
<span><span class="co"># Tirage d'une communauté en log-séries</span></span>
<span><span class="va">lseries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/entropart/man/rCommunity.html">rCommunity</a></span><span class="op">(</span><span class="fl">1</span>, size<span class="op">=</span><span class="fl">1E5</span>, Distribution<span class="op">=</span><span class="st">"lseries"</span>, alpha<span class="op">=</span><span class="fl">11</span><span class="op">)</span></span>
<span><span class="co"># Nombre d'espèces de référence</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">lseries</span><span class="op">)</span></span>
<span><span class="co"># Part des ressources accaparées dans la distribution géométrique</span></span>
<span><span class="va">prob</span><span class="op">=</span><span class="fl">0.2</span></span>
<span><span class="co"># Calcul des probabilités de la distribution géométrique</span></span>
<span><span class="va">geom</span> <span class="op">&lt;-</span> <span class="va">prob</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">prob</span><span class="op">)</span><span class="op">^</span><span class="va">S</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">prob</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">S</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Dispersion de la loi lognormale</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="co"># Tirage de S valeurs dans une loi lognormale</span></span>
<span><span class="va">Nslnorm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span><span class="op">(</span><span class="va">S</span>, <span class="fl">0</span>, <span class="va">sd</span><span class="op">)</span></span>
<span><span class="co"># Normalisation pour obtenir des probabilités</span></span>
<span><span class="va">lnorm</span> <span class="op">&lt;-</span> <span class="va">Nslnorm</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Nslnorm</span><span class="op">)</span></span>
<span><span class="co"># Tirage des probabilités de la distribution broken stick</span></span>
<span><span class="va">bstick</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cuts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">S</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">cuts</span><span class="op">)</span></span>
<span><span class="co"># Graphique</span></span>
<span><span class="fu">tibble</span><span class="op">(</span>Rang<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">S</span>,</span>
<span>      `Log-Séries`<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">lseries</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">lseries</span><span class="op">)</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      `Géometrique`<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">geom</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      `Log-Normale`<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">lnorm</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      `Broken Stick`<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">bstick</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols<span class="op">=</span><span class="op">-</span><span class="va">Rang</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Rang</span>, y<span class="op">=</span><span class="va">value</span>, color<span class="op">=</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1E-6</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span><span class="st">"Probabilité"</span>, color<span class="op">=</span><span class="st">"Distribution"</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>La simulation de ces quatre distributions peut être réalisée par la fonction <code><a href="https://rdrr.io/pkg/entropart/man/rCommunity.html">rCommunity()</a></code> du package <em>entropart</em>, où l’argument <code>Distribution</code> peut valoir “bstick”, “lnorm”, “geom” ou “lseries”.
La simulation des communautés autres que log-séries passe par le tirage des probabilités des espèces (le calcul est déterministe dans le cas de la distribution géométrique) puis le tirage d’un nombre d’individus dans une loi multinomiale respectant ces probabilités et l’effectif total.</p>
<p>Les fonction <code><a href="https://rdrr.io/pkg/entropart/man/RAC.html">RACbstick()</a></code>, <code><a href="https://rdrr.io/pkg/entropart/man/RAC.html">RAClnorm()</a></code>, <code><a href="https://rdrr.io/pkg/entropart/man/RAC.html">RACgeom()</a></code> et <code><a href="https://rdrr.io/pkg/entropart/man/RAC.html">RAClseries()</a></code> permettent d’inférer à partir d’un vecteur d’abondance les paramètres d’une distribution.
La distribution correspondant au modèle estimé peut être affichée sur la figure Rang-Abondance (figure <a href="chap-Outils.html#fig:SADFig">2.2</a>).</p>
<p>Le package <em>sads</em> fournit les fonctions classiques de R (densité de probabilité, cumulative, quantile, simulation) pour les distributions utiles en écologie, au-delà de celles présentées ici.
La distribution de Volkov notamment peut être simulée.
Les fonctions <code>fitxxx()</code> complètent les fonctions <code>RACxxx()</code> d’<em>entropart</em>.</p>
<p>Le code suivant montre comment ajuster une distribution log-normale aux données de BCI avec <em>entropart</em> ou <em>sads</em>.</p>
<p></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># entropart</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/EricMarcon/entropart">"entropart"</a></span><span class="op">)</span></span>
<span><span class="va">fit_entropart_lnorm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/entropart/man/RAC.html">RAClnorm</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span></span>
<span><span class="co"># Affichage des paramètres estimés</span></span>
<span><span class="va">fit_entropart_lnorm</span><span class="op">$</span><span class="va">mu</span></span></code></pre></div>
<pre><code>## [1] 3.142695</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_entropart_lnorm</span><span class="op">$</span><span class="va">sigma</span></span></code></pre></div>
<pre><code>## [1] 1.791177</code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sads</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/piLaboratory/sads">"sads"</a></span><span class="op">)</span></span>
<span><span class="co"># Estimation. Les données sont tronquées: les espèces</span></span>
<span><span class="co"># observées 0 fois ne sont pas comptées.</span></span>
<span><span class="va">fit_sads_lnorm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sads/man/fitsad.html">fitlnorm</a></span><span class="op">(</span><span class="va">Ns</span>, trunc <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">fit_sads_lnorm</span><span class="op">@</span><span class="va">fullcoef</span></span></code></pre></div>
<pre><code>##  meanlog    sdlog 
## 3.142695 1.787195</code></pre>
<p></p>
<p>L’ajustement du modèle de Volkov peut être comparé à celui d’une distribution log-normale.</p>
<p></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ajustement du modèle de Volkov</span></span>
<span><span class="va">fit_volkov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sads/man/fitsad.html">fitvolkov</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span></span>
<span><span class="va">fit_volkov</span><span class="op">@</span><span class="va">fullcoef</span></span></code></pre></div>
<pre><code>##        theta            m            J 
## 4.767129e+01 9.238201e-02 2.145700e+04</code></pre>
<p></p>
<p>Graphiquement, l’ajustement est très proche mais la distribution de Volkov prévoit explicitement des effectifs égaux parce qu’entiers.</p>
<p></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Comparaison graphique des deux modèles. Log-normal en</span></span>
<span><span class="co"># rouge.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/entropart/man/SpeciesDistribution.html">as.AbdVector</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span>, Distribution <span class="op">=</span> <span class="st">"lnorm"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## $mu
## [1] 3.142695
## 
## $sigma
## [1] 1.791177</code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Volkov en vert</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sads/man/dvolkov.html">rvolkov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span>, <span class="va">fit_volkov</span><span class="op">@</span><span class="va">fullcoef</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">fit_volkov</span><span class="op">@</span><span class="va">fullcoef</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    <span class="va">fit_volkov</span><span class="op">@</span><span class="va">fullcoef</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="MesuresBD_files/figure-html/BCIfit3-1.png" width="80%" style="display: block; margin: auto;"></div>
<p></p>
<p>Les vraisemblances sont proches.</p>
<p></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Comparaison des vraisemblances</span></span>
<span><span class="va">fit_sads_lnorm</span><span class="op">@</span><span class="va">min</span></span></code></pre></div>
<pre><code>## [1] 1157.013</code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_volkov</span><span class="op">@</span><span class="va">min</span></span></code></pre></div>
<pre><code>## [1] 1150.182</code></pre>
<p></p>
<p>Les paramètres du modèle de communauté locale de la théorie neutre sont <span class="math inline">\(\theta\)</span>, le “nombre fondamental de la biodiversité” égal à deux fois le nombre d’espèces apparaissant par pas de temps dans la méta-communauté, <span class="math inline">\(m\)</span>, le taux de migration, et <span class="math inline">\(J\)</span>, la taille de la communauté locale (qui n’est pas à proprement parler un paramètre mais une statistique décrivant les données).</p>
<p>La différence entre les logarithmes de vraisemblance des deux modèles en faveur du modèle de Volkov, alors que le nombre de paramètres est le même.
L’ajustement est donc meilleur mais la différence est petite et la complexité du modèle et des calculs pour l’estimer ne se justifient pas en général : le modèle de Volkov est très peu utilisé en pratique.</p>

</div>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="chap-Notions.html"><span class="header-section-number">1</span> Notions de Diversité</a></div>
<div class="next"><a href="chap-MesuresNeutres.html"><span class="header-section-number">3</span> Mesures neutres de la diversité \(\alpha\) ou \(\gamma\)</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-Outils"><span class="header-section-number">2</span> Outils</a></li>
<li><a class="nav-link" href="#courbes-daccumulation"><span class="header-section-number">2.1</span> Courbes d’accumulation</a></li>
<li><a class="nav-link" href="#diversit%C3%A9-asymptotique"><span class="header-section-number">2.2</span> Diversité asymptotique</a></li>
<li>
<a class="nav-link" href="#sec-Couverture"><span class="header-section-number">2.3</span> Taux de couverture</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#formule-des-fr%C3%A9quences-de-good-turing"><span class="header-section-number">2.3.1</span> Formule des fréquences de Good-Turing</a></li>
<li><a class="nav-link" href="#taux-de-couverture-et-d%C3%A9ficit-de-couverture"><span class="header-section-number">2.3.2</span> Taux de couverture et déficit de couverture</a></li>
<li><a class="nav-link" href="#compl%C3%A9tude"><span class="header-section-number">2.3.3</span> Complétude</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#distribution-de-labondance-des-esp%C3%A8ces-sad"><span class="header-section-number">2.4</span> Distribution de l’abondance des espèces (SAD)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#la-distribution-en-log-s%C3%A9ries"><span class="header-section-number">2.4.1</span> La distribution en log-séries</a></li>
<li><a class="nav-link" href="#la-distribution-broken-stick"><span class="header-section-number">2.4.2</span> La distribution Broken Stick</a></li>
<li><a class="nav-link" href="#la-distribution-log-normale"><span class="header-section-number">2.4.3</span> La distribution log-normale</a></li>
<li><a class="nav-link" href="#la-distribution-g%C3%A9om%C3%A9trique"><span class="header-section-number">2.4.4</span> La distribution géométrique</a></li>
<li><a class="nav-link" href="#synth%C3%A8se"><span class="header-section-number">2.4.5</span> Synthèse</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/EricMarcon/MesuresBioDiv2/blob/master/01-Notions.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/EricMarcon/MesuresBioDiv2/edit/master/01-Notions.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Mesures de la Biodiversité</strong>" was written by Eric Marcon. It was last built on 11/03/2024.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
