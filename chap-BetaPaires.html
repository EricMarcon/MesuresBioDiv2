<!DOCTYPE html>
<html lang="fr-FR">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>11 Diversité de différentiation | Mesures de la Biodiversité</title>
<meta name="author" content="Eric Marcon">
<meta name="description" content="La diversité \(\beta\) de différentiation mesure la dissimilarité entre communautés, généralement considérées par paires. Les dissimilarités les plus connues sont celles de Jaccard ou de Sørensen....">
<meta name="generator" content="bookdown 0.41 with bs4_book()">
<meta property="og:title" content="11 Diversité de différentiation | Mesures de la Biodiversité">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/EricMarcon/MesuresBioDiv2/chap-BetaPaires.html">
<meta property="og:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<meta property="og:description" content="La diversité \(\beta\) de différentiation mesure la dissimilarité entre communautés, généralement considérées par paires. Les dissimilarités les plus connues sont celles de Jaccard ou de Sørensen....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="11 Diversité de différentiation | Mesures de la Biodiversité">
<meta name="twitter:description" content="La diversité \(\beta\) de différentiation mesure la dissimilarité entre communautés, généralement considérées par paires. Les dissimilarités les plus connues sont celles de Jaccard ou de Sørensen....">
<meta name="twitter:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-C1B3PLBCM6"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-C1B3PLBCM6');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Mesures de la Biodiversité</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Motivation</a></li>
<li><a class="" href="calculs-et-donn%C3%A9es.html">Calculs et données</a></li>
<li><a class="" href="notations.html">Notations</a></li>
<li class="book-part">Notions</li>
<li><a class="" href="chap-Notions.html"><span class="header-section-number">1</span> Notions de Diversité</a></li>
<li><a class="" href="chap-Outils.html"><span class="header-section-number">2</span> Outils</a></li>
<li class="book-part">Diversité neutre d’une communauté</li>
<li><a class="" href="chap-MesuresNeutres.html"><span class="header-section-number">3</span> Mesures neutres de la diversité \(\alpha\) ou \(\gamma\)</a></li>
<li><a class="" href="entropie.html"><span class="header-section-number">4</span> Entropie</a></li>
<li><a class="" href="sec-Equitabilite.html"><span class="header-section-number">5</span> Équitabilité</a></li>
<li class="book-part">Diversité fonctionnelle et phylogénétique</li>
<li><a class="" href="chap-cadrephyfonc.html"><span class="header-section-number">6</span> Cadre</a></li>
<li><a class="" href="mesures-particuli%C3%A8res.html"><span class="header-section-number">7</span> Mesures particulières</a></li>
<li><a class="" href="chap-Phyloentropie.html"><span class="header-section-number">8</span> Entropie phylogénétique</a></li>
<li><a class="" href="chap-LeinsterCobbold.html"><span class="header-section-number">9</span> Diversité de Leinster et Cobbold</a></li>
<li class="book-part">Diversité beta et décomposition</li>
<li><a class="" href="sec-betaCadre.html"><span class="header-section-number">10</span> Cadre</a></li>
<li><a class="active" href="chap-BetaPaires.html"><span class="header-section-number">11</span> Diversité de différentiation</a></li>
<li><a class="" href="chap-DedompHCDT.html"><span class="header-section-number">12</span> Décomposition de l’entropie HCDT</a></li>
<li><a class="" href="d%C3%A9composition-de-la-diversit%C3%A9-phylog%C3%A9n%C3%A9tique-et-fonctionnelle.html"><span class="header-section-number">13</span> Décomposition de la diversité phylogénétique et fonctionnelle</a></li>
<li><a class="" href="tests-de-significativit%C3%A9.html"><span class="header-section-number">14</span> Tests de significativité</a></li>
<li><a class="" href="sec-betaAutres.html"><span class="header-section-number">15</span> Autres approches</a></li>
<li class="book-part">Diversité jointe, diversité structurelle</li>
<li><a class="" href="sec-jointeCadre.html"><span class="header-section-number">16</span> Cadre</a></li>
<li><a class="" href="information-mutuelle.html"><span class="header-section-number">17</span> Information mutuelle</a></li>
<li><a class="" href="chap-DiversiteJointe.html"><span class="header-section-number">18</span> Décomposition de la diversité jointe</a></li>
<li class="book-part">Diversité spatialement explicite</li>
<li><a class="" href="sec-spatialCadre.html"><span class="header-section-number">19</span> Cadre</a></li>
<li><a class="" href="chap-Fisher.html"><span class="header-section-number">20</span> Indice \(\alpha\) de Fisher</a></li>
<li><a class="" href="chap-Accumulation.html"><span class="header-section-number">21</span> Accumulation de la diversité locale</a></li>
<li><a class="" href="diversit%C3%A9-r%C3%A9gionale.html"><span class="header-section-number">22</span> Diversité régionale</a></li>
<li><a class="" href="chap-betasp.html"><span class="header-section-number">23</span> Diversité \(\beta\) spatialement explicite</a></li>
<li class="book-part">Conclusion</li>
<li><a class="" href="sec-conclusionSynthese.html"><span class="header-section-number">24</span> Synthèse</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/EricMarcon/MesuresBioDiv2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-BetaPaires" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> Diversité de différentiation<a class="anchor" aria-label="anchor" href="#chap-BetaPaires"><i class="fas fa-link"></i></a>
</h1>
<div class="Summary">
<p>La diversité <span class="math inline">\(\beta\)</span> de différentiation mesure la dissimilarité entre communautés, généralement considérées par paires.
Les dissimilarités les plus connues sont celles de Jaccard ou de Sørensen.
Ces mesures peuvent prendre en compte la seule présence ou absence des espèces, leur abondance ou même la similarité entre les espèces, peuvent être traitées par l’analyse multivariée et être testées contre l’hypothèse de nullité de la dissimilarité.</p>
</div>
<p>La littérature des indices de similarité est bien antérieure à celle de la biodiversité.
De nombreuses mesures de dissimilarité entre paires de communautés existent donc, et leurs propriétés ont été bien étudiées.
Elles seront présentées ici en fonction des types de données qu’elles traitent : présence-absence, abondance ou abondance et similarité des espèces.
Enfin, des tests statistiques ont été construits pour rejeter l’hypothèse que les communautés sont issues d’une même méta-communauté par un simple tirage multinomial des espèces.</p>
<p>Une limite importante des mesures de dissimilarité est qu’elles sont très sensibles à la taille des communautés échantillonnées <span class="citation">(<a href="references.html#ref-Wolda1981">Wolda 1981</a>)</span>.</p>
<div id="données-de-présence-absence" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Données de présence-absence<a class="anchor" aria-label="anchor" href="#donn%C3%A9es-de-pr%C3%A9sence-absence"><i class="fas fa-link"></i></a>
</h2>
<div id="indices-de-similarité" class="section level3" number="11.1.1">
<h3>
<span class="header-section-number">11.1.1</span> Indices de similarité<a class="anchor" aria-label="anchor" href="#indices-de-similarit%C3%A9"><i class="fas fa-link"></i></a>
</h3>
<p>Les indices les plus simples et probablement les plus connus pour calculer la diversité <span class="math inline">\(\beta\)</span> sont l’indice de <span class="citation">Jaccard (<a href="references.html#ref-Jaccard1901">1901</a>)</span> et de Sørensen <span class="citation">(<a href="references.html#ref-Czekanowski1913">Czekanowski 1913</a>; <a href="references.html#ref-Dice1945">Dice 1945</a>; <a href="references.html#ref-Sorensen1948">Sørensen 1948</a>)</span>.
Ils sont définis pour deux communautés et comptent la proportion d’espèces qu’elles partagent.
Plus elle est faible, moins la composition spécifique des communautés est semblable, plus la diversité <span class="math inline">\(\beta\)</span> est considérée comme grande.</p>
<p>Précisément, notons <span class="math inline">\(s_{1,1}\)</span> les espèces observées dans les deux communautés, <span class="math inline">\(s_{1,0}\)</span> celles observées dans la première communauté mais pas la deuxième (et de même <span class="math inline">\(s_{0,1}\)</span>).
L’indice de Jaccard est le rapport entre le nombre d’espèces communes et le nombre d’espèces total :</p>
<p><span class="math display" id="eq:Jaccard">\[\begin{equation}
  \tag{11.1}
  S_3 = \frac{s_{1,1}}{s_{1,1}+s_{1,0}+s_{0,1}}.
\end{equation}\]</span></p>
<p>L’indice de Sørensen vaut deux fois le nombre d’espèces communes divisé par la somme du nombre d’espèces des deux communautés :</p>
<p><span class="math display" id="eq:S7">\[\begin{equation}
  \tag{11.2}
  S_7 = \frac{2s_{1,1}}{2s_{1,1}+s_{1,0}+s_{0,1}}.
\end{equation}\]</span></p>
<p>Les notations <span class="math inline">\(S_n\)</span> correspondent à celles de l’article de référence de <span class="citation">Gower et Legendre (<a href="references.html#ref-Gower1986">1986</a>)</span> qui fait la revue de ces indices de similarité (13 autres sont traités) et en étudie les propriétés.
Certains indices prennent en compte les espèces absentes des deux communautés mais qui auraient pu être observées <span class="math inline">\(s_{0,0}\)</span>.</p>
<p>Deux autres indices sont mentionnés ici, celui de <span class="citation">Sokal et Sneath (<a href="references.html#ref-Sokal1963">1963</a>)</span> et celui d’Ochiai <span class="citation">(<a href="references.html#ref-Ochiai1957">1957</a>)</span> :</p>
<p><span class="math display" id="eq:S5">\[\begin{equation}
  \tag{11.3}
  S_5 = \frac{s_{1,1}}{s_{1,1}+2 \left(s_{1,0}+s_{0,1}\right)};
\end{equation}\]</span>
<span class="math display" id="eq:S12">\[\begin{equation}
  \tag{11.4}
  S_{12} = \frac{s_{1,1}}{\sqrt{\left(s_{1,1}+s_{1,0}\right)\left(s_{1,1}+s_{0,1}\right)}}.
\end{equation}\]</span></p>
<p>Une propriété importante est la possibilité de comparer plusieurs communautés en calculant la matrice de leurs dissimilarités deux à deux et en en faisant une représentation graphique.
Pour cela, la similarité est transformée en dissimilarité <span class="math inline">\(D_n=1-S_n\)</span> (les similarités sont construites pour être comprises entre 0 et 1).
<span class="math inline">\(D_n\)</span> n’est pas toujours une distance euclidienne, mais <span class="math inline">\(\sqrt{D_n}\)</span> l’est pour la majorité des indices.
On utilisera donc généralement la matrice de distances euclidiennes <span class="math inline">\(\Delta\)</span> dont chaque élément <span class="math inline">\(d_{i,j}\)</span> est la racine de la dissimilarité <span class="math inline">\(\sqrt{D_n}\)</span> calculée entre les communautés <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span>.</p>
<p>Exemple : l’indice de Jaccard peut être calculé pour tous les carrés de BCI comparés deux à deux.
La fonction <code>dist.binary</code> du package <em>ade4</em> calcule <span class="math inline">\(\sqrt{D_n}\)</span> pour 10 indices de similarité étudiés par Gower et Legendre (voir l’aide de la fonction).
Le résultat est une demi-matrice de distances de classe <code>dist</code>.</p>
<p></p>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/vegandevs/vegan">"vegan"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://pbil.univ-lyon1.fr/ADE-4/">"ade4"</a></span><span class="op">)</span></span>
<span><span class="va">DistJaccard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dist.binary.html">dist.binary</a></span><span class="op">(</span><span class="va">BCI</span>, method <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p></p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:JaccardFig"></span>
<img src="MesuresBD_files/figure-html/JaccardFig-1.png" alt="Distribution des indices de Jaccard calculés pour les 50 carrés de BCI deux à deux." width="80%"><p class="caption">
Figure 11.1: Distribution des indices de Jaccard calculés pour les 50 carrés de BCI deux à deux.
</p>
</div>
<p></p>
<p>La distribution des valeurs de l’indice de Jaccard <span class="math inline">\(S_3=1-D_3^2\)</span> est en figure <a href="chap-BetaPaires.html#fig:JaccardFig">11.1</a>.
Le mode est proche de 0,5 : la moitié des espèces sont communes entre deux carrés.</p>
<p>Code R pour la figure :</p>
<p></p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Jaccard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">DistJaccard</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Jaccard</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>Pour afficher l’indice de Jaccard entre les carrés 1 et 2, il faut transformer la demi-matrice des distances en matrice de similarité :</p>
<p></p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Jaccard</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">DistJaccard</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">Jaccard</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<pre><code>## [1] 0.5663717</code></pre>
<p></p>
</div>
<div id="biais-destimation" class="section level3" number="11.1.2">
<h3>
<span class="header-section-number">11.1.2</span> Biais d’estimation<a class="anchor" aria-label="anchor" href="#biais-destimation"><i class="fas fa-link"></i></a>
</h3>
<p>Tous les indices de similarité vus plus haut sont sensibles au biais d’estimation.
<span class="citation">Chao et al. (<a href="references.html#ref-Chao2004a">2004</a>)</span> fournissent un estimateur de la probabilité qu’un individu de la première communauté appartienne à une espèce commune aux deux communautés :</p>
<p><span class="math display" id="eq:Chao2004a">\[\begin{equation}
  \tag{11.5}
  \hat{U} = \sum_{s}^{s_{1,1}}{\frac{n_{s,1}}{n}} + \frac{n_{+2}-1}{n_{+2}} \frac{s_1^{(2)}}{2 s_2^{(2)}} \sum_{s}^{s_{1,1}}{\frac{n_s}{n}{\mathbf 1}\left( n_{s,2}=1 \right)}.
\end{equation}\]</span></p>
<p>Les sommes s’entendent pour toutes les espèces communes, indicées de 1 à <span class="math inline">\(s_{1,1}\)</span>.
Le premier terme de la somme est donc la probabilité qu’un individu de la première communauté appartienne à une espèce commune aux deux communautés.
<span class="math inline">\(n_{+2}\)</span> est le nombre d’individus de la deuxième communauté.
<span class="math inline">\(s_1^{(2)}\)</span> et <span class="math inline">\(s_2^{(2)}\)</span> sont le nombre d’espèces communes qui sont des singletons et doubletons dans la deuxième communauté.
L’indicatrice <span class="math inline">\({\mathbf 1}(n_{s,2}=1)\)</span> vaut 1 si l’espèce <span class="math inline">\(s\)</span> est un singleton dans la deuxième communauté : la dernière somme est donc la probabilité qu’un individu de la première communauté appartienne à une espèce commune qui soit un singleton dans la deuxième communauté.
S’il n’y a pas de doubletons dans la deuxième communauté, leur nombre est remplacé par 1.
Enfin, il est possible que l’estimateur soit supérieur à 1, il est alors fixé à 1.</p>
<p>L’estimateur de la probabilité qu’un individu de la deuxième communauté appartienne à une espèce commune est noté <span class="math inline">\(\hat{V}\)</span> et est calculé de façon symétrique à <span class="math inline">\(\hat{U}\)</span>.
Le nombre d’espèces communes <span class="math inline">\(s_{1,1}\)</span> est estimé par <span class="math inline">\(\hat{U}\hat{V}\)</span>, <span class="math inline">\(s_{1,0}\)</span> par <span class="math inline">\((1-\hat{U})\hat{V}\)</span> et <span class="math inline">\(s_{1,0}\)</span> par <span class="math inline">\(\hat{U}(1-\hat{V})\)</span>.
L’estimateur de l’indice de Jaccard est donc</p>
<p><span class="math display" id="eq:EstS3">\[\begin{equation}
  \tag{11.6}
  \hat{S}_3 = \frac{\hat{U}\hat{V}}{\hat{U}+\hat{V}-\hat{U}\hat{V}}.
\end{equation}\]</span></p>
<p>L’estimateur de l’indice de Sørensen est</p>
<p><span class="math display" id="eq:EstS7">\[\begin{equation}
  \tag{11.7}
  \hat{S}_7 = \frac{2\hat{U}\hat{V}}{\hat{U}+\hat{V}}.
\end{equation}\]</span></p>
<p>La matrice de dissimilarité corrigée est assez différente de l’originale. L’indice de Jaccard entre les deux premiers carrés devient :</p>
<p></p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calcul de U et V, N2Col est une matrice ou un dataframe</span></span>
<span><span class="co"># de deux colonnes contenant les effectifs de chaque</span></span>
<span><span class="co"># parcelle</span></span>
<span><span class="va">ChaoUV</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">N2Col</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">NCommunity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">N2Col</span><span class="op">)</span></span>
<span>    <span class="va">Common</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">N2Col</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">N2Col</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">Single</span> <span class="op">&lt;-</span> <span class="va">N2Col</span> <span class="op">==</span> <span class="fl">1</span></span>
<span>    <span class="va">NSingleCommon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">Common</span> <span class="op">&amp;</span> <span class="va">Single</span><span class="op">)</span></span>
<span>    <span class="va">Double</span> <span class="op">&lt;-</span> <span class="va">N2Col</span> <span class="op">==</span> <span class="fl">2</span></span>
<span>    <span class="va">NDoubleCommon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">Common</span> <span class="op">&amp;</span> <span class="va">Double</span><span class="op">)</span></span>
<span>    <span class="va">NsCommon</span> <span class="op">&lt;-</span> <span class="va">N2Col</span><span class="op">[</span><span class="va">Common</span>, <span class="op">]</span></span>
<span>    <span class="va">PsCommon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">NsCommon</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">N2Col</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PsCommon</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">NCommunity</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">NCommunity</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span></span>
<span>        <span class="va">NSingleCommon</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="fl">2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">NDoubleCommon</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PsCommon</span><span class="op">[</span>,</span>
<span>        <span class="fl">1</span><span class="op">]</span><span class="op">[</span><span class="op">(</span><span class="va">NsCommon</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PsCommon</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">NCommunity</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">NCommunity</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span></span>
<span>        <span class="va">NSingleCommon</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">NDoubleCommon</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PsCommon</span><span class="op">[</span>,</span>
<span>        <span class="fl">2</span><span class="op">]</span><span class="op">[</span><span class="op">(</span><span class="va">NsCommon</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>U <span class="op">=</span> <span class="va">U</span>, V <span class="op">=</span> <span class="va">V</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Indice de Jaccard corrigé</span></span>
<span><span class="va">bcJaccard</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">N2Col</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ChaoEst</span> <span class="op">&lt;-</span> <span class="fu">ChaoUV</span><span class="op">(</span><span class="va">N2Col</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">ChaoEst</span><span class="op">$</span><span class="va">U</span> <span class="op">*</span> <span class="va">ChaoEst</span><span class="op">$</span><span class="va">V</span><span class="op">/</span><span class="op">(</span><span class="va">ChaoEst</span><span class="op">$</span><span class="va">U</span> <span class="op">+</span> <span class="va">ChaoEst</span><span class="op">$</span><span class="va">V</span> <span class="op">-</span></span>
<span>        <span class="va">ChaoEst</span><span class="op">$</span><span class="va">U</span> <span class="op">*</span> <span class="va">ChaoEst</span><span class="op">$</span><span class="va">V</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Calcul de l'indice entre les carrés i et j de BCI, i&lt;j.</span></span>
<span><span class="va">BCIjaccard</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">j</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">&gt;=</span> <span class="va">j</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span> <span class="kw">else</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">bcJaccard</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">j</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Calcul de la matrice de dissimilarité entre les 50 carrés</span></span>
<span><span class="va">ChaoJaccard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="fu">BCIjaccard</span><span class="op">(</span><span class="va">i</span>, <span class="va">j</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co"># Indice de Jaccard, carrés 1 et 2, corrigé</span></span>
<span><span class="fu">BCIjaccard</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.9391222</code></pre>
<p></p>
<p>La distribution des valeurs de l’indice corrigé se trouve en figure <a href="chap-BetaPaires.html#fig:ChaoJaccardFig">11.2</a>.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ChaoJaccardFig"></span>
<img src="MesuresBD_files/figure-html/ChaoJaccardFig-1.png" alt="Distribution des indices de Jaccard corrigés du biais d’etimation pour les 50 carrés de BCI deux à deux." width="80%"><p class="caption">
Figure 11.2: Distribution des indices de Jaccard corrigés du biais d’etimation pour les 50 carrés de BCI deux à deux.
</p>
</div>
<p></p>
<p>La majorité des paires de carrés a une similarité supérieure à 0,8 après correction.</p>
<p>Code R pour la figure :</p>
<p></p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ChaoJaccard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">ChaoJaccard</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">ChaoJaccard</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p><span class="citation">Plotkin et Muller-Landau (<a href="references.html#ref-Plotkin2002">2002</a>)</span> founissent des estimateurs de la similarité de Sørensen pour les SAD les plus courantes : lognormale, broken-stick, géométrique, log-séries et même gamma, une généralisation de la distibution broken-stick.
Ils traitent le cas d’un échantillonnage dans lequel les individus sont indépendants les uns des autres, et le cas de l’agrégation spatiale.
Ils montrent que la similarité augmente beaucoup avec la taille des placettes échantillonnées et est nettement plus faible en cas d’agrégation spatiale.</p>
</div>
<div id="représentation-graphique" class="section level3" number="11.1.3">
<h3>
<span class="header-section-number">11.1.3</span> Représentation graphique<a class="anchor" aria-label="anchor" href="#repr%C3%A9sentation-graphique"><i class="fas fa-link"></i></a>
</h3>
<p>La matrice de distances peut être représentée par une analyse en coordonnées principales (PCoA) <span class="citation">(<a href="references.html#ref-Gower1966">Gower 1966</a>)</span> :</p>
<p></p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DistChaoJaccard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ChaoJaccard</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">PcoChaoJaccard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pco.html">dudi.pco</a></span><span class="op">(</span><span class="va">DistChaoJaccard</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p></p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:JaccardPCOFig"></span>
<img src="MesuresBD_files/figure-html/JaccardPCOFig-1.png" alt="Représentation des 50 carrés de BCI dans une analyse en coordonnées principale fondée sur les distances de Jaccard." width="80%"><p class="caption">
Figure 11.3: Représentation des 50 carrés de BCI dans une analyse en coordonnées principale fondée sur les distances de Jaccard.
</p>
</div>
<p></p>
<p>La représentation de l’analyse est en figure <a href="chap-BetaPaires.html#fig:JaccardPCOFig">11.3</a>.
Les 50 carrés de BCI sont représentés sur le plan des deux premiers facteurs.
Les valeurs propres sont représentées dans le cartouche en haut à gauche de la figure.
Les distances entre les points sont les valeurs de <span class="math inline">\(\sqrt{D_3}\)</span>, projetées sur le plan.
La matrice de distances n’est pas euclidienne à cause des approximations de l’estimation mais les conséquences sont faibles sur les premiers axes.</p>
<p>Code R pour la figure :</p>
<p></p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/scatter.html">scatter</a></span><span class="op">(</span><span class="va">PcoChaoJaccard</span>, posieig <span class="op">=</span> <span class="st">"bottomright"</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>
<div id="données-dabondance" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Données d’abondance<a class="anchor" aria-label="anchor" href="#donn%C3%A9es-dabondance"><i class="fas fa-link"></i></a>
</h2>
<p>La distance la plus évidente entre communautés quand les effectifs des espèces sont connus est simplement la distance euclidienne, éventuellement normalisée par le nombre d’espèces <span class="citation">(Dissimilarité <span class="math inline">\(D_1\)</span> de <a href="references.html#ref-Gower1986">Gower et Legendre 1986</a>)</span>.
Son problème principal est qu’elle est très sensible aux ordres de grandeurs relatifs des variables.</p>
<p>La dissimilarité de Steinhaus <span class="citation">(<a href="references.html#ref-Motyka1947">Motyka 1947</a>)</span> est plus connue sous le nom de Bray-Curtis <span class="citation">(<a href="references.html#ref-Odum1950">Odum 1950</a>; <a href="references.html#ref-Bray1957">Bray et Curtis 1957</a>)</span>, voir l’analyse historique de <span class="citation">Legendre et Legendre (<a href="references.html#ref-Legendre2012">2012</a>)</span>, note de bas de page, eq. 7.58, et pourrait être attribuée à <span class="citation">Renkonen (<a href="references.html#ref-Renkonen1938">1938</a>)</span>.
Elle est très utilisée, par défaut dans plusieurs analyses du package <em>vegan</em> par exemple :</p>
<p><span class="math display" id="eq:BrayCurtis">\[\begin{equation}
  \tag{11.8}
  D_{8} = \frac{\sum_s{\left| n_{s,1}-n_{s,2} \right|}}{\sum_s{\left( n_{s,1}+n_{s,2}. \right)}}
\end{equation}\]</span></p>
<p><span class="math inline">\(n_{s,1}\)</span> et <span class="math inline">\(n_{s,2}\)</span> sont le nombre d’individus de l’espèce <span class="math inline">\(s\)</span> dans la première et la deuxième communauté.
La racine carrée de la dissimilarité de Bray-Curtis est euclidienne.</p>
<p><span class="citation">Gower (<a href="references.html#ref-Gower1971">1971</a>)</span> propose une extension de la dissimilarité de Bray-Curtis :
<span class="math display" id="eq:Gower1971">\[\begin{equation}
  \tag{11.9}
  D_{G} = \frac{\sum_s{w_s\left| n_{s,1}-n_{s,2} \right|}}{R_s\sum_s{w_s}}.
\end{equation}\]</span></p>
<p><span class="math inline">\(R_s\)</span> est l’étendue ou l’écart-type de l’abondance de l’espèce <span class="math inline">\(s\)</span>, qui permet de ne pas surpondérer l’effet des espèces très abondantes.
<span class="math inline">\(w_s\)</span> est le poids attribué à l’espèce <span class="math inline">\(s\)</span>, qui peut être utilisé pour éliminer les doubles absences (<span class="math inline">\(w_s=0\)</span> si l’espèce est absente des deux communautés, 1 sinon).</p>
<p><span class="citation">Anderson, Ellingsen, et McArdle (<a href="references.html#ref-Anderson2006">2006</a>)</span> proposent une mesure de dissimilarité (de Gower modifiée) donnant le même poids à une différence d’un ordre de grandeur entre les abondances qu’à la différence entre présence et absence, qui permet donc de se passer de la normalisation par <span class="math inline">\(R_s\)</span>.
Les effectifs sont transformés de la façon suivante : <span class="math inline">\(x_s=\log n_s +1\)</span> si <span class="math inline">\(n_s \ne 0\)</span>, <span class="math inline">\(x_s=1\)</span> sinon (le logarithme est décimal).
La dissimilarité est
<span class="math display" id="eq:MG">\[\begin{equation}
  \tag{11.10}
  D_{\mathit{MG}} = \frac{\sum_s{w_s\left| x_{s,1}-x_{s,2} \right|}}{\sum_s{w_s}}.
\end{equation}\]</span></p>
<p>Elle n’est pas euclidienne.</p>
<p>Les dissimilarités de Jaccard et de Sørensen se généralisent aux données d’abondance.
Le nombre d’espèces communes aux deux sites <span class="math inline">\(s_{1,1}\)</span> est remplacé par le nombre d’individus de même espèce présents sur les deux sites : <span class="math inline">\(n_{1,1}=\sum_s{\min(n_{s,1}, n_{s,2})}\)</span><span style="white-space:nowrap"> ;</span> le nombre d’espèces seulement présentes sur le premier site <span class="math inline">\(s_{1,0}\)</span> est remplacé par le nombre d’individus, sommé sur toutes les espèces, présents uniquement sur le site : <span class="math inline">\(n_{1,0}=\sum_s{\max(0, n_{s,1}-n_{s,2})}\)</span><span style="white-space:nowrap"> ;</span> de même, <span class="math inline">\(s_{0,1}\)</span> est remplacé par <span class="math inline">\(n_{0,1}=\sum_s{\max(0, n_{s,2}-n_{s,1)}}\)</span>.</p>
<p>La dissimilarité de <span class="citation">Ružička (<a href="references.html#ref-Ruzicka1958">1958</a>)</span> généralise celle de Jaccard :</p>
<p><span class="math display" id="eq:Ruzicka">\[\begin{equation}
  \tag{11.11}
  D_3 = 1-\frac{n_{1,1}}{n_{1,1}+n_{1,0}+n_{0,1}}.
\end{equation}\]</span></p>
<p>La différence de pourcentage (<em>percentage difference</em>) généralise la dissimilarité de Sørensen :</p>
<p><span class="math display" id="eq:percentdiff">\[\begin{equation}
  \tag{11.12}
  D_7 = 1- \frac{2n_{1,1}}{2n_{1,1}+n_{1,0}+n_{0,1}}.
\end{equation}\]</span></p>
<p>La plupart des dissimilarités sont implémentées par la fonction <code>dist.ldc</code> du package <em>adespatial</em>.</p>
</div>
<div id="emboîtement-et-substitution" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Emboîtement et substitution<a class="anchor" aria-label="anchor" href="#embo%C3%AEtement-et-substitution"><i class="fas fa-link"></i></a>
</h2>
<p>L’indice de Sørensen et les indices similaires prennent en compte deux types de dissimilarité : l’emboîtement des composition spécifiques (<em>nestedness</em>) et la substitution d’espèces (<em>turnover</em>).
On parle d’emboîtement quand une communauté diffère d’une autre parce que sa composition est un sous-ensemble des espèces de l’autre.
La substitution correspond au remplacement de certaines espèces d’une communauté par de nouvelles espèces.
<span class="citation">Baselga (<a href="references.html#ref-Baselga2010">2010b</a>)</span> montre que la diversité <span class="math inline">\(\beta\)</span> de longicornes en Europe du nord est similaire à celle observée en Europe du sud, mais pour des raisons totalement différentes.
En Europe du nord, les communautés perdent des espèces avec la latitude : leur dissimilarité est due principalement à l’emboîtement.
En Europe du sud, les communautés sont composées d’espèces différentes : la diversité <span class="math inline">\(\beta\)</span> est due à la substitution des espèces.
Baselga décompose l’indice de dissimilarité de Sørensen, <span class="math inline">\(1-S_7\)</span>, en un terme mesurant la substitution et un mesurant l’emboîtement.</p>
<p>Le premier composant est l’indice de dissimilarité de <span class="citation">G. G. Simpson (<a href="references.html#ref-Simpson1943">1943</a>)</span> :
<span class="math display" id="eq:Simpson1943">\[\begin{equation}
  \tag{11.13}
  D_{sim} = \frac{\min(s_{1,0},s_{0,1})}{s_{1,1}+\min(s_{1,0},s_{0,1})}.
\end{equation}\]</span></p>
<p>Il vaut 0 quand les communautés sont emboîtées.
Son complément <span class="math inline">\(D_{nes}\)</span> prend en compte la partie de la dissimilarité due à l’emboîtement :
<span class="math display" id="eq:DNesReplBS">\[\begin{equation}
  \tag{11.14}
  D_{nes}
  = \frac{s_{1,0} + s_{0,1}}{2s_{1,1} + s_{1,0} + s_{0,1}}
  - D_{sim}.
\end{equation}\]</span></p>
<p>Ces mesures de dissimilarité sont généralisées au-delà de deux communautés : les formules sont disponibles dans l’article de Baselga.</p>
<p><span class="citation">Baselga (<a href="references.html#ref-Baselga2012">2012</a>)</span> étend cette décomposition à la dissimilarité de Jaccard :</p>
<p><span class="math display" id="eq:DNesReplBJ">\[\begin{align}
  \tag{11.15}
  D_3
  &amp;= D_{sim} + D_{nes} \\
  &amp;= \frac{2\min(s_{1,0},s_{0,1})}{s_{1,1}+2\min(s_{1,0},s_{0,1})}
  + \frac{s_{1,1}}{s_{1,1}+2\min(s_{1,0},s_{0,1})}\frac{|s_{1,0}-s_{0,1}|}{s_{1,1}+s_{1,0}+s_{0,1}}.
\end{align}\]</span></p>
<p>Le premier terme de la somme est le terme lié à la substitution et le second celui lié à l’emboîtement.</p>
<p><span class="citation">Podani et Schmera (<a href="references.html#ref-Podani2011">2011</a>)</span> défendent un point de vue différent sur la façon de comptabiliser les deux composantes de la décomposition de la dissimilarité de Jaccard.
Le terme de substitution comptabilise les espèces présentes sur un seul site, en nombre égal : <span class="math inline">\(2\min(s_{1,0},s_{0,1})\)</span> plutôt que l’indice de dissimilarité de Simpson.
Ainsi, le terme d’emboîtement comptabilise la différence de richesse entre les deux sites : <span class="math inline">\(|s_{1,0}-s_{0,1}|\)</span>.</p>
<p>Après normalisation par le nombre total d’espèce, la décomposition est</p>
<p><span class="math display" id="eq:DNesReplPJ">\[\begin{equation}
  \tag{11.16}
  D_3
  = \frac{2\min(s_{1,0},s_{0,1})}{s_{1,1} + s_{1,0} + s_{0,1}}
  + \frac{|s_{1,0}-s_{0,1}|}{s_{1,1} + s_{1,0} + s_{0,1}}.
\end{equation}\]</span></p>
<p>La controverse entre les deux décompositions perdure <span class="citation">(<a href="references.html#ref-Podani2016">Podani et Schmera 2016</a>)</span>.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Podani2011"></span>
<img src="images/Podani2011.png" alt="Triangle du simplex Similarité-Substitution-Emboîtement. (a) Similarité, emboîtement et substitution somment à 1 donc les trois composantes peuvent être représentées dans un triangle et combinées deux à deux. La dissimilarité est par exemple représentée par la proximité au côté gauche du triangle, somme de l’emboîtement et de la substitution (ses sommets adjacents) et complément à 1 de la dissimilarité (le sommet opposé). (b) Les formules de calcul dont données pour la similarité de Jaccard. Avec ces notations classiques, \(a\) est le nombre d’espèces communes \(s_{1,1}\), \(b\) et \(c\) sont les espèces propres à chaque communauté, \(s_{0,1}\) et \(s_{1,0}\), et \(n\) est le nombre total d’espèces \(a+b+c\)." width="100%"><p class="caption">
Figure 11.4: Triangle du simplex Similarité-Substitution-Emboîtement. (a) Similarité, emboîtement et substitution somment à 1 donc les trois composantes peuvent être représentées dans un triangle et combinées deux à deux. La dissimilarité est par exemple représentée par la proximité au côté gauche du triangle, somme de l’emboîtement et de la substitution (ses sommets adjacents) et complément à 1 de la dissimilarité (le sommet opposé). (b) Les formules de calcul dont données pour la similarité de Jaccard. Avec ces notations classiques, <span class="math inline">\(a\)</span> est le nombre d’espèces communes <span class="math inline">\(s_{1,1}\)</span>, <span class="math inline">\(b\)</span> et <span class="math inline">\(c\)</span> sont les espèces propres à chaque communauté, <span class="math inline">\(s_{0,1}\)</span> et <span class="math inline">\(s_{1,0}\)</span>, et <span class="math inline">\(n\)</span> est le nombre total d’espèces <span class="math inline">\(a+b+c\)</span>.
</p>
</div>
<p></p>
<p>Comme la dissimilarité est la somme de l’emboîtement et de la substitution et que la dissimilarité est le complément à 1 de la similarité, la somme de la similarité, de l’emboîtement et de la substitution vaut 1.
<span class="citation">Podani et Schmera (<a href="references.html#ref-Podani2011">2011</a>)</span> représentent cette égalité dans un triangle dont les sommets correspondent aux trois termes (Figure <a href="chap-BetaPaires.html#fig:Podani2011">11.4</a>).</p>
<p><span class="citation">Podani, Ricotta, et Schmera (<a href="references.html#ref-Podani2013">2013</a>)</span> étendent cette approche à des mesures de dissimilarité prenant en compte les abondances, particulièrement la dissimilarité de Ružička.
La décomposition est identique à celle de l’équation <a href="chap-BetaPaires.html#eq:DNesReplPJ">(11.16)</a> après remplacement de chaque terme.</p>
<p><span class="citation">Legendre (<a href="references.html#ref-Legendre2014">2014</a>)</span> considère cette décomposition de la diversité <span class="math inline">\(\beta\)</span> en emboîtement et substitution comme une décomposition de variance et lui applique des méthodes d’ordination pour la relier aux variables environnementales par exemple.</p>
<p>Les mesures de diversité <span class="math inline">\(\beta\)</span> fondées sur l’entropie HCDT (chapitre <a href="chap-DedompHCDT.html#chap-DedompHCDT">12</a>) ne permettent pas de distinguer directement emboîtement et substitution.
La variabilité des contributions <span class="math inline">\(^{q}_{i}\!H_{\beta}\)</span> des communautés à l’entropie <span class="math inline">\(\beta\)</span> augmente avec l’emboîtement, mais cette voie n’a pas été explorée.</p>
</div>
<div id="données-dabondance-et-similarité-des-espèces" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Données d’abondance et similarité des espèces<a class="anchor" aria-label="anchor" href="#donn%C3%A9es-dabondance-et-similarit%C3%A9-des-esp%C3%A8ces"><i class="fas fa-link"></i></a>
</h2>
<div id="dissimilarité-minimale-moyenne" class="section level3" number="11.4.1">
<h3>
<span class="header-section-number">11.4.1</span> Dissimilarité minimale moyenne<a class="anchor" aria-label="anchor" href="#dissimilarit%C3%A9-minimale-moyenne"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Ricotta et Bacaro (<a href="references.html#ref-Ricotta2010">2010</a>)</span> définissent une mesure de dissimilarité paramétrique entre deux communautés.
Une matrice de dissimilarité est définie entre toutes les paires d’espèces.
<span class="math inline">\(\min{d_{s,2}}\)</span> désigne la dissimilarité entre l’espèce <span class="math inline">\(s\)</span> présente dans la première communauté et l’espèce la plus proche d’elle dans la deuxième communauté.
<span class="math inline">\(\min{d_{t,1}}\)</span> est la même notation pour l’espèce <span class="math inline">\(t\)</span> de la deuxième communauté et l’espèces la plus proche dans la communauté 1.
Ces valeurs sont nulles pour toutes les espèces communes.</p>
<p><span class="math inline">\(\pi_{s(n)}\)</span> désigne la contribution de l’espèce <span class="math inline">\(s\)</span> à l’indice de Hurlbert, déjà vue dans le cadre de l’originalité taxonomique (Section <a href="mesures-particuli%C3%A8res.html#sec-OrigTax">7.2.2</a>).
La contribution des espèces rares augmente avec le paramètre <span class="math inline">\(n\)</span> (figure <a href="mesures-particuli%C3%A8res.html#fig:HurlbertCFig">7.3</a>).
Pour chaque communauté, la moyenne des dissimilarités minimales entre chaque espèce et l’autre communauté est calculée, pondérée par la contribution de l’espèce à l’indice de Hurlbert.</p>
<p>La dissimilarité pondérée (W pour <em>weighted</em>) entre les deux communautés (C pour <em>community</em>) en est la moyenne entre les deux communautés :
<span class="math display" id="eq:CWn">\[\begin{equation}
  \tag{11.17}
  d_{\mathit{CW}(n)} = \frac{1}{2}\left(\sum_s{\pi_{s(n)} \min{d_{s,2}}} + \sum_t{\pi_{t(n)} \min{d_{t,1}}} \right).
\end{equation}\]</span></p>
<p>Sa version non pondérée (U pour <em>unweighted</em>) par les abondances est <span class="citation">(<a href="references.html#ref-Ricotta2008">Ricotta et Burrascano 2008</a>)</span>
<span class="math display" id="eq:CU">\[\begin{equation}
  \tag{11.18}
  d_{\mathit{CU}} = \frac{\sum_s{\min{d_{s,2}}} + \sum_t{\min{d_{t,1}}}}{2s_{1,1}+s_{1,0}+s_{0,1}}.
\end{equation}\]</span></p>
<p>Ces mesures sont des évolutions de mesures plus anciennes, avec des pondérations différentes.
Dans l’indice de <span class="citation">Clarke et Warwick (<a href="references.html#ref-Clarke1998">1998</a>)</span>, la moyenne est calculée dans chaque communauté, sans pondération :
<span class="math display" id="eq:CW">\[\begin{equation}
  \tag{11.19}
  d_{\mathit{CW}} = \frac{1}{2}\left( \frac{\sum_s{\min{d_{s,2}}}}{s_{1,1}+s_{1,0}} + \frac{\sum_t{\min{d_{t,1}}}}{s_{1,1}+s_{0,1}} \right),
\end{equation}\]</span></p>
<p>mais avec pondération par l’abondance des espèces chez <span class="citation">Ricotta et Burrascano (<a href="references.html#ref-Ricotta2008">2008</a>)</span> :
<span class="math display" id="eq:Ricotta2008">\[\begin{equation}
  \tag{11.20}
  d_{\mathit{RB}} = \frac{1}{2}\left( \sum_s{p_{s|1}\min{d_{s,2}}} + \sum_t{p_{t|2}\min{d_{t,1}}} \right),
\end{equation}\]</span></p>
<p>alors qu’elle l’est globalement dans l’indice de <span class="citation">Izsak et Price (<a href="references.html#ref-Izsak2001">2001</a>)</span> :
<span class="math display" id="eq:Izsak2001">\[\begin{equation}
  \tag{11.21}
  d_{\mathit{IP}} = \frac{\sum_s{\min{d_{s,2}}} + \sum_t{\min{d_{t,1}}}}{s_{1,1}+s_{1,0}+s_{1,1}+s_{0,1}},
\end{equation}\]</span></p>
<p>redécouvert et nommé <em>COMDISTNN</em> par <span class="citation">Webb, Ackerly, et Kembel (<a href="references.html#ref-Webb2008">2008</a>)</span>.</p>
</div>
<div id="similarité-moyenne-entre-individus" class="section level3" number="11.4.2">
<h3>
<span class="header-section-number">11.4.2</span> Similarité moyenne entre individus<a class="anchor" aria-label="anchor" href="#similarit%C3%A9-moyenne-entre-individus"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Pavoine et Ricotta (<a href="references.html#ref-Pavoine2014b">2014</a>)</span> définissent une famille de similarités entre communautés construite à partir de la similarité moyenne entre les paires d’individus de chaque communauté et les paires intercommunautaires.
Une matrice de similarité <span class="math inline">\(\mathbf{Z}\)</span> est définie entre les paires d’espèces : <span class="math inline">\(z_{s,t}\)</span> est la similarité entre l’espèce <span class="math inline">\(s\)</span> et l’espèce <span class="math inline">\(t\)</span>, comprise entre 0 et 1 de la même façon que pour le calcul de la diversité <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> (chapitre <a href="chap-LeinsterCobbold.html#chap-LeinsterCobbold">9</a>).
La matrice <span class="math inline">\(\mathbf{Z}\)</span> doit de plus être semi-définie positive, ce qui implique que <span class="math inline">\(\sqrt{1-\mathbf{Z}}\)</span> est euclidienne : de cette façon, les espèces peuvent être représentées graphiquement par une PCoA.
Les fréquences des espèces dans les deux communautés sont <span class="math inline">\(\mathbf{p}\)</span> et <span class="math inline">\(\mathbf{q}\)</span>.
La similarité moyenne dans chaque communauté est <span class="math inline">\(\sum_{s,t}{p_s p_t z_{s,t}}\)</span> et <span class="math inline">\(\sum_{s,t}{q_s q_t z_{s,t}}\)</span>.
La similarité moyenne des paires d’individus de communautés différentes est <span class="math inline">\(\sum_{s,t}{p_s q_t z_{s,t}}\)</span>.</p>
<p>La dissimilarité entre communautés de Rao (Section <a href="chap-DedompHCDT.html#sec-RaoDisc">12.5</a>) peut être normalisée (en la divisant par sa valeur maximale pour qu’elle soit comprise entre 0 et 1) puis transformée en similarité (en prenant son complément à 1) pour obtenir</p>
<p><span class="math display" id="eq:SorensenAbd">\[\begin{equation}
  \tag{11.22}
  S_{\mathit{Sorensen}} = \frac{\sum_{s,t}{p_s q_t z_{s,t}}}{\frac{1}{2}\sum_{s,t}{p_s p_t z_{s,t}} + \frac{1}{2}\sum_{s,t}{q_s q_t z_{s,t}}}.
\end{equation}\]</span></p>
<p>Les probabilités peuvent être remplacées par n’importe quel vecteur de valeurs positives, par exemple les abondances ou des valeurs 1 et 0 pour des données de présence-absence.
Dans ce dernier cas, et si <span class="math inline">\(\mathbf{Z}\)</span> est la matrice identité <span class="math inline">\(\mathbf{I}\)</span> (la similarité de deux espèces différentes est nulle et <span class="math inline">\(z_{s,s}=1\)</span>), <span class="math inline">\(S_{\mathit{Sorensen}}\)</span> se réduit à l’indice de Sørensen vu plus haut.</p>
<p>La généralisation de l’indice de Jaccard aux données d’abondances est</p>
<p><span class="math display" id="eq:JaccardAbd">\[\begin{equation}
  \tag{11.23}
  S_{\mathit{Jaccard}} = \frac{\sum_{s,t}{p_s q_t z_{s,t}}}{\sum_{s,t}{p_s p_t z_{s,t}} + \sum_{s,t}{q_s q_t z_{s,t}} - \sum_{s,t}{p_s q_t z_{s,t}}}.
\end{equation}\]</span></p>
<p>Il se réduit à l’indice de Jaccard original pour les données de présence-absence et <span class="math inline">\(\mathbf{Z} = \mathbf{I}\)</span>.</p>
<p>L’indice de Sokal et Sneath se généralise par</p>
<p><span class="math display" id="eq:SokalAbd">\[\begin{equation}
  \tag{11.24}
  S_{\mathit{Sokal}} = \frac{\sum_{s,t}{p_s q_t z_{s,t}}}{2 \sum_{s,t}{p_s p_t z_{s,t}} + 2 \sum_{s,t}{q_s q_t z_{s,t}} - 3 \sum_{s,t}{p_s q_t z_{s,t}}},
\end{equation}\]</span></p>
<p>celui d’Ochiai par :</p>
<p><span class="math display" id="eq:OchiaiAbd">\[\begin{equation}
  \tag{11.25}
  S_{\mathit{Ochiai}} = \frac{\sum_{s,t}{p_s q_t z_{s,t}}}{\sqrt{\sum_{s,t}{p_s p_t z_{s,t}}} \sqrt{\sum_{s,t}{q_s q_t z_{s,t}}}}.
\end{equation}\]</span></p>
<p>Ces quatre similarités permettent une représentation des communautés par PCoA de la même façon que l’indice de Jaccard traité plus haut.</p>
<p><span class="citation">Ricotta, Bacaro, et Pavoine (<a href="references.html#ref-Ricotta2014b">2014</a>)</span> ont aussi proposé de mesurer la dissimilarité par la somme des différences (en valeur absolue) de banalité des espèces des deux communautés, normalisée par la banalité totale :
<span class="math display" id="eq:Ricotta2014b">\[\begin{equation}
  \tag{11.26}
  D_{\mathit{RBP}}
  = \frac{\sum_{s}{|\sum_{t}{(p_s-q_t)z_{s,t}}}|}{\sum_{s}{\sum_{t}{(p_s+q_t)z_{s,t}}}}.
\end{equation}\]</span></p>
<p>D’autres similarités ont été proposées mais ont des propriétés qui empêchent de les utiliser <span class="citation">(<a href="references.html#ref-Ricotta2014b">Ricotta, Bacaro, et Pavoine 2014</a>)</span> : leur valeur n’est pas toujours nulle pour deux communautés identiques.
Ce sont l’indice proposé par <span class="citation">Rao (<a href="references.html#ref-Rao1982">1982</a>)</span>,
<span class="math display" id="eq:Rao1982Q12">\[\begin{equation}
  \tag{11.27}
  Q_{\mathit{12}} = \sum_{s,t}{p_s q_t z_{s,t}},
\end{equation}\]</span></p>
<p>comme les indices de <span class="citation">Swenson, Anglada-Cordero, et Barone (<a href="references.html#ref-Swenson2011">2011</a>)</span> :
<span class="math display" id="eq:Swenson2011a">\[\begin{equation}
  \tag{11.28}
  d_{\mathit{pw}} = \frac{1}{2}\left( \frac{\sum_s{\bar{d_{s,2}}}}{s_{1,1}+s_{1,0}} + \frac{\sum_t{\bar{d_{t,1}}}}{s_{1,1}+s_{0,1}} \right),
\end{equation}\]</span></p>
<p>et
<span class="math display" id="eq:Swenson2011b">\[\begin{equation}
  \tag{11.29}
  d_{\mathit{pw}}' = \frac{1}{2}\left( \sum_s{p_s\bar{d_{s,2}}} + \sum_t{q_t\bar{d_{t,1}}} \right),
\end{equation}\]</span></p>
<p>où <span class="math inline">\(\bar{d_{s,2}}\)</span> est la dissimilarité moyenne entre l’espèce <span class="math inline">\(s\)</span> de la communauté 1 et toutes les espèces de la communauté 2.</p>
</div>
</div>
<div id="distance-entre-paires-de-communautés-et-diversité-beta-proportionnelle" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Distance entre paires de communautés et diversité <span class="math inline">\(\beta\)</span> proportionnelle<a class="anchor" aria-label="anchor" href="#distance-entre-paires-de-communaut%C3%A9s-et-diversit%C3%A9-beta-proportionnelle"><i class="fas fa-link"></i></a>
</h2>
<p>Dans certains cas présentés ici, la diversité de différentiation est parfaitement conciliable avec la diversité proportionnelle.</p>
<div id="diversité-de-simpson" class="section level3" number="11.5.1">
<h3>
<span class="header-section-number">11.5.1</span> Diversité de Simpson<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-de-simpson"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">ter Braak (<a href="references.html#ref-terBraak1983">1983</a>)</span> a le premier rapproché l’entropie de Simpson et l’Analyse en Composantes Principales <span class="citation">(<a href="references.html#ref-Pearson1901">Pearson 1901</a>)</span>.
En représentant les communautés dans l’espace des espèces, la norme du vecteur de la communauté <span class="math inline">\(i\)</span> est <span class="math inline">\({\sum_s{p_{s|i}^2}}\)</span>, c’est-à-dire 1 moins l’entropie de Simpson.
La représentation graphique de l’ACP (non centrée, non réduite) montre les communautés les moins diverses (les plus éloignées de l’origine du repère).
Ter Braak <em>définit</em> la diversité <span class="math inline">\(\beta\)</span> comme la distance entre deux communautés (et la moyenne des distances entre paires de communautés si leur nombre est supérieur à 2).
Cette “définition” est valide puisque cette distance est la composante inter de la décomposition de l’entropie <span class="math inline">\(\beta\)</span> de Simpson <a href="chap-DedompHCDT.html#eq:SimpsonNei">(12.11)</a>.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:BCIPCAFig"></span>
<img src="MesuresBD_files/figure-html/BCIPCAFig-1.png" alt="Représentation des deux premiers axes factoriels de l’ACP des 50 carrés de BCI. Les données sont les probabilités des espèce, ni centrées ni réduites pour l’ACP. Les carrés sont représentés avec les espèces. Les carrés 35 et 40 ont une diversité faible et sont associés aux espèces Gustavia superba et Alseis blackiana." width="100%"><p class="caption">
Figure 11.5: Représentation des deux premiers axes factoriels de l’ACP des 50 carrés de BCI. Les données sont les probabilités des espèce, ni centrées ni réduites pour l’ACP. Les carrés sont représentés avec les espèces. Les carrés 35 et 40 ont une diversité faible et sont associés aux espèces <em>Gustavia superba</em> et <em>Alseis blackiana</em>.
</p>
</div>
<p></p>
<p>L’ACP non centrée des 50 carrés de BCI est en figure <a href="chap-BetaPaires.html#fig:BCIPCAFig">11.5</a>.</p>
<p>Code R pour la figure :</p>
<p></p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcaBCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    center <span class="op">=</span> <span class="cn">FALSE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/scatter.html">scatter</a></span><span class="op">(</span><span class="va">pcaBCI</span>, posieig <span class="op">=</span> <span class="st">"bottomleft"</span><span class="op">)</span></span></code></pre></div>
<p></p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:BCIPCA2Fig"></span>
<img src="MesuresBD_files/figure-html/BCIPCA2Fig-1.png" alt="ACP centrée des 50 carrés de BCI pour visualiser la diversité \(\beta\)." width="100%"><p class="caption">
Figure 11.6: ACP centrée des 50 carrés de BCI pour visualiser la diversité <span class="math inline">\(\beta\)</span>.
</p>
</div>
<p></p>
<p>L’ACP centrée (mais non réduite, figure <a href="chap-BetaPaires.html#fig:BCIPCA2Fig">11.6</a>) permet de mieux représenter la diversité <span class="math inline">\(\beta\)</span> : la distance de chaque carré au centre du repère est sa contribution.</p>
<p>Code R :</p>
<p></p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcaBCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/scatter.html">scatter</a></span><span class="op">(</span><span class="va">pcaBCI</span>, clab.col <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
<div id="généralisation" class="section level3" number="11.5.2">
<h3>
<span class="header-section-number">11.5.2</span> Généralisation<a class="anchor" aria-label="anchor" href="#g%C3%A9n%C3%A9ralisation"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Legendre et Anderson (<a href="references.html#ref-Legendre1999">1999</a>)</span> ont montré plus largement que si les communautés sont représentées dans l’espace vectoriel des espèces, la moyenne des carrés des distances euclidiennes entre communautés égale la somme des carrés des écarts à la moyenne des distributions des espèces :</p>
<p><span class="math display" id="eq:Legendre1999">\[\begin{equation}
  \tag{11.30}
  \frac{1}{I} \sum_{i=1}^{I-1}{\sum_{j=i+1}^{I}{d_{i,j}^2}}
  = \sum_{s=1}^{S}{\sum_{i=1}^{I}{\left(y_{s|i}-y_s \right)^2}}.
\end{equation}\]</span></p>
<p><span class="math inline">\(y_{s|i}\)</span> peut être le nombre d’individus <span class="math inline">\(n_{s,i}\)</span> ou la probabilité <span class="math inline">\(p_{s|i}\)</span>.
Les communautés ont ici le même poids, <span class="math inline">\(y_s\)</span> est la moyenne des valeurs de l’espèce <span class="math inline">\(s\)</span> dans chaque communauté.
La somme des carrés des écarts est une mesure de diversité <span class="math inline">\(\beta\)</span>.
Si <span class="math inline">\(y_{s|i}\)</span> est la probabilité <span class="math inline">\(p_{s|i}\)</span>, il s’agit de l’entropie <span class="math inline">\(\beta\)</span> de Simpson.</p>
<p>Ce résultat peut être étendu à toute matrice de distances euclidiennes entre communautés <span class="citation">(<a href="references.html#ref-Legendre2005">Legendre, Borcard, et Peres-Neto 2005</a>)</span> : l’argument est qu’il existe une matrice de <span class="math inline">\(y_{s|i}\)</span>, transformation des <span class="math inline">\(p_{s|i}\)</span>, telle que la distance entre les communautés est cette matrice de distances.
La moyenne des dissimilarités <span class="math inline">\(D_n\)</span> ou des compléments à 1 des similarités de Pavoine et Ricotta (qui sont les carrés des distances euclidiennes de la PCoA) est donc une mesure de diversité <span class="math inline">\(\beta\)</span>.</p>
<p>Pour un certain nombre de distances, la transformation de <span class="math inline">\(p_{s|i}\)</span> en <span class="math inline">\(y_{s|i}\)</span> est bien connue <span class="citation">(<a href="references.html#ref-Legendre2001">Legendre et Gallagher 2001</a>)</span>.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Corde"></span>
<img src="images/Corde.png" alt="Distance de corde entre deux communautés représentées dans l’espace engendré par deux espèces. La distance \(d_{1,2}\) entre les deux communautés est la longueur de la corde qui relie leurs vecteurs de composition normalisés sur le cercle de rayon 1. C’est aussi deux fois le sinus de l’angle \({\alpha_{1,2}}/{2}\) formé par les deux vecteurs de composition des communautés." width="80%"><p class="caption">
Figure 11.7: Distance de corde entre deux communautés représentées dans l’espace engendré par deux espèces. La distance <span class="math inline">\(d_{1,2}\)</span> entre les deux communautés est la longueur de la corde qui relie leurs vecteurs de composition normalisés sur le cercle de rayon 1. C’est aussi deux fois le sinus de l’angle <span class="math inline">\({\alpha_{1,2}}/{2}\)</span> formé par les deux vecteurs de composition des communautés.
</p>
</div>
<p></p>
<p>La distance de corde (Figure <a href="chap-BetaPaires.html#fig:Corde">11.7</a>) est obtenue par la transformation</p>
<p><span class="math display" id="eq:Corde">\[\begin{equation}
  \tag{11.31}
  y_{s|i} = \frac{p_{s|i}}{\sqrt{\sum_s{p_{s|i}^2}}}.
\end{equation}\]</span></p>
<p>Les communautés sont représentées dans l’espace des espèces par un vecteur dont les composantes sont proportionnelles aux probabilités des espèces mais dont la norme est 1.
La distance entre communautés est donc la longueur de la corde qui relie les extrêmités de leurs vecteurs sur la sphère à <span class="math inline">\(S\)</span> dimensions de rayon 1.</p>
<p>La distance de Hellinger est obtenue par
<span class="math display" id="eq:Hellinger">\[\begin{equation}
  \tag{11.32}
  y_{s|i} = \sqrt{p_{s|i}}.
\end{equation}\]</span></p>
<p>La distance euclidienne entre les profils de communautés (<span class="math inline">\(y_{s|i} = p_{s|i}\)</span>) utilisée par <span class="citation">ter Braak (<a href="references.html#ref-terBraak1983">1983</a>)</span> n’est pas optimale parce qu’elle souffre des défauts de l’entropie de Simpson <span class="citation">(<a href="references.html#ref-Jost2007">Jost 2007</a>)</span> qu’elle représente.
<span class="citation">Legendre et De Cáceres (<a href="references.html#ref-Legendre2013">2013</a>)</span>, annexe S3, ont établi une liste de bonnes propriétés que doivent respecter les mesures de distance entre communautés pour analyser la diversité de différentiation.
La fonction <code>dist.ldc</code> du package <em>adespatial</em> permet de calculer toutes les distances présentées dans l’article.
Les distance de corde et de Hellinger (qui est la distance entre les racines carrées des profils de communautés) les respectent toutes.</p>
<p>La diversité <span class="math inline">\(\beta\)</span> exprimée de cette façon peut faire l’objet d’analyses par les méthodes d’ordination classiques (RDA : Analyse de Redondance <span class="citation">(<a href="references.html#ref-Rao1964">Rao 1964</a>)</span><span style="white-space:nowrap"> ;</span> CCA : Analyse Canonique de Correspondance <span class="citation">(<a href="references.html#ref-Braak1986">ter Braak 1986</a>)</span>) pour la relier à des variables environnementales par exemple<span class="citation">(<a href="references.html#ref-Legendre2013">Legendre et De Cáceres 2013</a>)</span>.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:BCICordeFig"></span>
<img src="MesuresBD_files/figure-html/BCICordeFig-1.png" alt="PCoA appliquée à la distance de corde des 50 carrés de BCI pour visualiser la diversité \(\beta\)." width="100%"><p class="caption">
Figure 11.8: PCoA appliquée à la distance de corde des 50 carrés de BCI pour visualiser la diversité <span class="math inline">\(\beta\)</span>.
</p>
</div>
<p></p>
<p>La diversité <span class="math inline">\(\beta\)</span> de BCI (figure <a href="chap-BetaPaires.html#fig:BCIPCA2Fig">11.6</a>) est mieux représentée par une analyse en coordonnées principales appliquée à la distance de corde entre les communautés (figure <a href="chap-BetaPaires.html#fig:BCICordeFig">11.8</a>).
La limite de la méthode est que l’origine du repère ne représente plus ici la méta-communauté : sa position correspond à la moyenne des probabilités des espèces transformées, <span class="math inline">\(y_{s|i}\)</span>, pas à celle des <span class="math inline">\(p_{s|i}\)</span>.</p>
<p>Code R :</p>
<p></p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/adeverse/adespatial">"adespatial"</a></span><span class="op">)</span></span>
<span><span class="va">dCorde</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://adeverse.github.io/adespatial/reference/dist.ldc.html">dist.ldc</a></span><span class="op">(</span><span class="va">BCI</span>, method <span class="op">=</span> <span class="st">"chord"</span><span class="op">)</span></span>
<span><span class="va">pcoaBCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pco.html">dudi.pco</a></span><span class="op">(</span><span class="va">dCorde</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/scatter.html">scatter</a></span><span class="op">(</span><span class="va">pcoaBCI</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
</div>
<div id="sec-TestBetaDiff" class="section level2" number="11.6">
<h2>
<span class="header-section-number">11.6</span> Tests de significativité<a class="anchor" aria-label="anchor" href="#sec-TestBetaDiff"><i class="fas fa-link"></i></a>
</h2>
<div id="test-de-non-nullité" class="section level3" number="11.6.1">
<h3>
<span class="header-section-number">11.6.1</span> Test de non-nullité<a class="anchor" aria-label="anchor" href="#test-de-non-nullit%C3%A9"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Chase et al. (<a href="references.html#ref-Chase2011">2011</a>)</span> testent la valeur de diversité <span class="math inline">\(\beta\)</span> observée contre sa valeur attendue sous l’hypothèse nulle d’une distribution aléatoire des individus dans les communautés.</p>
<p>Leur motivation principale est d’éliminer la dépendance de la diversité <span class="math inline">\(\beta\)</span> à la diversité <span class="math inline">\(\alpha\)</span> due à la mesure de diversité qu’ils utilisent : l’indice de Jaccard, appliqué aux données de présence-absence.
Des communautés théoriques sont tirées selon le modèle nul (selon une distribution multinomiale correspondant aux probabilités des espèces dans la méta-communauté et la taille de chaque communauté dans le cas le plus courant).
La distribution de la diversité <span class="math inline">\(\beta\)</span> sous l’hypothèse nulle est obtenue en répétant les simulations.
La différence entre la diversité <span class="math inline">\(\beta\)</span> réelle et la moyenne simulée est normalisée par la moyenne simulée pour obtenir une valeur comprise entre -1 et +1 (l’indice de Jaccard est compris entre 0 et 1), comparée à sa distribution sous l’hypothèse nulle pour évaluer sa significativité.</p>
<p><span class="citation">Tucker et al. (<a href="references.html#ref-Tucker2015">2016</a>)</span> étendent cette méthode aux données d’abondance en utilisant la dissimilarité de Bray-Curtis et testent, à partir de communautés simulées, sa capacité à distinguer les mécanismes d’assemblage des communautés : niche contre modèle neutre, et modèles déterministes contre stochastiques (c’est-à-dire dont les paramètres varient aléatoirement).
Ces deux oppositions peuvent être traitées indépendamment, pour éviter la confusion entre niche et déterminisme et entre neutralité et stochasticité.
Ils concluent qu’une valeur de diversité <span class="math inline">\(\beta\)</span> significativement différente de celle du modèle nul permet de détecter le mécanisme de niche (alors que le modèle neutre donne une valeur identique à celle de l’hypothèse nulle, 0 étant donné la normalisation).
<span class="citation">Chase et Myers (<a href="references.html#ref-Chase2011a">2011</a>)</span> interprétait les valeurs significatives comme preuve de déterminisme (par opposition à la stochasticité).
Tucker et al. montrent que ce n’est pas le cas : le niveau de stochasticité influe peu sur les résultats quand la diversité est mesurée à partir de données d’abondance.
En revanche, la méthode n’est pas fiable quand elle est utilisée avec des données de présence-absence : la stochasticité ne permet alors plus de distinguer les mécanismes.</p>
</div>
<div id="analyse-de-la-variabilité" class="section level3" number="11.6.2">
<h3>
<span class="header-section-number">11.6.2</span> Analyse de la variabilité<a class="anchor" aria-label="anchor" href="#analyse-de-la-variabilit%C3%A9"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Anderson, Ellingsen, et McArdle (<a href="references.html#ref-Anderson2006">2006</a>)</span> fournissent un test d’égalité de la diversité <span class="math inline">\(\beta\)</span> entre groupes de communautés.
Les communautés sont placées dans un espace euclidien, dans lequel les distances entre elles sont une mesure de dissimilarité présentée dans ce chapitre.
Si les dissimilarités ne sont pas euclidiennes, une PCoA permet de les placer dans un espace euclidien dont certains axes sont imaginaires, sans que cette difficulté invalide la méthode.</p>
<p>Dans chaque groupe, la distance entre chaque communauté et le centre de gravité du groupe est calculée.
Une Anova est réalisée à partir de ces distances.
La statistique F de l’Anova suit une loi de Fisher si la distribution des distances aux centres de gravité est normale.
Si ce n’est pas le cas, le test peut être réalisé par permutation des distances entre les groupes.
La statistique de test de l’Anova est le rapport de la dispersion des centres de gravité des groupes à celle des dispersion des communautés dans chaque groupe.
Elle est comparée à sa distribution obtenue par permutation.</p>
<p>Une alternative consiste à utiliser la distance aux médianes spatiales des groupes.
La médiane spatiale est le point qui minimise la somme des distances entre les points et lui (alors que le centre de gravité minimise la somme des carrés de ces distances).</p>
<p>La fonction <code>betadisper</code> du package <em>vegan</em> implémente ce test.</p>
<p><span class="citation">Ricotta et Burrascano (<a href="references.html#ref-Ricotta2009a">2009</a>)</span> utilisent comme point central de chaque groupe celui représentant l’assemblage de ses communautés.
Ils définissent ainsi la diversité <span class="math inline">\(\beta\)</span> comme la dissimilarité moyenne entre chaque communauté et la méta-communauté.</p>
<p><span class="citation">Bacaro, Gioria, et Ricotta (<a href="references.html#ref-Bacaro2012">2012</a>)</span> préfèrent tester la distribution des dissimilarités entre paires des communautés plutôt que la dissimilarité entre chaque communauté et un point de référence.
Une statistique F est calculée à partir de ces dissimilarités et comparée à sa distribution obtenue par permutation.
La méthode de permutation originale est inappropriée et donc corrigée <span class="citation">(<a href="references.html#ref-Bacaro2013a">Bacaro, Gioria, et Ricotta 2013</a>)</span> : les dissimilarités doivent être redistribuées aléatoirement entre les groupes.</p>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="sec-betaCadre.html"><span class="header-section-number">10</span> Cadre</a></div>
<div class="next"><a href="chap-DedompHCDT.html"><span class="header-section-number">12</span> Décomposition de l’entropie HCDT</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-BetaPaires"><span class="header-section-number">11</span> Diversité de différentiation</a></li>
<li>
<a class="nav-link" href="#donn%C3%A9es-de-pr%C3%A9sence-absence"><span class="header-section-number">11.1</span> Données de présence-absence</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#indices-de-similarit%C3%A9"><span class="header-section-number">11.1.1</span> Indices de similarité</a></li>
<li><a class="nav-link" href="#biais-destimation"><span class="header-section-number">11.1.2</span> Biais d’estimation</a></li>
<li><a class="nav-link" href="#repr%C3%A9sentation-graphique"><span class="header-section-number">11.1.3</span> Représentation graphique</a></li>
</ul>
</li>
<li><a class="nav-link" href="#donn%C3%A9es-dabondance"><span class="header-section-number">11.2</span> Données d’abondance</a></li>
<li><a class="nav-link" href="#embo%C3%AEtement-et-substitution"><span class="header-section-number">11.3</span> Emboîtement et substitution</a></li>
<li>
<a class="nav-link" href="#donn%C3%A9es-dabondance-et-similarit%C3%A9-des-esp%C3%A8ces"><span class="header-section-number">11.4</span> Données d’abondance et similarité des espèces</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#dissimilarit%C3%A9-minimale-moyenne"><span class="header-section-number">11.4.1</span> Dissimilarité minimale moyenne</a></li>
<li><a class="nav-link" href="#similarit%C3%A9-moyenne-entre-individus"><span class="header-section-number">11.4.2</span> Similarité moyenne entre individus</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#distance-entre-paires-de-communaut%C3%A9s-et-diversit%C3%A9-beta-proportionnelle"><span class="header-section-number">11.5</span> Distance entre paires de communautés et diversité \(\beta\) proportionnelle</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#diversit%C3%A9-de-simpson"><span class="header-section-number">11.5.1</span> Diversité de Simpson</a></li>
<li><a class="nav-link" href="#g%C3%A9n%C3%A9ralisation"><span class="header-section-number">11.5.2</span> Généralisation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec-TestBetaDiff"><span class="header-section-number">11.6</span> Tests de significativité</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#test-de-non-nullit%C3%A9"><span class="header-section-number">11.6.1</span> Test de non-nullité</a></li>
<li><a class="nav-link" href="#analyse-de-la-variabilit%C3%A9"><span class="header-section-number">11.6.2</span> Analyse de la variabilité</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/EricMarcon/MesuresBioDiv2/blob/master/04-Beta.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/EricMarcon/MesuresBioDiv2/edit/master/04-Beta.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Mesures de la Biodiversité</strong>" was written by Eric Marcon. It was last built on 05/12/2024.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
