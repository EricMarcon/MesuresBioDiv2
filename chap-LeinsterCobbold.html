<!DOCTYPE html>
<html lang="fr-FR">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Diversité de Leinster et Cobbold | Mesures de la Biodiversité</title>
<meta name="author" content="Eric Marcon">
<meta name="description" content="La diversité de Leinster et Cobbold est l’inverse de la banalité moyenne des espèces, qui est elle-même la similarité moyenne d’une espèce aux autres. Elle va de pair avec l’entropie de Ricotta et...">
<meta name="generator" content="bookdown 0.41 with bs4_book()">
<meta property="og:title" content="9 Diversité de Leinster et Cobbold | Mesures de la Biodiversité">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/EricMarcon/MesuresBioDiv2/chap-LeinsterCobbold.html">
<meta property="og:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<meta property="og:description" content="La diversité de Leinster et Cobbold est l’inverse de la banalité moyenne des espèces, qui est elle-même la similarité moyenne d’une espèce aux autres. Elle va de pair avec l’entropie de Ricotta et...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Diversité de Leinster et Cobbold | Mesures de la Biodiversité">
<meta name="twitter:description" content="La diversité de Leinster et Cobbold est l’inverse de la banalité moyenne des espèces, qui est elle-même la similarité moyenne d’une espèce aux autres. Elle va de pair avec l’entropie de Ricotta et...">
<meta name="twitter:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-C1B3PLBCM6"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-C1B3PLBCM6');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Mesures de la Biodiversité</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Motivation</a></li>
<li><a class="" href="calculs-et-donn%C3%A9es.html">Calculs et données</a></li>
<li><a class="" href="notations.html">Notations</a></li>
<li class="book-part">Notions</li>
<li><a class="" href="chap-Notions.html"><span class="header-section-number">1</span> Notions de Diversité</a></li>
<li><a class="" href="chap-Outils.html"><span class="header-section-number">2</span> Outils</a></li>
<li class="book-part">Diversité neutre d’une communauté</li>
<li><a class="" href="chap-MesuresNeutres.html"><span class="header-section-number">3</span> Mesures neutres de la diversité \(\alpha\) ou \(\gamma\)</a></li>
<li><a class="" href="entropie.html"><span class="header-section-number">4</span> Entropie</a></li>
<li><a class="" href="sec-Equitabilite.html"><span class="header-section-number">5</span> Équitabilité</a></li>
<li class="book-part">Diversité fonctionnelle et phylogénétique</li>
<li><a class="" href="chap-cadrephyfonc.html"><span class="header-section-number">6</span> Cadre</a></li>
<li><a class="" href="mesures-particuli%C3%A8res.html"><span class="header-section-number">7</span> Mesures particulières</a></li>
<li><a class="" href="chap-Phyloentropie.html"><span class="header-section-number">8</span> Entropie phylogénétique</a></li>
<li><a class="active" href="chap-LeinsterCobbold.html"><span class="header-section-number">9</span> Diversité de Leinster et Cobbold</a></li>
<li class="book-part">Diversité beta et décomposition</li>
<li><a class="" href="sec-betaCadre.html"><span class="header-section-number">10</span> Cadre</a></li>
<li><a class="" href="chap-BetaPaires.html"><span class="header-section-number">11</span> Diversité de différentiation</a></li>
<li><a class="" href="chap-DedompHCDT.html"><span class="header-section-number">12</span> Décomposition de l’entropie HCDT</a></li>
<li><a class="" href="d%C3%A9composition-de-la-diversit%C3%A9-phylog%C3%A9n%C3%A9tique-et-fonctionnelle.html"><span class="header-section-number">13</span> Décomposition de la diversité phylogénétique et fonctionnelle</a></li>
<li><a class="" href="tests-de-significativit%C3%A9.html"><span class="header-section-number">14</span> Tests de significativité</a></li>
<li><a class="" href="sec-betaAutres.html"><span class="header-section-number">15</span> Autres approches</a></li>
<li class="book-part">Diversité jointe, diversité structurelle</li>
<li><a class="" href="sec-jointeCadre.html"><span class="header-section-number">16</span> Cadre</a></li>
<li><a class="" href="information-mutuelle.html"><span class="header-section-number">17</span> Information mutuelle</a></li>
<li><a class="" href="chap-DiversiteJointe.html"><span class="header-section-number">18</span> Décomposition de la diversité jointe</a></li>
<li class="book-part">Diversité spatialement explicite</li>
<li><a class="" href="sec-spatialCadre.html"><span class="header-section-number">19</span> Cadre</a></li>
<li><a class="" href="chap-Fisher.html"><span class="header-section-number">20</span> Indice \(\alpha\) de Fisher</a></li>
<li><a class="" href="chap-Accumulation.html"><span class="header-section-number">21</span> Accumulation de la diversité locale</a></li>
<li><a class="" href="diversit%C3%A9-r%C3%A9gionale.html"><span class="header-section-number">22</span> Diversité régionale</a></li>
<li><a class="" href="chap-betasp.html"><span class="header-section-number">23</span> Diversité \(\beta\) spatialement explicite</a></li>
<li class="book-part">Conclusion</li>
<li><a class="" href="sec-conclusionSynthese.html"><span class="header-section-number">24</span> Synthèse</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/EricMarcon/MesuresBioDiv2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-LeinsterCobbold" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Diversité de Leinster et Cobbold<a class="anchor" aria-label="anchor" href="#chap-LeinsterCobbold"><i class="fas fa-link"></i></a>
</h1>
<div class="Summary">
<p>La diversité de Leinster et Cobbold est l’inverse de la banalité moyenne des espèces, qui est elle-même la similarité moyenne d’une espèce aux autres.
Elle va de pair avec l’entropie de Ricotta et Szeidl, dont la fonction d’information est le logarithme déformé de l’inverse la banalité.
La diversité peut être calculée directement à partir de la distance entre espèces, sans recourir à un dendrogramme intermédiaire qui déformerait la topologie des espèces.</p>
</div>
<p>À partir de la théorie mathématique des catégories <span class="citation">(<a href="references.html#ref-Leinster2013">Leinster 2013</a>)</span>, <span class="citation">Leinster et Cobbold (<a href="references.html#ref-Leinster2012">2012</a>)</span> ont proposé une mesure de diversité applicable à une communauté dont la position des espèces dans un espace multidimensionnel euclidien est connue.
C’est donc une mesure applicable à la diversité fonctionnelle.</p>
<div id="définitions" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Définitions<a class="anchor" aria-label="anchor" href="#d%C3%A9finitions"><i class="fas fa-link"></i></a>
</h2>
<p><span class="citation">Leinster et Cobbold (<a href="references.html#ref-Leinster2012">2012</a>)</span> proposent une unification des mesures de diversité à partir de la définition de la banalité des espèces.
Une matrice carrée de dimension égale au nombre d’espèces, <span class="math inline">\(\mathbf{Z}\)</span>, décrit par ses valeurs <span class="math inline">\(z_{s,t}\)</span> la similarité entre l’espèce <span class="math inline">\(s\)</span> et l’espèce <span class="math inline">\(t\)</span> comprises entre 0 et 1 (<span class="math inline">\(z_{s,s}=1\)</span>).</p>
<p>La banalité d’une espèce <span class="math inline">\(s\)</span> est définie par <span class="math inline">\(\sum_t{p_t z_{s,t}}\)</span>, c’est-à-dire la moyenne pondérée de sa similarité avec toutes les autres espèces : au minimum <span class="math inline">\(p_s\)</span> si elle est totalement différente des autres (approche de la diversité neutre, <span class="math inline">\(\mathbf{Z}\)</span> est la matrice identité <span class="math inline">\(\mathbf{I}_s\)</span>), au maximum 1 si toutes les espèces sont totalement similaires (<span class="math inline">\(\mathbf{Z}\)</span> ne contient que des 1).
Une espèce rare totalement différente des autres est peu banale.</p>
<p>La moyenne généralisée d’ordre <span class="math inline">\(r\)</span> <span class="citation">(<a href="references.html#ref-Hardy1952">G. H. Hardy, Littlewood, et Pólya 1952</a>)</span>, <em>generalized mean</em> ou <em>power mean</em> en anglais, est définie pour une distribution de valeurs de <span class="math inline">\(x_s\)</span> dont la probabilité d’occurrence est <span class="math inline">\(p_s\)</span> par</p>
<p><span class="math display" id="eq:Hardy1952">\[\begin{equation}
  \tag{9.1}
  \bar{x}={\left(\sum_s{p_s x^r_s}\right)}^{\frac{1}{r}}.
\end{equation}\]</span></p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:MoyenneHardyFig"></span>
<img src="MesuresBD_files/figure-html/MoyenneHardyFig-1.png" alt="Moyenne généralisée d’ordre \(r\) (en abscisse) d’une distribution uniforme de 10000 valeurs tirées entre 0 et 1. La moyenne arithmétique 0,5 est obtenue pour \(r=1\). La moyenne généralisée tend vers la plus petite valeur (près de 0) quand \(r\to -\infty\), et vers la plus grande valeur (près de 1) quand \(r\to +\infty\)." width="80%"><p class="caption">
Figure 9.1: Moyenne généralisée d’ordre <span class="math inline">\(r\)</span> (en abscisse) d’une distribution uniforme de 10000 valeurs tirées entre 0 et 1. La moyenne arithmétique 0,5 est obtenue pour <span class="math inline">\(r=1\)</span>. La moyenne généralisée tend vers la plus petite valeur (près de 0) quand <span class="math inline">\(r\to -\infty\)</span>, et vers la plus grande valeur (près de 1) quand <span class="math inline">\(r\to +\infty\)</span>.
</p>
</div>
<p></p>
<p>La moyenne généralisée se réduit à la moyenne arithmétique pondérée pour <span class="math inline">\(r=1\)</span>.
Elle donne un fort poids aux petites valeurs de <span class="math inline">\(x_s\)</span> dans la moyenne pour les faibles valeurs de <span class="math inline">\(r\)</span> (qui peuvent être négatives), et un fort poids aux grandes valeurs quand <span class="math inline">\(r\)</span> est grand (figure <a href="chap-LeinsterCobbold.html#fig:MoyenneHardyFig">9.1</a>).</p>
<p>Le code R nécessaire pour réaliser la figure est :</p>
<p></p>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span></span>
<span><span class="co"># La moyenne n'est pas définie à r=0, décalage de 10^-8</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1E-8</span></span>
<span><span class="co"># Préparation des données</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">r</span>, Moyenne <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">r</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X</span><span class="op">^</span><span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">r</span>, y <span class="op">=</span> <span class="va">Moyenne</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">.5</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>La banalité peut s’écrire sous forme matricielle en notant <span class="math inline">\(\mathbf{p}\)</span> le vecteur des probabilités <span class="math inline">\(p_s\)</span>, on note alors <span class="math inline">\({\left(\mathbf{Zp}\right)}_s=\sum_t{p_{t}z_{s,t}}\)</span>.</p>
<p>La banalité moyenne des espèces de la communauté est calculée en prenant <span class="math inline">\(r=q-1\)</span> :</p>
<p><span class="math display" id="eq:barZp">\[\begin{equation}
  \tag{9.2}
  \left(\overline{{\mathbf{Zp}}}\right)
  = {\left(\sum_s{p_s{\left(\mathbf{Zp}\right)}^{q-1}_s}\right)}^{\frac{1}{q-1}}.
\end{equation}\]</span></p>
<p>La diversité de la communauté est simplement l’inverse de la banalité moyenne des espèces :</p>
<p><span class="math display" id="eq:Dqz">\[\begin{equation}
  \tag{9.3}
  ^q\!D^{\mathbf{Z}}={\left(\sum_s{p_s{\left(\mathbf{Zp}\right)}^{q-1}_s}\right)}^{\frac{1}{1-q}}.
\end{equation}\]</span></p>
<p><span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> converge vers <span class="math inline">\(^1\!D^{\mathbf{Z}}\)</span> quand <span class="math inline">\(q\)</span> tend vers 1 :</p>
<p><span class="math display" id="eq:D1z">\[\begin{equation}
  \tag{9.4}
  ^1\!D^{\mathbf{Z}} = \frac{1}{\prod_s{{\left(\mathbf{Zp}\right)}^{p_s}_s}}.
\end{equation}\]</span></p>
</div>
<div id="diversité-neutre" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Diversité neutre<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-neutre"><i class="fas fa-link"></i></a>
</h2>
<p>Leinster et Cobbold montrent que la diversité HCDT est un cas particulier de <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span>, pour la matrice identité :</p>
<p><span class="math display" id="eq:DqI">\[\begin{equation}
  \tag{9.5}
  ^{q}\!D={^q\!D^{\mathbf{I}}}.
\end{equation}\]</span></p>
</div>
<div id="diversité-non-neutre" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Diversité non neutre<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-non-neutre"><i class="fas fa-link"></i></a>
</h2>
<p>Une mesure de diversité non neutre est obtenue en utilisant une matrice <span class="math inline">\(\mathbf{Z}\)</span> qui contient l’information sur la similarité entre les espèces.
La dissimilarité entre espèces peut être obtenue à partir des arbres.
L’exemple suivant utilise les données du calcul d’originalité, section <a href="mesures-particuli%C3%A8res.html#sec-MaxTheorique">7.6.5</a>.
Pour un arbre de classe <code>hclust</code>, la fonction <code>cophenetic</code> fournit une demi-matrice de distances (classe <code>dist</code>).</p>
<p></p>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">hf</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      Ess    Me    S1    Sr    Vm    Bg    Ef
## Me 1.224                                    
## S1 1.224 1.003                              
## Sr 2.464 2.464 2.464                        
## Vm 9.731 9.731 9.731 9.731                  
## Bg 9.731 9.731 9.731 9.731 5.653            
## Ef 9.731 9.731 9.731 9.731 1.694 5.653      
## Dg 9.731 9.731 9.731 9.731 1.101 5.653 1.694</code></pre>
<p></p>
<p>La matrice doit être normalisée puis transformée en matrice de similarité.
Une transformation simple est 1 moins la dissimilarité (préalablement normalisée pour être comprise entre 0 et 1) :</p>
<p></p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">hf</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">(</span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Dis</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Dis</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>##        Ess     Me     S1     Sr     Vm     Bg     Ef     Dg
## Ess 1.0000 0.8742 0.8742 0.7468 0.0000 0.0000 0.0000 0.0000
## Me  0.8742 1.0000 0.8969 0.7468 0.0000 0.0000 0.0000 0.0000
## S1  0.8742 0.8969 1.0000 0.7468 0.0000 0.0000 0.0000 0.0000
## Sr  0.7468 0.7468 0.7468 1.0000 0.0000 0.0000 0.0000 0.0000
## Vm  0.0000 0.0000 0.0000 0.0000 1.0000 0.4191 0.8259 0.8868
## Bg  0.0000 0.0000 0.0000 0.0000 0.4191 1.0000 0.4191 0.4191
## Ef  0.0000 0.0000 0.0000 0.0000 0.8259 0.4191 1.0000 0.8259
## Dg  0.0000 0.0000 0.0000 0.0000 0.8868 0.4191 0.8259 1.0000</code></pre>
<p></p>
<p>La diversité peut être calculée par la fonction <code>Dqz</code> de <em>entropart</em> :</p>
<p></p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vecteur contenant 8 espèces...</span></span>
<span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv2</a></span><span class="op">(</span><span class="st">"data/rao.effectifs.csv"</span>, row.names <span class="op">=</span> <span class="fl">1</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">-&gt;</span></span>
<span>    <span class="va">effectifs</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     P1 P2 P3 P4
## Ess 97 36 34 61
## Me  62 24 49  4
## S1   4  6  6 75
## Sr  71 78 99 36
## Vm  76 29 34  2
## Bg  58 49 47 19
## Ef   9 34 91 35
## Dg  98 14 95 14</code></pre>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">effectifs</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">effectifs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/Dqz.html">Dqz</a></span><span class="op">(</span><span class="va">Ps</span>, q <span class="op">=</span> <span class="fl">2</span>, <span class="va">Z</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     None 
## 2.520938</code></pre>
<p></p>
<p>Dans le cas particulier <span class="math inline">\(q=2\)</span>, <span class="math inline">\(^2\!D^{\mathbf{Z}}\)</span> est égal à <span class="math inline">\(^{2}\!\bar{D}(T)\)</span> :</p>
<p></p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/PhyloDiversity.html">PhyloDiversity</a></span><span class="op">(</span><span class="va">Ps</span>, q <span class="op">=</span> <span class="fl">2</span>, <span class="va">phyf</span><span class="op">)</span><span class="op">$</span><span class="va">Total</span></span></code></pre></div>
<pre><code>##     None 
## 2.520938</code></pre>
<p></p>
<p>Mais ce n’est pas le cas en général.</p>
</div>
<div id="entropie-de-ricotta-et-szeidl" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Entropie de Ricotta et Szeidl<a class="anchor" aria-label="anchor" href="#entropie-de-ricotta-et-szeidl"><i class="fas fa-link"></i></a>
</h2>
<p><span class="citation">Ricotta et Szeidl (<a href="references.html#ref-Ricotta2006b">2006</a>)</span> ont montré une similitude entre les entropies de Shannon et de Rao en généralisant l’entropie de Shannon en deux temps.
Tout d’abord en remarquant que la probabilité d’occurrence d’une espèce est 1 moins la somme de celle des autres, d’où</p>
<p><span class="math display" id="eq:Ricotta2006bH1">\[\begin{equation}
  \tag{9.6}
  ^{1}\!H = -\sum_s{p_s\ln\left(1-\sum_{t\ne s}{p_t}\right)}.
\end{equation}\]</span></p>
<p><span class="math inline">\(1-\sum_{t\ne s}{p_t}\)</span> est la banalité de l’espèce <span class="math inline">\(s\)</span> si on mesure la diversité neutre.
De façon plus générale, <span class="math inline">\({(\mathbf{Zp})}_s\)</span> peut exprimer cette banalité.
Enfin, l’entropie HCDT peut généraliser l’entropie de Shannon pour définir une mesure <span class="math inline">\(Q_{\alpha}\)</span> que nous noterons <span class="math inline">\(^q\!H^{\mathbf{Z}}\)</span> pour la cohérence de nos notations (<span class="math inline">\(q=\alpha\)</span>) :</p>
<p><span class="math display" id="eq:Ricotta2006bHZ">\[\begin{equation}
  \tag{9.7}
  ^q\!H^{\mathbf{Z}} = \sum_s{p_{s}\ln_q{\frac{1}{\left(\mathbf{Zp}\right)_s}}}.
\end{equation}\]</span></p>
<p>De façon plus rigoureuse, on peut remarquer que <span class="math inline">\({(\mathbf{Zp})}_s\)</span> décroît quand <span class="math inline">\(p_s\)</span> décroît parce que la similarité d’une espèce avec elle-même est maximale.
Une entropie définie à partir d’une fonction d’information de <span class="math inline">\(p_s\)</span> reste donc une entropie quand on utilise la même fonction d’information sur <span class="math inline">\({(\mathbf{Zp})}_s\)</span> : la fonction reste décroissante et vaut 0 pour <span class="math inline">\(p_s=1\)</span> puisque <span class="math inline">\({(\mathbf{Zp})}_s=1\)</span> dans ce cas.
<span class="math inline">\(^q\!H^{\mathbf{Z}}\)</span> est donc bien une entropie.
La fonction d’information <span class="math inline">\(\ln_q(1/p_s)\)</span> de l’entropie HCDT <a href="entropie.html#eq:EntropieHCDT">(4.16)</a> est simplement remplacée par <span class="math inline">\(\ln_q(1/{(\mathbf{Zp})}_s)\)</span>.</p>
<p>L’entropie de Ricotta et Szeidl étend l’entropie HCDT en utilisant une fonction d’information plus générale, dépendant de la banalité de l’espèce plutôt que de sa seule probabilité, les deux étant égales dans le cas particulier de la diversité neutre.
L’ordre de la diversité <span class="math inline">\(q\)</span> permet de donner un plus ou moins grand poids aux espèces banales (et non aux espèces fréquentes : <span class="math inline">\(p_s\)</span> est à la puissance 1).
La fréquence et la banalité se confondent seulement pour la diversité neutre.</p>
<p>Le logarithme d’ordre <span class="math inline">\(q\)</span> de <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> est <span class="math inline">\(^q\!H^{\mathbf{Z}}\)</span> :</p>
<p><span class="math display" id="eq:DqZHqZ">\[\begin{equation}
  \tag{9.8}
  \ln_q{^q\!D^{\mathbf{Z}}} = ^q\!H^{\mathbf{Z}}.
\end{equation}\]</span></p>
</div>
<div id="définition-de-la-similarité" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Définition de la similarité<a class="anchor" aria-label="anchor" href="#d%C3%A9finition-de-la-similarit%C3%A9"><i class="fas fa-link"></i></a>
</h2>
<p>La transformation d’une matrice de dissimilarité en une matrice de similarité nécessite une fonction strictement décroissante, dont le résultat est compris entre 0 et 1.
La plus simple est
<span class="math display">\[z_{s,t} = 1 - \frac{d_{s,t}}{\max{(d_{s,t})}}.\]</span>
Leinster et Cobbold argumentent en faveur d’une transformation exponentielle négative, déjà utilisée par <span class="citation">Nei (<a href="references.html#ref-Nei1972">1972</a>)</span>.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:LineaireZpsqFig"></span>
<img src="MesuresBD_files/figure-html/LineaireZpsqFig-1.png" alt="Approximation de \({(\mathbf{Zp})}_{s}^{q-1}\) par son développement limité au premier ordre pour (a) \(q=1.5\) (\(r=q-1\)) et (b) \(q=0.5\)" width="100%"><p class="caption">
Figure 9.2: Approximation de <span class="math inline">\({(\mathbf{Zp})}_{s}^{q-1}\)</span> par son développement limité au premier ordre pour (a) <span class="math inline">\(q=1.5\)</span> (<span class="math inline">\(r=q-1\)</span>) et (b) <span class="math inline">\(q=0.5\)</span>
</p>
</div>
<p></p>
<p>Le problème majeur de la diversité <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> est qu’elle fournit souvent des valeurs presque indépendantes de <span class="math inline">\(q\)</span> quand on l’applique à une matrice de similarité fonctionnelle <span class="citation">(<a href="references.html#ref-Chiu2014b">Chiu et Chao 2014</a>)</span>.
De nombreux exemples, y compris dans l’article original de Leinster et Cobbold, montrent une très faible décroissance de la diversité de <span class="math inline">\(q=0\)</span> à <span class="math inline">\(q=2\)</span>.
Ce n’est pas un problème théorique mais numérique.
Si la banalité de l’espèce <span class="math inline">\(s\)</span> est proche de 1, sa puissance <span class="math inline">\(q\)</span> peut être approchée par son développement limité au premier ordre :
<span class="math display">\[{(\mathbf{Zp})}_{s}^{q-1} \approx 1 + (q-1)[{(\mathbf{Zp})}_{s} - 1].\]</span>
Cette approximation linéaire implique que
<span class="math display">\[\sum_s{p_s{\left(\mathbf{Zp}\right)}^{q-1}_s} \approx [\sum_s{p_s{\left(\mathbf{Zp}\right)}_s}]^{q-1}.\]</span>
La puissance <span class="math inline">\(q-1\)</span> disparaît donc dans le calcul de la diversité et l’équation <a href="chap-LeinsterCobbold.html#eq:Dqz">(9.3)</a> devient
<span class="math display">\[^q\!D^{\mathbf{Z}} \approx \bar{z}\]</span>
où <span class="math inline">\(\bar{z} = \sum_s{p_s (\mathbf{Zp})_s}\)</span>.
Dans les faits, cette approximation vaut pour des valeurs de banalité assez éloignées de 1 (Figure <a href="chap-LeinsterCobbold.html#fig:LineaireZpsqFig">9.2</a>).</p>
<p>Si une majorité des espèces (au sens de la somme de leurs probabilités respectives) a une banalité supérieure à 0,5, l’approximation linéaire est assez bonne et la moyenne généralisée de la banalité est proche de sa moyenne arithmétique.
Ce n’est pas un problème pour la comparaison de profils de diversité de communautés différentes calculés à partir de la même matrice de similarité mais l’interprétation de la diversité en termes de nombres effectifs d’espèces dépendant de <span class="math inline">\(q\)</span> n’est pas très intuitive.</p>
<p>Le code R nécessaire pour réaliser la figure est :</p>
<p></p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">seqZp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">gga</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>r <span class="op">=</span> <span class="va">seqZp</span>, xr <span class="op">=</span> <span class="va">seqZp</span><span class="op">^</span><span class="va">r</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">r</span>, <span class="va">xr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">r</span>, slope <span class="op">=</span> <span class="va">r</span>, col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="va">r</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>tag <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span><span class="va">ggb</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>r <span class="op">=</span> <span class="va">seqZp</span>, xr <span class="op">=</span> <span class="va">seqZp</span><span class="op">^</span><span class="va">r</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">r</span>, <span class="va">xr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">r</span>, slope <span class="op">=</span> <span class="va">r</span>, col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="va">r</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>tag <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span>
<span><span class="fu">grid.arrange</span><span class="op">(</span><span class="va">gga</span>, <span class="va">ggb</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>La transformation exponentielle négative,
<span class="math display">\[z_{s,t} = e^{-u \frac{d_{s,t}}{\max{(d_{s,t})}}},\]</span>
est justifiée par <span class="citation">Leinster (<a href="references.html#ref-Leinster2013">2013</a>)</span>.
<span class="math inline">\(u\)</span> est une constante positive.
Plus <span class="math inline">\(u\)</span> est grand, plus la transformation est convexe : les similarités sont tassées vers 0 (figure <a href="chap-LeinsterCobbold.html#fig:EchelleFig">9.3</a>).</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:EchelleFig"></span>
<img src="MesuresBD_files/figure-html/EchelleFig-1.png" alt="Transformation des distances (en abscisse) en similarités (en ordonnées) selon la valeur de \(u\). Trait plein : \(u=1\) ; pointillés longs : \(u=2\) ; pointillés : \(u=10\). Plus \(u\) est grand, plus les similarités sont tassées vers 0." width="80%"><p class="caption">
Figure 9.3: Transformation des distances (en abscisse) en similarités (en ordonnées) selon la valeur de <span class="math inline">\(u\)</span>. Trait plein : <span class="math inline">\(u=1\)</span><span style="white-space:nowrap"> ;</span> pointillés longs : <span class="math inline">\(u=2\)</span><span style="white-space:nowrap"> ;</span> pointillés : <span class="math inline">\(u=10\)</span>. Plus <span class="math inline">\(u\)</span> est grand, plus les similarités sont tassées vers 0.
</p>
</div>
<p></p>
<p>Le code R nécessaire pour réaliser la figure est :</p>
<p></p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">x</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span><span class="op">*</span><span class="va">x</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">ux</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>Augmenter la valeur de <span class="math inline">\(u\)</span> diminue les similarités et donc la banalité des espèces, ce qui règle (arbitrairement) le problème de la faible sensibilité de la diversité au paramètre <span class="math inline">\(q\)</span>.</p>
<p>Du point de vue théorique, l’ordre des valeurs de la matrice des distances est justifié (par les différences entre traits fonctionnels par exemple) mais leur distribution ne l’est pas : elle n’est que la conséquence de la méthode de calcul.
Le choix de <span class="math inline">\(u\)</span> ne change pas l’ordre des distances mais déforme la distribution des similarités.
La distance étant normalisée, <span class="math inline">\(u\)</span> fixe l’échelle des distances avant la transformation.</p>
<p>Leinster relie la valeur de <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> à la magnitude de l’espace des espèces (espace dans lequel les espèces sont des points dont les distances deux à deux sont décrites par la matrice <span class="math inline">\(\Delta\)</span>, qui doit être euclidienne) : la magnitude de l’espace est la valeur maximale que peut atteindre la diversité.
La magnitude est une propriété qui décrit la taille d’un espace dans le cadre de la théorie des catégories.
Modifier <span class="math inline">\(u\)</span> modifie la magnitude de l’espace selon une relation non triviale : <span class="math inline">\(u\)</span> est un paramètre au même titre que <span class="math inline">\(q\)</span>.
Quand <span class="math inline">\(u \to +\infty\)</span>, <span class="math inline">\(\mathbf{Z} \to \mathbf{I}_s\)</span> : la diversité tend vers la diversité neutre.
Leinster et Cobbold suggèrent de comparer les profils de diversité en fonction à la fois de <span class="math inline">\(q\)</span> et de <span class="math inline">\(u\)</span>.</p>
</div>
<div id="sec-dqzEstimation" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> Estimation<a class="anchor" aria-label="anchor" href="#sec-dqzEstimation"><i class="fas fa-link"></i></a>
</h2>
<p>Comme les autres mesures de diversité, <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> est sujette au biais d’estimation.
Deux estimateurs réduisant le biais existent <span class="citation">(<a href="references.html#ref-Marcon2014e">Marcon, Zhang, et Hérault 2014</a>)</span>.
Le premier utilise la technique de <span class="citation">Chao et Shen (<a href="references.html#ref-Chao2003">2003</a>)</span> déjà vue pour la correction du biais de l’entropie de Shannon <a href="chap-MesuresNeutres.html#eq:ChaoShen">(3.37)</a>.
L’estimateur de <span class="math inline">\(^q\!H^{\mathbf{Z}}\)</span> est</p>
<p><span class="math display" id="eq:EstHqz">\[\begin{equation}
  \tag{9.9}
  ^q\!{\tilde{H}}^{\mathbf{Z}}
  = \sum_s{\frac{\hat{C}\hat{p}_s \ln_q \frac{1}{{\left(\widetilde{\mathbf{Zp}}\right)}_s}}{1-{\left(1-\hat{C}\hat{p}_s\right)}^n}},
\end{equation}\]</span></p>
<p>où</p>
<p><span class="math display" id="eq:EstZp">\[\begin{equation}
  \tag{9.10}
  {\left(\widetilde{\mathbf{Zp}}\right)}_s
  = \sum_t{{\hat{C}\hat{p}}_t z_{s,t}} +\left(1-\hat{C}\right)\bar{z}.
\end{equation}\]</span></p>
<p>L’estimateur de la diversité est <span class="math inline">\(^q\!{\tilde{D}}^{\mathbf{Z}} = e^{^q\!{\tilde{H}}^{\mathbf{Z}}}_q\)</span>.</p>
<p>L’autre estimateur suppose que la similarité des espèces non observées avec toutes les autres est la similarité moyenne observée.
L’estimation utilise la technique de <span class="citation">Z. Zhang et Grabchak (<a href="references.html#ref-Zhang2014">2016</a>)</span>, qui consiste à développer l’estimateur en série entière au voisinage de <span class="math inline">\(p_s=1\)</span>.
L’estimateur de <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> est, pour <span class="math inline">\(q\ne 1\)</span>,</p>
<p><span class="math display" id="eq:EstDqz">\[\begin{equation}
  \tag{9.11}
  ^q\!{\tilde{D}}^{\mathbf{Z}}
  = {\left\{\hat{K}+\hat{V}
    -\sum_{s\le s_{\ne 0}}{\hat{C}\hat{p}_s{\left[\bar{z}\left(1-\hat{C}\hat{p}_s\right)+\hat{C}\hat{p}_s\right]}^{q-1}}\right\}}
      ^{\frac{1}{1-q}}
\end{equation}\]</span></p>
<p>où</p>
<p><span class="math display" id="eq:EstKDqz">\[\begin{equation}
   \tag{9.12}
\hat{K}=\sum_{s\le s_{\ne 0}}{\hat{C}\hat{p}_s{\left[\left(\sum_{t\le s_{\ne 0}}{\hat{C}\hat{p}_t z_{s,t}}\right)+\left(1-\hat{C}\right)\bar{z}\right]}^{q-1}}
\end{equation}\]</span></p>
<p>et</p>
<p><span class="math display" id="eq:EstVDqz">\[\begin{equation}
  \tag{9.13}
  \hat{V}=1+\sum_{s\le s_{\ne 0}}{\frac{n_s}{n}\sum^{n-n_s}_{v=1}{{\left(1-\bar{z}\right)}^v\left[\prod^v_{i=1}{\frac{i-q}{i}}\right]\left[\prod^v_{j=1}{\left(1-\frac{n_s-1}{n-j}\right)}\right]}}.
\end{equation}\]</span></p>
<p>L’estimateur de <span class="math inline">\(^q\!H^{\mathbf{Z}}\)</span> est</p>
<p><span class="math display" id="eq:EstHqz2">\[\begin{equation}
  \tag{9.14}
  ^q\!{\tilde{H}}^{\mathbf{Z}}
  = \frac{\hat{K}+\hat{V}-\sum_{s\le s_{\ne 0}}{\hat{C}\hat{p}_s{\left[\bar{z}\left(1-\hat{C}\hat{p}_s\right)+\hat{C}\hat{p}_s\right]}^{q-1}}-1}{1-q}.
\end{equation}\]</span></p>
<p>Pour <span class="math inline">\(q=1\)</span>,</p>
<p><span class="math display" id="eq:EstH1z2">\[\begin{equation}
  \tag{9.15}
  ^1\!{\tilde{H}}^{\mathbf{Z}}
  = \hat{L}+\hat{W}+\sum_{s\le s_{\ne 0}}{\hat{C}\hat{p}_s\ln\left[\bar{z}\left(1-\hat{C}\hat{p}_s\right)+\hat{C}\hat{p}_s\right]},
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
  ^1\!{\tilde{D}}^{\mathbf{Z}}=e^{^1\!{\tilde{H}}^{\mathbf{Z}}},
\end{equation}\]</span></p>
<p>où</p>
<p><span class="math display" id="eq:EstLHqz2">\[\begin{equation}
  \tag{9.16}
  \hat{L}=-\sum_{s\le s_{\ne 0}}{\hat{C}\hat{p}_s \ln\left[\left(\sum_{t\le s_{\ne 0}}{{\hat{C}\hat{p}}_jz_{s,t}}\right)+\left(1-\hat{C}\right)\bar{z}\right]},
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
  \hat{W}=\sum_{s\le s_{\ne 0}}{\frac{n_s}{n}\sum^{n-n_s}_{v=1}{\frac{{\left(1-\bar{z}\right)}^v}{v}\left[\prod^v_{j=1}{\left(1-\frac{n_s-1}{n-j}\right)}\right]}}.
\end{equation}\]</span></p>
<p>Le package <em>entropart</em> fournit les fonctions <code>Dqz</code> et <code>HqZ</code> pour calculer ces estimateurs.</p>
<p></p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Paracou618</span><span class="op">)</span></span>
<span><span class="co"># Matrice de distances fonctionnelles</span></span>
<span><span class="va">DistanceMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Paracou618.dist</span><span class="op">)</span></span>
<span><span class="co"># Matrice de similarité</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">DistanceMatrix</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">DistanceMatrix</span><span class="op">)</span></span>
<span><span class="co"># Calcul de la diversité</span></span>
<span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/Dqz.html">Dqz</a></span><span class="op">(</span><span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Ns</span>, q <span class="op">=</span> <span class="fl">1</span>, <span class="va">Z</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     Best 
## 1.488083</code></pre>
<p></p>
</div>
<div id="diversité-phylogénétique" class="section level2" number="9.7">
<h2>
<span class="header-section-number">9.7</span> Diversité phylogénétique<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-phylog%C3%A9n%C3%A9tique"><i class="fas fa-link"></i></a>
</h2>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ArbreA6"></span>
<img src="images/ArbreA.png" alt="Arbre phylogénétique ou fonctionnel hypothétique. 5 espèces sont présentes (\(S=5\)), leurs probabilités notées \(p_1\) à \(p_5\). Les noms des branches sont affichés." width="80%"><p class="caption">
Figure 9.4: Arbre phylogénétique ou fonctionnel hypothétique. 5 espèces sont présentes (<span class="math inline">\(S=5\)</span>), leurs probabilités notées <span class="math inline">\(p_1\)</span> à <span class="math inline">\(p_5\)</span>. Les noms des branches sont affichés.
</p>
</div>
<p></p>
<p>La diversité phylogénétique <span class="math inline">\(^{q}\!\bar{D}(T)\)</span> appliquée à un arbre ultramétrique est un cas particulier de <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> pour une matrice <span class="math inline">\(\mathbf{Z}\)</span> dont les lignes et colonnes sont la similarité des “espèces historiques” <span class="citation">(<a href="references.html#ref-Leinster2012">Leinster et Cobbold 2012</a>, proposition A7)</span>, c’est-à-dire les couples (espèce <span style="white-space:nowrap">actuelle ;</span> branche ancestrale).</p>

<p></p>
<div class="inline-table"><table class="table table-striped" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:MatricePhylo">Table 9.1: </span><span id="tab:MatricePhylo">Table 9.2: </span>Matrice de similarité correspondant à l’arbre phylogénétique en exemple. Les noms des lignes et colonnes sont les couples (espèce <span style="white-space:nowrap">actuelle ;</span> branche ancestrale).
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\((1;b_{1,1})\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((1;b_{3,1})\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((2;b_{1,2})\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((2;b_{3,1})\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((3;b_{1,3})\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((3;b_{2,3})\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((4;b_{1,4})\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((4;b_{2,3})\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((5;b_{1,5})\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((5;b_{2,3})\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\((1;b_{1,1})\)</span>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\((1;b_{3,1})\)</span>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\((2;b_{1,2})\)</span>
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\((2;b_{3,1})\)</span>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\((3;b_{1,3})\)</span>
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\((3;b_{2,3})\)</span>
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\((4;b_{1,4})\)</span>
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\((4;b_{2,3})\)</span>
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\((5;b_{1,5})\)</span>
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\((5;b_{2,3})\)</span>
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table></div>
<p></p>
<p>Par exemple, l’espèce 1 et les branches <span class="math inline">\(b_{1,1}\)</span> et <span class="math inline">\(b_{3,1}\)</span> fournissent les deux premières lignes et colonnes de la <span style="white-space:nowrap">matrice ;</span> l’espèce 5 et les branches <span class="math inline">\(b_{1,5}\)</span> et <span class="math inline">\(b_{2,3}\)</span>, les deux dernières.</p>
<p>La diversité phylogénétique <span class="math inline">\(^{q}\!\hat{D}(T)\)</span> est obtenue quand les éléments de la matrice <span class="math inline">\(\mathbf{Z}\)</span> suivent les règles suivantes : les éléments de toutes les colonnes correspondant à une espèce donnée (par exemple les deux premières colonnes qui correspondent à l’espèce 1) valent 1 pour toutes les lignes correspondant à une branche dont l’espèce descend (les trois lignes correspondant aux branches <span class="math inline">\(b_{1,1}\)</span> et <span class="math inline">\(b_{3,1}\)</span><span style="white-space:nowrap">) ;</span> les éléments dont l’espèce en colonne ne descend pas de la branche en ligne valent 0.
La matrice n’est donc pas symétrique, mais c’est une matrice de similarité dont la diagonale vaut 1.</p>
<p>La probabilité de chaque espèce historique est la somme de celles des espèces actuelles qui en descendent, multipliée par la longueur de la branche normalisée par la hauteur de l’arbre.
Dans l’exemple, la hauteur totale de l’arbre est <span class="math inline">\(T=T_1 + T_2 + T_3\)</span>.
Les probabilités des espèces historiques sont
<span class="math display">\[(p_1 \frac{l(b_{1,1})}{T}, (p_1 + p_2) \frac{l(b_{3,1})}{T}, p_2 \frac{l(b_{1,2})}{T}, \dots, (p_3 + p_4 + p_5) \frac{l(b_{2,3})}{T}).\]</span></p>
<p>Les dimensions de la matrice de similarité et du vecteur de probabilités deviennent rapidement très grandes et leur écriture pénible : il est bien plus simple de calculer la diversité phylogénétique à partir des distances dans l’arbre et des probabilités des espèces.
Cette équivalence de méthodes n’a donc pas d’intérêt pratique mais montre que la diversité de Leinster et Cobbold généralise la diversité phylogénétique.
Cependant, le calcul de <span class="math inline">\(^q\!{\hat{D}}^{\mathbf{Z}}\)</span> à partir d’une matrice <span class="math inline">\(\mathbf{Z}\)</span> qui serait la simple transformation des distances de l’arbre phylogénétique, c’est-à-dire 1 moins les distances normalisées par la hauteur de l’arbre, ne donne pas la valeur de la diversité phylogénétique <span class="math inline">\(^{q}\!\bar{D}(T)\)</span>, sauf dans le cas particulier de la diversité de Rao, <span class="math inline">\(q=2\)</span>.</p>
<p>Pour un arbre non ultramétrique, il est possible de définir une matrice <span class="math inline">\(\mathbf{Z}\)</span> similaire à celle de la table <a href="chap-LeinsterCobbold.html#tab:MatricePhylo">9.1</a>, mais ses valeurs non nulles ne sont pas égales à 1.
Elles sont égales au rapport de <span class="math inline">\(\bar{T}\)</span>, la longueur moyenne des branches pondérée par la fréquence des espèces, sur la longueur de la branche : elles dépendent donc des fréquences des espèces et empêchent par conséquent la comparaison de la diversité entre communautés différentes.</p>
</div>
<div id="diversité-individuelle-1" class="section level2" number="9.8">
<h2>
<span class="header-section-number">9.8</span> Diversité individuelle<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-individuelle-1"><i class="fas fa-link"></i></a>
</h2>
<p>La diversité <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> et tous ses cas particuliers (phylodiversité et diversité neutre) peuvent être envisagés au niveau individuel plutôt qu’au niveau de l’espèce.</p>
<p>Le calcul de la diversité n’est pas affecté par le remplacement d’une espèce par deux espèces identiques.
La ligne et la colonne de la matrice <span class="math inline">\(\mathbf{Z}\)</span>, correspondant à l’espèce <span class="math inline">\(s\)</span> sont remplacées par deux lignes et colonnes identiques correspondant aux espèces <span class="math inline">\(s'\)</span> et <span class="math inline">\(s''\)</span>, dont la similarité avec les autres espèces est la même que celle de l’espèce <span class="math inline">\(s\)</span> et la similarité entre elles égale à 1, les probabilités vérifiant <span class="math inline">\(p_s=p_{s'}+p_{s''}\)</span>.
L’opération peut être répétée jusqu’à la désagrégation complète de la matrice où chaque ligne correspondrait à un individu et les probabilités seraient égales à <span class="math inline">\({1}/{N}\)</span>.
Il n’y donc pas de différence entre la mesure de la diversité individuelle et celle de la diversité spécifique qui n’est qu’une façon pratique de regrouper des individus ayant la même banalité.
Dit autrement, l’entropie d’une communauté est la somme des entropie de ses espèces, qui n’est que la somme pondérée des entropies individuelles si tous les individus d’une espèce ont la même entropie.</p>
<p>La variabilité intraspécifique peut être traitée par un raisonnement similaire.
L’idée d’intégrer aux mesures de diversité la possibilité que tous les individus d’une espèce ne soient pas semblables émerge dans la littérature <span class="citation">(<a href="references.html#ref-Pavoine2014b">Pavoine et Ricotta 2014</a>; <a href="references.html#ref-Chiu2014b">Chiu et Chao 2014</a>)</span>.
Mais si des individus de la même espèce ne sont pas totalement similaires, ils ne peuvent pas être regroupés en prenant pour similarité de l’espèce avec elle-même une valeur unique qui résumerait la similarité entre les individus (au lieu de 1) pour tous les ordres de diversité.</p>
<p>Formellement, si l’espèce <span class="math inline">\(s\)</span> est composée de deux groupes <span class="math inline">\(s'\)</span> et <span class="math inline">\(s''\)</span>, la banalité du groupe <span class="math inline">\(s'\)</span> est
<span class="math display">\[{\left(\mathbf{Zp}\right)}_{s'}=\sum_{t \ne s', s''}{p_{t}z_{s',t}} + p_{s'} + p_{s''}z_{s',s''},\]</span>
celle du groupe <span class="math inline">\(s''\)</span> est
<span class="math display">\[{\left(\mathbf{Zp}\right)}_{s''}=\sum_{t \ne s', s''}{p_{t}z_{s'',t}} + p_{s'}z_{s',s''} + p_{s''}.\]</span>
Les similarités avec les autres espèces sont identiques : <span class="math inline">\(z_{s,t}=z_{s',t}=z_{s'',t}\)</span>.
La contribution à la diversité des deux groupes
<span class="math display">\[\sum_{s'}{p_{s'}{\left(\mathbf{Zp}\right)}^{q-1}_{s'}}+\sum_{s''}{p_{s''}{\left(\mathbf{Zp}\right)}^{q-1}_{s''}}\]</span>
est remplacée après regroupement par
<span class="math display">\[\sum_{s}{p_{s}{\left(\mathbf{Zp}\right)}^{q-1}_{s}}.\]</span>
Puisque <span class="math inline">\(p_s=p_{s'}+p_{s''}\)</span>, le regroupement n’est possible quel que soit <span class="math inline">\(q\)</span> que si les banalités des deux groupes sont identiques, ce qui interdit toute variabilité intraspécifique : <span class="math inline">\(z_{s',s''}\)</span> est obligatoirement égal à 1.
La non-linéarité de la moyenne généralisée ne permet pas de définir une matrice de similarité intégrant la variabilité intraspécifique.</p>
<p>Dans le cas de la diversité de Rao (<span class="math inline">\(q=2\)</span>), on peut chercher la valeur de <span class="math inline">\(z_{s,s}\)</span>, différente de 1, définissant la similarité de l’espèce avec elle même pour prendre en compte sa variabilité.
La résolution de l’équation
<span class="math display">\[\sum_{s'}{p_{s'}{\left(\mathbf{Zp}\right)}_{s'}}+\sum_{s''}{p_{s''}{\left(\mathbf{Zp}\right)}_{s''}} = \sum_{s}{p_{s}{\left(\mathbf{Zp}\right)}_{s}}\]</span>
permet de trouver
<span class="math display">\[z_{s,s}=1+ \frac{2 p_{s'} p_{s''}(z_{s',s''}-1)}{p_s^2}.\]</span>
Dans le cas le plus simple où <span class="math inline">\(p_{s'}=p_{s''}\)</span>, la similarité intraspécifique est <span class="math inline">\({(1+z_{s',s''})}/{2}\)</span>.
La valeur de <span class="math inline">\(z_{s,s}\)</span> peut être cherchée pour n’importe quelle valeur de <span class="math inline">\(q\)</span>, mais la résolution de l’équation est en général impossible analytiquement, et <span class="math inline">\(z_{s,s}\)</span> varie avec <span class="math inline">\(q\)</span>.
Se limiter à <span class="math inline">\(q=2\)</span> simplifie le problème.</p>
<p>L’exemple suivant considère deux espèces, dont une comprenant deux groupes :</p>
<p></p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Similarité entre les deux groupes</span></span>
<span><span class="va">zs12</span> <span class="op">&lt;-</span> <span class="fl">0.9</span></span>
<span><span class="co"># Probabilités des deux groupes</span></span>
<span><span class="va">ps1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span></span>
<span><span class="va">ps2</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span></span>
<span><span class="co"># Matrice de similarité</span></span>
<span><span class="op">(</span><span class="va">Z2s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">zs12</span>, <span class="fl">0.5</span>, <span class="va">zs12</span>, <span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  1.0  0.9  0.5
## [2,]  0.9  1.0  0.5
## [3,]  0.5  0.5  1.0</code></pre>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Probabilités</span></span>
<span><span class="op">(</span><span class="va">P2s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ps1</span>, <span class="va">ps2</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">ps1</span> <span class="op">-</span> <span class="va">ps2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.2 0.2 0.6</code></pre>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diversité</span></span>
<span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/Dqz.html">Dqz</a></span><span class="op">(</span><span class="va">P2s</span>, <span class="fl">2</span>, <span class="va">Z2s</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     None 
## 1.329787</code></pre>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Similarité intraspécifique après regroupement</span></span>
<span><span class="op">(</span><span class="va">zss</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">ps1</span> <span class="op">*</span> <span class="va">ps2</span><span class="op">/</span><span class="op">(</span><span class="va">ps1</span> <span class="op">+</span> <span class="va">ps2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">zs12</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.95</code></pre>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Matrice de similarité après regroupement</span></span>
<span><span class="op">(</span><span class="va">Z1s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">zss</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,] 0.95  0.5
## [2,] 0.50  1.0</code></pre>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Probabilité après regroupement</span></span>
<span><span class="op">(</span><span class="va">P1s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ps1</span> <span class="op">+</span> <span class="va">ps2</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">ps1</span> <span class="op">-</span> <span class="va">ps2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.4 0.6</code></pre>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diversité</span></span>
<span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/Dqz.html">Dqz</a></span><span class="op">(</span><span class="va">P1s</span>, <span class="fl">2</span>, <span class="va">Z1s</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     None 
## 1.329787</code></pre>
<p></p>
<p>En pratique, si les similarités entre individus ou groupes sont connues, le regroupement n’a aucun intérêt.
Mais en absence de données individuelles, il est possible de choisir arbitrairement une similarité intraspécifique différente de 1 (ou de façon équivalente une distance différente de 0) pour calculer une diversité d’ordre fixé, de préférence 2.</p>
</div>
<div id="diversité-des-valeurs-propres" class="section level2" number="9.9">
<h2>
<span class="header-section-number">9.9</span> Diversité des valeurs propres<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-des-valeurs-propres"><i class="fas fa-link"></i></a>
</h2>
<p>L’approche de <span class="citation">Pavoine et Izsák (<a href="references.html#ref-Pavoine2014">2014</a>)</span> permet de prendre en compte la variabilité intraspécifique de façon rigoureuse.
Pour mesurer la diversité neutre, les espèces sont placées dans un espace multidimensionnel, de dimension <span class="math inline">\(S\)</span>.
Chaque espèce est représentée par un vecteur de longueur <span class="math inline">\(p_s\)</span> sur son axe.
Cette représentation a été utilisée par <span class="citation">Campos et Isaza (<a href="references.html#ref-Campos2009">2009</a>)</span> qui ont relié la diversité de Simpson au volume de la sphère sur laquelle se trouve le point définissant la communauté (figure <a href="chap-LeinsterCobbold.html#fig:Campos2009">9.5</a>).</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Campos2009"></span>
<img src="images/Campos2009.png" alt="Représentation d’une communauté dans un espace multidimensionnel dont chaque axe correspond à une espèce. La communauté est composée de trois espèces. Le point représentant la communauté se trouve sur la sphère de rayon \(r=\sqrt{\sum_s{p_s^2}}\). Le plan (qui est en réalité un hyperplan de dimension \(S-1\)) d’équation \(\sum_s{p_s}=1\) est représenté par un triangle." width="50%"><p class="caption">
Figure 9.5: Représentation d’une communauté dans un espace multidimensionnel dont chaque axe correspond à une espèce. La communauté est composée de trois espèces. Le point représentant la communauté se trouve sur la sphère de rayon <span class="math inline">\(r=\sqrt{\sum_s{p_s^2}}\)</span>. Le plan (qui est en réalité un hyperplan de dimension <span class="math inline">\(S-1\)</span>) d’équation <span class="math inline">\(\sum_s{p_s}=1\)</span> est représenté par un triangle.
</p>
</div>
<p></p>
<p>La matrice de similarité entre les espèces <span class="math inline">\(\mathbf{Z}\)</span> permet d’affiner la représentation.
Soit la matrice <span class="math inline">\(\mathbf{C}=\sqrt{\mathbf{Z}}\)</span>.
Chaque espèce <span class="math inline">\(s\)</span> est maintenant représentée par le vecteur dont la coordonnée sur l’axe <span class="math inline">\(t\)</span> est <span class="math inline">\(\sqrt{p_s p_t}c_{s,t}\)</span>.
Les axes correspondent aux espèces “pures”, totalement dissimilaires, les vecteurs des espèces réelles prennent en compte la similarité.
Dans le cas extrême de la diversité neutre, <span class="math inline">\(\mathbf{C}=\mathbf{I}\)</span>, chaque espèce est située uniquement sur son axe.
Dans l’autre cas extrême de totale similarité, où <span class="math inline">\(\mathbf{C}\)</span> ne contient que des 1, toutes les espèces sont colinéaires.</p>
<p>Il est possible de calculer les <span class="math inline">\(S\)</span> valeurs propres notées <span class="math inline">\(\lambda_s\)</span> de la matrice des coordonnées des espèces et de les normaliser : <span class="math inline">\(\mu_s={\lambda_s}/{\sum_s{\lambda_s}}\)</span>.
La communauté peut maintenant être représentée par ses valeurs propres <span class="math inline">\(\mu_s\)</span> correspondant à la proportion d’une “espèce composite” pure sur chaque axe généré par les vecteurs propres : cette transformation est une ACP non centrée, non réduite.
La diversité HCDT des valeurs propres est la diversité de la communauté, qui sera notée ici <span class="math inline">\(^q\!D^{\mathbf{Z}}(\Lambda)\)</span>.</p>
<p>La définition de cette diversité autorise toute matrice <span class="math inline">\(\mathbf{C}\)</span> symétrique, dont les valeurs de similarité sont positives ou nulles, strictement positives sur la diagonale.
Si <span class="math inline">\(\mathbf{C}\)</span> est la racine carrée d’une matrice de similarité au sens strict <span class="math inline">\(\mathbf{Z}\)</span>, c’est-à-dire contenant des valeurs comprises entre 0 et 1 et dont les éléments de la diagonale sont tous égaux à 1, alors <span class="math inline">\(^2\!D^{\mathbf{Z}}(\Lambda)\)</span> est égale à la diversité de Rao appliquée à une matrice de distances <span class="math inline">\(\mathbf{D}=1-\mathbf{Z}\)</span>.
La définition de <span class="math inline">\(\mathbf{C}\)</span> comme racine carrée de <span class="math inline">\(\mathbf{Z}\)</span> se justifie par des raisons géométriques : la norme de chaque vecteur représentant une espèce est la racine carrée de la somme des carrés de ses coordonnées.
Le carré de la norme du vecteur de l’espèce <span class="math inline">\(s\)</span> est donc <span class="math inline">\(p_s\)</span> multiplié par la banalité de l’espèce.</p>
<p>Si <span class="math inline">\(\mathbf{Z}=\mathbf{I}_s\)</span>, l’ACP ne modifie pas le nuage de points original et <span class="math inline">\(^q\!D^{\mathbf{Z}}(\Lambda)={^{q}\!D}\)</span>.</p>
<p>L’exemple suivant calcule la diversité de la méta-communauté <code>Paracou618</code> selon la matrice de distances <code>Paracou618.dist</code>.</p>
<p></p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Probabilités</span></span>
<span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Ps</span><span class="op">[</span><span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Ps</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="co"># Matrice de distances fonctionnelles</span></span>
<span><span class="va">DistanceMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Paracou618.dist</span><span class="op">)</span></span>
<span><span class="co"># Mise en correspondance de la matrice et du vecteur de</span></span>
<span><span class="co"># probabilités</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="va">DistanceMatrix</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Ps</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Ps</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Normalisation</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span>
<span><span class="co"># Transformation en matrice de similarité</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">D</span></span>
<span><span class="co"># Matrice diagonale contenant les probabilités</span></span>
<span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">Ps</span><span class="op">)</span></span>
<span><span class="co"># Matrice des espèces (les lignes de Sp sont les</span></span>
<span><span class="co"># coordonnées des vecteurs)</span></span>
<span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span></span>
<span><span class="co"># Valeurs propres normalisées</span></span>
<span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">Sp</span><span class="op">)</span><span class="op">$</span><span class="va">d</span></span>
<span><span class="va">Mu</span> <span class="op">&lt;-</span> <span class="va">Lambda</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Lambda</span><span class="op">)</span></span>
<span><span class="co"># Comparaison des valeurs à q=2</span></span>
<span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/Diversity.html">Diversity</a></span><span class="op">(</span><span class="va">Mu</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     None 
## 1.540061</code></pre>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diversité de Rao</span></span>
<span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/Dqz.html">Dqz</a></span><span class="op">(</span><span class="va">Ps</span>, <span class="fl">2</span>, <span class="va">Z</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     None 
## 1.490786</code></pre>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># La valeur à q=0 est le nombre d'espèces</span></span>
<span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/Diversity.html">Diversity</a></span><span class="op">(</span><span class="va">Mu</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code>## None 
##  229</code></pre>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Ps</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 229</code></pre>
<p></p>
<p>La valeur de la diversité des valeurs propres est différente de celle de la diversité de Rao à cause des approximations numériques liées au calcul des valeurs propres (qui nécessitent l’inversion d’une matrice carrée de dimension <span class="math inline">\(S\)</span>).
La valeur exacte est celle donnée par <code><a href="https://ericmarcon.github.io/entropart/reference/Dqz.html">Dqz()</a></code>.</p>
<p>Le profil de diversité se trouve en figure <a href="chap-LeinsterCobbold.html#fig:DqZLambdaFig">9.6</a>.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:DqZLambdaFig"></span>
<img src="MesuresBD_files/figure-html/DqZLambdaFig-1.png" alt="Profil de diversité des valeurs propres de la méta-communauté Paracou618." width="80%"><p class="caption">
Figure 9.6: Profil de diversité des valeurs propres de la méta-communauté <code>Paracou618</code>.
</p>
</div>
<p></p>
<p>Code R pour la figure :</p>
<p></p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DqZLambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/CommunityProfile.html">CommunityProfile</a></span><span class="op">(</span><span class="va">Diversity</span>, <span class="va">Mu</span><span class="op">)</span></span>
<span><span class="va">Xlab</span> <span class="op">&lt;-</span> <span class="st">"Ordre de diversité"</span></span>
<span><span class="va">Ylab</span> <span class="op">&lt;-</span> <span class="st">"Diversité"</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">DqZLambda</span>, xlab <span class="op">=</span> <span class="va">Xlab</span>, ylab <span class="op">=</span> <span class="va">Ylab</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>La diversité des valeurs propres permet de ramener le problème de la diversité d’espèces partiellement similaires au calcul de la diversité neutre d’une communauté d’espèces composites totalement dissimilaires.</p>
<p>Les éléments de la diagonale de la matrice de similarité ne sont pas forcément égaux à 1 : des valeurs inférieures correspondent à la variabilité intraspécifique, selon le mécanisme de regroupement traité au paragraphe précédent.
Les raisons qui empêchent d’utiliser des valeurs de similarité intraspécifique différentes de 1 dans le calcul de la diversité de Leinster et Cobbold ne s’appliquent pas ici : quelle que soit la valeur de <span class="math inline">\(q\)</span>, les valeurs propres sont les mêmes.</p>
<p>Les limites de la diversité des valeurs propres sont cependant nombreuses.
La première est numérique : son calcul est imprécis dans des communautés très riches.
L’inversion d’une matrice de dimension 200 ou plus est toujours problématique.</p>
<p>Les espèces non échantillonnées entraînent un biais d’estimation : le nombre de dimensions est sous-estimé.
Comme les espèces manquantes ont une faible probabilité, leur vecteur est petit et n’influe pas beaucoup sur la diagonalisation de la matrice.
Les valeurs propres manquantes sont donc petites.
Elles influent sur la diversité pour les faibles valeurs de <span class="math inline">\(q\)</span>, notamment la diversité d’ordre 0 qui est le nombre de dimensions de la matrice des espèces (en général, le nombre d’espèces, ou une valeur inférieure si des espèces sont colinéaires).
Il n’existe pas de technique pour corriger ce biais d’estimation.</p>
<p>La composition de la communauté en espèces composites dépend à la fois de la matrice de similarité et des probabilités des espèces réelles.
Elle est donc unique pour chaque communauté, ce qui empêche toute décomposition de la diversité selon les méthodes présentées plus loin.</p>
</div>
<div id="sec-dqzSynthese" class="section level2" number="9.10">
<h2>
<span class="header-section-number">9.10</span> Synthèse<a class="anchor" aria-label="anchor" href="#sec-dqzSynthese"><i class="fas fa-link"></i></a>
</h2>
<p><span class="math inline">\(^{q}\!D(T)\)</span> est l’exponentielle d’ordre <span class="math inline">\(q\)</span> de la moyenne pondérée de l’entropie HCDT calculée à chaque période de l’arbre phylogénétique.</p>
<p><span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> est l’exponentielle d’ordre <span class="math inline">\(q\)</span> de l’entropie de Ricotta et Szeidl, mais aussi l’inverse de la banalité moyenne des espèces de la communauté.</p>
<p><span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> et <span class="math inline">\(^{q}\!D\)</span> sont des nombres effectifs d’espèces, respectent toutes les propriétés demandées à une mesure de diversité dont le principe de réplication.
Leurs valeurs sont identiques pour <span class="math inline">\(q=2\)</span> (diversité de Rao).
<span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> est moins sensible au paramètre <span class="math inline">\(q\)</span> que <span class="math inline">\(^{q}\!D(T)\)</span> : la figure <a href="chap-LeinsterCobbold.html#fig:ComparaisonDqFig">9.7</a> compare les deux mesures.</p>
<p>Le rôle du paramètre est assez différent : dans <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span>, la banalité des espèces est à la puissance <span class="math inline">\(q\)</span> alors que leur probabilité est à la puissance 1.
Le paramètre détermine l’importance donnée aux espèces <em>originales</em>, c’est-à-dire dont la banalité est petite, et non aux espèces <em>rares</em>.
Les deux notions se confondent quand la diversité neutre est considérée : la banalité d’une espèce se réduit alors à sa fréquence.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ComparaisonDqFig"></span>
<img src="MesuresBD_files/figure-html/ComparaisonDqFig-1.png" alt="Diversité phylogénétique (l’arbre est une taxonomie) d’ordre \(q\) de deux hectares de forêt de Paracou : \(^q\!D^{\mathbf{Z}}\) (trait plein) et \(^{q}\!\hat{D}(T)\) (pointillé)." width="80%"><p class="caption">
Figure 9.7: Diversité phylogénétique (l’arbre est une taxonomie) d’ordre <span class="math inline">\(q\)</span> de deux hectares de forêt de Paracou : <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> (trait plein) et <span class="math inline">\(^{q}\!\hat{D}(T)\)</span> (pointillé).
</p>
</div>
<p></p>
<p>Le code R nécessaire pour réaliser la figure est :</p>
<p></p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Réutilisation de Paracou618.Taxonomy au format phylog</span></span>
<span><span class="co"># (cf. calcul de FAD)</span></span>
<span><span class="va">DistanceMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">$</span><span class="va">Wdist</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">DistanceMatrix</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">DistanceMatrix</span><span class="op">)</span></span>
<span><span class="va">Divqz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">q</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/Dqz.html">Dqz</a></span><span class="op">(</span><span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Ps</span>, <span class="va">q</span>, <span class="va">Z</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Divq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">q</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/ChaoPD.html">ChaoPD</a></span><span class="op">(</span><span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Ps</span>, q <span class="op">=</span> <span class="va">q</span>,</span>
<span>    PhyloTree <span class="op">=</span> <span class="va">Paracou618.Taxonomy</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">q</span>, <span class="va">Divq</span>, <span class="va">Divqz</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">q</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Divqz</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Divq</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Diversité"</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p><span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span> est particulièrement intéressante pour mesurer la diversité fonctionnelle, souvent définie à partir d’une matrice de distances entre les espèces.
La transformation d’une matrice en un arbre phylogénétique déforme les données <span class="citation">(<a href="references.html#ref-Pavoine2005a">Pavoine, Ollier, et Dufour 2005</a>; <a href="references.html#ref-Podani2006">Podani et Schmera 2006</a>, <a href="references.html#ref-Podani2007">2007</a>)</span>.
La diversité de Leinster et Cobbold est calculée directement à partir de la matrice.</p>
<p>Si l’arbre phylogénétique n’est pas ultramétrique, le calcul de la diversité est possible, mais la matrice <span class="math inline">\(\mathbf{Z}\)</span> contient alors des valeurs comprises entre 0 et 1 qui dépendent des effectifs des espèces actuelles (ils interviennent dans le calcul de la hauteur de l’arbre qui est la moyenne de la longueur des branches).
La dépendance entre similarité et fréquence des espèces constitue un problème théorique qui empêche d’interpréter la diversité calculée à partir d’un arbre non ultramétrique.</p>
<p>Enfin, il est possible de désagréger les données jusqu’au niveau individuel si la distance entre paires d’individus est connue.
En revanche, la prise en compte de la variabilité intraspécifique par une similarité intraspécifique inférieure à 1 n’est possible que pour un ordre de diversité fixé : il n’est pas possible d’obtenir un profil de diversité de cette façon.</p>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="chap-Phyloentropie.html"><span class="header-section-number">8</span> Entropie phylogénétique</a></div>
<div class="next"><a href="sec-betaCadre.html"><span class="header-section-number">10</span> Cadre</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-LeinsterCobbold"><span class="header-section-number">9</span> Diversité de Leinster et Cobbold</a></li>
<li><a class="nav-link" href="#d%C3%A9finitions"><span class="header-section-number">9.1</span> Définitions</a></li>
<li><a class="nav-link" href="#diversit%C3%A9-neutre"><span class="header-section-number">9.2</span> Diversité neutre</a></li>
<li><a class="nav-link" href="#diversit%C3%A9-non-neutre"><span class="header-section-number">9.3</span> Diversité non neutre</a></li>
<li><a class="nav-link" href="#entropie-de-ricotta-et-szeidl"><span class="header-section-number">9.4</span> Entropie de Ricotta et Szeidl</a></li>
<li><a class="nav-link" href="#d%C3%A9finition-de-la-similarit%C3%A9"><span class="header-section-number">9.5</span> Définition de la similarité</a></li>
<li><a class="nav-link" href="#sec-dqzEstimation"><span class="header-section-number">9.6</span> Estimation</a></li>
<li><a class="nav-link" href="#diversit%C3%A9-phylog%C3%A9n%C3%A9tique"><span class="header-section-number">9.7</span> Diversité phylogénétique</a></li>
<li><a class="nav-link" href="#diversit%C3%A9-individuelle-1"><span class="header-section-number">9.8</span> Diversité individuelle</a></li>
<li><a class="nav-link" href="#diversit%C3%A9-des-valeurs-propres"><span class="header-section-number">9.9</span> Diversité des valeurs propres</a></li>
<li><a class="nav-link" href="#sec-dqzSynthese"><span class="header-section-number">9.10</span> Synthèse</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/EricMarcon/MesuresBioDiv2/blob/master/03-Phylodiversite.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/EricMarcon/MesuresBioDiv2/edit/master/03-Phylodiversite.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Mesures de la Biodiversité</strong>" was written by Eric Marcon. It was last built on 05/12/2024.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
