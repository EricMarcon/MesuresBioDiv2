<!DOCTYPE html>
<html lang="fr-FR">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>21 Accumulation de la diversité locale | Mesures de la Biodiversité</title>
<meta name="author" content="Eric Marcon">
<meta name="description" content="La courbe d’accumulation (SAC) décrit comment la richesse, ou la diversité, augmente en fonction de l’effort d’échantillonnage. Sous l’hypothèse d’un tirage multinomial des individus observés, les...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="21 Accumulation de la diversité locale | Mesures de la Biodiversité">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/EricMarcon/MesuresBioDiv2/chap-Accumulation.html">
<meta property="og:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<meta property="og:description" content="La courbe d’accumulation (SAC) décrit comment la richesse, ou la diversité, augmente en fonction de l’effort d’échantillonnage. Sous l’hypothèse d’un tirage multinomial des individus observés, les...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="21 Accumulation de la diversité locale | Mesures de la Biodiversité">
<meta name="twitter:description" content="La courbe d’accumulation (SAC) décrit comment la richesse, ou la diversité, augmente en fonction de l’effort d’échantillonnage. Sous l’hypothèse d’un tirage multinomial des individus observés, les...">
<meta name="twitter:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-C1B3PLBCM6"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-C1B3PLBCM6');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Mesures de la Biodiversité</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Motivation</a></li>
<li><a class="" href="calculs-et-donn%C3%A9es.html">Calculs et données</a></li>
<li><a class="" href="notations.html">Notations</a></li>
<li class="book-part">Notions</li>
<li><a class="" href="chap-Notions.html"><span class="header-section-number">1</span> Notions de Diversité</a></li>
<li><a class="" href="chap-Outils.html"><span class="header-section-number">2</span> Outils</a></li>
<li class="book-part">Diversité neutre d’une communauté</li>
<li><a class="" href="chap-MesuresNeutres.html"><span class="header-section-number">3</span> Mesures neutres de la diversité \(\alpha\) ou \(\gamma\)</a></li>
<li><a class="" href="entropie.html"><span class="header-section-number">4</span> Entropie</a></li>
<li><a class="" href="sec-Equitabilite.html"><span class="header-section-number">5</span> Équitabilité</a></li>
<li class="book-part">Diversité fonctionnelle et phylogénétique</li>
<li><a class="" href="chap-cadrephyfonc.html"><span class="header-section-number">6</span> Cadre</a></li>
<li><a class="" href="mesures-particuli%C3%A8res.html"><span class="header-section-number">7</span> Mesures particulières</a></li>
<li><a class="" href="chap-Phyloentropie.html"><span class="header-section-number">8</span> Entropie phylogénétique</a></li>
<li><a class="" href="chap-LeinsterCobbold.html"><span class="header-section-number">9</span> Diversité de Leinster et Cobbold</a></li>
<li class="book-part">Diversité beta et décomposition</li>
<li><a class="" href="sec-betaCadre.html"><span class="header-section-number">10</span> Cadre</a></li>
<li><a class="" href="chap-BetaPaires.html"><span class="header-section-number">11</span> Diversité de différentiation</a></li>
<li><a class="" href="chap-DedompHCDT.html"><span class="header-section-number">12</span> Décomposition de l’entropie HCDT</a></li>
<li><a class="" href="d%C3%A9composition-de-la-diversit%C3%A9-phylog%C3%A9n%C3%A9tique-et-fonctionnelle.html"><span class="header-section-number">13</span> Décomposition de la diversité phylogénétique et fonctionnelle</a></li>
<li><a class="" href="tests-de-significativit%C3%A9.html"><span class="header-section-number">14</span> Tests de significativité</a></li>
<li><a class="" href="sec-betaAutres.html"><span class="header-section-number">15</span> Autres approches</a></li>
<li class="book-part">Diversité jointe, diversité structurelle</li>
<li><a class="" href="sec-jointeCadre.html"><span class="header-section-number">16</span> Cadre</a></li>
<li><a class="" href="information-mutuelle.html"><span class="header-section-number">17</span> Information mutuelle</a></li>
<li><a class="" href="chap-DiversiteJointe.html"><span class="header-section-number">18</span> Décomposition de la diversité jointe</a></li>
<li class="book-part">Diversité spatialement explicite</li>
<li><a class="" href="sec-spatialCadre.html"><span class="header-section-number">19</span> Cadre</a></li>
<li><a class="" href="chap-Fisher.html"><span class="header-section-number">20</span> Indice \(\alpha\) de Fisher</a></li>
<li><a class="active" href="chap-Accumulation.html"><span class="header-section-number">21</span> Accumulation de la diversité locale</a></li>
<li><a class="" href="diversit%C3%A9-r%C3%A9gionale.html"><span class="header-section-number">22</span> Diversité régionale</a></li>
<li><a class="" href="chap-betasp.html"><span class="header-section-number">23</span> Diversité \(\beta\) spatialement explicite</a></li>
<li class="book-part">Conclusion</li>
<li><a class="" href="sec-conclusionSynthese.html"><span class="header-section-number">24</span> Synthèse</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/EricMarcon/MesuresBioDiv2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-Accumulation" class="section level1" number="21">
<h1>
<span class="header-section-number">21</span> Accumulation de la diversité locale<a class="anchor" aria-label="anchor" href="#chap-Accumulation"><i class="fas fa-link"></i></a>
</h1>
<div class="Summary">
<p>La courbe d’accumulation (SAC) décrit comment la richesse, ou la diversité, augmente en fonction de l’effort d’échantillonnage.
Sous l’hypothèse d’un tirage multinomial des individus observés, les formules de raréfaction (estimation du nombre d’espèces pour une surface inférieure à celle inventoriée) sont bien contenues.
La structure spatiale rend les observations dépendantes entre elles et doit être prise en compte.</p>
</div>
<p>Les propriétés des courbes d’accumulation ont été largement étudiées dans la littérature, notamment pour prédire la richesse spécifique (section <a href="chap-MesuresNeutres.html#sec-RichesseSAC">3.1.3</a>).</p>
<p>L’influence de la structure spatiale est considérable mais souvent négligée parce que difficile à prendre en compte.
Quelques méthodes sont pourtant applicables.</p>
<div id="sec-SAC" class="section level2" number="21.1">
<h2>
<span class="header-section-number">21.1</span> Courbes d’accumulation<a class="anchor" aria-label="anchor" href="#sec-SAC"><i class="fas fa-link"></i></a>
</h2>
<p>On suppose que la communauté locale est de taille fixe et contient donc un nombre fixe d’espèces, et que leur découverte progressive aboutira à une asymptote de la SAC.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Gotelli2001"></span>
<img src="images/Gotelli2001.png" alt="Courbes d’accumulation et de raréfaction, obtenues par inventaires individuels ou groupés (samples). Les courbes de raréfaction permettent de lisser les courbes d’accumulation. Les courbes obtenues par inventaire groupé sont en général en dessous des courbes individuelles à cause de l’agrégation spatiale." width="80%"><p class="caption">
Figure 21.1: Courbes d’accumulation et de raréfaction, obtenues par inventaires individuels ou groupés (<em>samples</em>). Les courbes de raréfaction permettent de lisser les courbes d’accumulation. Les courbes obtenues par inventaire groupé sont en général en dessous des courbes individuelles à cause de l’agrégation spatiale.
</p>
</div>
<p></p>
<p><span class="citation">Gotelli et Colwell (<a href="references.html#ref-Gotelli2001" role="doc-biblioref">2001</a>)</span> proposent une revue des problèmes les plus communément rencontrés dans l’estimation et la comparaison de la richesse spécifique.
Ils suggèrent notamment de calculer la courbe de raréfaction (figure <a href="chap-Accumulation.html#fig:Gotelli2001">21.1</a>) plutôt que d’utiliser la courbe d’accumulation obtenue en traçant simplement le nombre d’espèces découvert en fonction de l’effort d’échantillonnage.
La courbe de raréfaction est obtenue en sous-échantillonnant dans l’inventaire complet des effectifs de toutes tailles et en calculant le nombre moyen d’espèces trouvé pour chacun, ce qui permet de la lisser.
La formulation exacte de la courbe de raréfaction et de sa variance est connue <span class="citation">(<a href="references.html#ref-Ugland2003" role="doc-biblioref">Ugland, Gray, et Ellingsen 2003</a>)</span>.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:specaccumFig"></span>
<img src="MesuresBD_files/figure-html/specaccumFig-1.png" alt="Courbe d’accumulation des espèces d’arbres de Barro Colorado Island. Calcul par specaccum : accumulation des 50 carrés avec permutations." width="80%"><p class="caption">
Figure 21.2: Courbe d’accumulation des espèces d’arbres de Barro Colorado Island. Calcul par specaccum : accumulation des 50 carrés avec permutations.
</p>
</div>
<p></p>
<p>La fonction <code>specaccum</code> de la librairie <em>vegan</em> <span class="citation">(<a href="references.html#ref-Oksanen2012" role="doc-biblioref">Oksanen et al. 2012</a>)</span> permet de tracer les SAC (figure <a href="chap-Accumulation.html#fig:specaccumFig">21.2</a>) selon différentes méthodes, avec un intervalle de confiance obtenu par permutation de l’ordre d’ajout des données ou à partir des formules de raréfaction.</p>
<p>Le code R nécessaire pour réaliser la figure est :</p>
<p></p>
<div class="sourceCode" id="cb344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span>
<span><span class="va">SAC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/specaccum.html">specaccum</a></span><span class="op">(</span><span class="va">BCI</span>, <span class="st">"random"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">SAC</span>, ci.type <span class="op">=</span> <span class="st">"poly"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, ci.lty <span class="op">=</span> <span class="fl">0</span>, ci.col <span class="op">=</span> <span class="st">"lightgray"</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>Pour une surface donnée, le nombre d’individus est une variable aléatoire.
Dans ce cas, la SAC (dépendant de la surface) est différente de la courbe de raréfaction (fonction du nombre d’individus) de Gotelli et Colwell, que <span class="citation">Coleman (<a href="references.html#ref-Coleman1981" role="doc-biblioref">1981</a>)</span> nomme “courbe du collecteur”.</p>
<p>La SAC théorique en fonction de la surface contient une incertitude concernant le nombre d’individus.
Si la densité <span class="math inline">\(\lambda_s\)</span> (nombre d’individus par unité de surface) des espèces peut être connue (estimée en comptant les individus) ou si les probabilités <span class="math inline">\(p_s\)</span> sont issues d’un modèle (log-séries, log-normal…), le nombre d’individus observés de l’espèce <span class="math inline">\(s\)</span> suit une loi de Poisson d’espérance <span class="math inline">\(A\hat{\lambda}_s\)</span> ou, de façon équivalente <span class="citation">(<a href="references.html#ref-Pielou1969" role="doc-biblioref">Pielou 1969, 204‑5</a>)</span>, <span class="math inline">\(np_s\)</span> (dans ce deuxième cas, <span class="math inline">\(n\)</span> est l’estimateur de <span class="math inline">\(N\)</span>, la variable aléatoire correspondant à la taille de l’échantillon).</p>
<p>La SAC théorique en fonction du nombre d’individus ne contient pas cet aléa.
Le nombre d’individus de l’espèce <span class="math inline">\(s\)</span> suit alors une loi binomiale d’espérance <span class="math inline">\(np_s\)</span> et la distribution d’un échantillon de taille <span class="math inline">\(n\)</span> suit la loi multinomiale correspondante.
Les deux approches se réconcilient en fixant arbitrairement le nombre d’individus échantillonnés dans la courbe aire-espèce : conditionnellement au nombre total d’individus, la distribution des abondances des espèces issues de lois de Poisson de paramètres <span class="math inline">\(\lambda_s\)</span> suit une loi multinomiale <span class="citation">(<a href="references.html#ref-Steel1953" role="doc-biblioref">Steel 1953</a>)</span> dont les probabilités sont proportionnelles à <span class="math inline">\(\lambda_s\)</span>.</p>
<p>La SAC définie en fonction du nombre d’individus est au sens strict une succession de points (à chaque valeur de <span class="math inline">\(n\)</span>), pas une courbe continue.
Elle est toutefois toujours présentée comme une courbe lissée passant par les points pour être continue et dérivable.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SACzetaFig"></span>
<img src="MesuresBD_files/figure-html/SACzetaFig-1.png" alt="Courbe d’accumulation des espèces d’arbres de Barro Colorado Island. Somme des entropies de Simpson généralisées." width="80%"><p class="caption">
Figure 21.3: Courbe d’accumulation des espèces d’arbres de Barro Colorado Island. Somme des entropies de Simpson généralisées.
</p>
</div>
<p></p>
<p>Une difficulté supplémentaire consiste à prendre en compte les espèces non échantillonnées en appliquant des techniques statistiques pour réduire le biais qu’elles induisent <span class="citation">(<a href="references.html#ref-Colwell2012" role="doc-biblioref">Colwell et al. 2012</a>)</span>.
Dans ce but, la SAC théorique peut être construite <span class="citation">(<a href="references.html#ref-Chao2013" role="doc-biblioref">Chao, Wang, et Jost 2013</a>)</span> comme la somme des entropies de Simpson généralisées <span class="citation">(<a href="references.html#ref-Zhang2010" role="doc-biblioref">Z. Zhang et Zhou 2010</a>)</span>, présentées en section <a href="entropie.html#sec-SimpsonG">4.7.3</a>.</p>
<p>La courbe obtenue (figure <a href="chap-Accumulation.html#fig:SACzetaFig">21.3</a>) est la même que par raréfaction, sans les problèmes d’estimation.
Son intervalle de confiance n’est pas représenté : l’estimation est sans biais et a une variance très <span style="white-space:nowrap">petite ;</span> d’autre part, la variabilité de l’échantillonnage prise en compte dans la figure <a href="chap-Accumulation.html#fig:specaccumFig">21.2</a> est ignorée ici. La fonction <code>GenSimp.z</code> est fournie par le package <em>EntropyEstimation</em> <span class="citation">(<a href="references.html#ref-Cao2014" role="doc-biblioref">Cao et Grabchak 2014</a>)</span>.</p>
<p>Code pour la figure :</p>
<p></p>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"EntropyEstimation"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span>
<span><span class="va">Ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span>
<span><span class="va">gsValues</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/EntropyEstimation/man/GenSimp.z.html">GenSimp.z</a></span><span class="op">(</span><span class="va">Ns</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SAC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">gsValues</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">SAC</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Nombre d'individus"</span>, y <span class="op">=</span> <span class="st">"Nombre d'espèces"</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
<div id="sec-Extrapolation" class="section level2" number="21.2">
<h2>
<span class="header-section-number">21.2</span> Extrapolation<a class="anchor" aria-label="anchor" href="#sec-Extrapolation"><i class="fas fa-link"></i></a>
</h2>
<p>L’extrapolation de la SAC est un cas particulier de celle de la diversité, déjà vue en section <a href="entropie.html#sec-RarExtrapol">4.6.8</a>.</p>
<p><span class="citation">Béguinot (<a href="references.html#ref-Beguinot2015" role="doc-biblioref">2015b</a>)</span> a une approche différente.
Il considère la SAC comme une fonction continue et infiniment dérivable de la taille de l’échantillon.
Le nombre d’espèces non observées dans un échantillon de taille <span class="math inline">\(n\)</span> est noté <span class="math inline">\(s^{n}_{0}\)</span>.
Le nombre d’espèces observées dans la SAC est <span class="math inline">\(s^{n}_{&gt;0} = S - s^{n}_{0}\)</span>.
Quand <span class="math inline">\(n\)</span> est assez grand, la pente de la SAC varie peu entre <span class="math inline">\(n-1\)</span> et <span class="math inline">\(n+1\)</span> individus.
<span class="citation">Béguinot (<a href="references.html#ref-Beguinot2014" role="doc-biblioref">2014</a>)</span> approxime la dérivée de <span class="math inline">\(s^{n}_{0}\)</span> par <span class="math inline">\(s^{n}_{0}-s^{n-1}_{0}\)</span>.
La dérivée est en réalité plus grande : la pente de la SAC, qui est l’opposée de la pente de <span class="math inline">\(s^{n}_{0}\)</span>, décroît avec <span class="math inline">\(n\)</span> mais l’approximation est acceptable quand <span class="math inline">\(n\)</span> est assez grand.
De même, les dérivées successives, par exemple seconde, sont approchées par la variation de la dérivée d’ordre inférieur, par exemple première, entre <span class="math inline">\(n-1\)</span> et <span class="math inline">\(n\)</span>.
En combinant ces approximations avec l’espérance du nombre d’espèces observées <span class="math inline">\(\nu\)</span> fois dans un échantillon de taille <span class="math inline">\(n\)</span>, équation <a href="chap-MesuresNeutres.html#eq:Esnnu">(3.2)</a>, on obtient :
<span class="math display" id="eq:Beguinot2014">\[\begin{equation}
  \tag{21.1}
  {\mathbb E}\left( s^{n}_{\nu} \right)
  = \left(-1 \right)^{\nu-1} \binom{n}{\nu} \frac{\partial^\nu s^{n}_{&gt;0}}{\partial n^\nu}, \nu=1,2,\dots
\end{equation}\]</span></p>
<p>L’espérance du nombre d’espèces observées <span class="math inline">\(\nu\)</span> fois dépend directement de la dérivée <span class="math inline">\(\nu\)</span> de la SAC.</p>
<p><span class="citation">Béguinot (<a href="references.html#ref-Beguinot2015" role="doc-biblioref">2015b</a>)</span> écrit l’accroissement du nombre d’espèces observées quand l’échantillon augmente de <span class="math inline">\(n\)</span> à <span class="math inline">\(n +\delta n\)</span> sous la forme d’une série entière, qu’il combine avec l’équation précédente pour en obtenir une approximation :
<span class="math display">\[\begin{equation}
  s^{n +\delta n}
  \approx s^{n} + \sum_\nu {\left(-1 \right)^{\nu-1} s^{n}_{\nu} \left(\frac{\delta n}{n}\right)^{\nu}}.
\end{equation}\]</span></p>
<p>La somme est infinie mais ses termes décroissent rapidement.
Le nombre de termes à prendre en compte est d’autant plus grand que <span class="math inline">\(\frac{\delta n}{n}\)</span>, le niveau d’extrapolation, est grand.
L’auteur conseille de ne pas pousser l’extrapolation au delà du double de <span class="math inline">\(n\)</span>.</p>
<p>Cette méthode est comparée à l’extrapolation de la diversité d’ordre 0 (section <a href="entropie.html#sec-RarExtrapol">4.6.8</a>) et à l’estimateur de <span class="citation">T.-J. Shen, Chao, et Lin (<a href="references.html#ref-Shen2003" role="doc-biblioref">2003</a>)</span> (section <a href="chap-MesuresNeutres.html#sec-Extrapol">3.1.1.8</a>) dans l’illustration suivante.</p>
<p>Une communauté théorique log-normale de 300 espèces est créée.
Des inventaires de 1000 individus sont simulés et les trois méthodes d’extrapolation de la richesse spécifique sont appliquées pour estimer la richesse d’un échantillon de 1800 individus.
Les résultats obtenus sont comparés à des inventaires directs de 1800 individus.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Beguinot2015Fig"></span>
<img src="MesuresBD_files/figure-html/Beguinot2015Fig-1.png" alt="Distribution de la richesse obtenue par extrapolation à 1800 individus de 500 inventaires de 1000 individus selon les méthodes de Shen et al. (pointillés alternés vert), Béguinot (tirets rouges) ou Chao, Gotelli et al. (pointillés bleu). La distribution de la richesse de 500 inventaires de même taille est représentée par la courbe noire." width="80%"><p class="caption">
Figure 21.4: Distribution de la richesse obtenue par extrapolation à 1800 individus de 500 inventaires de 1000 individus selon les méthodes de Shen et al. (pointillés alternés vert), Béguinot (tirets rouges) ou Chao, Gotelli et al. (pointillés bleu). La distribution de la richesse de 500 inventaires de même taille est représentée par la courbe noire.
</p>
</div>
<p></p>
<p>La figure <a href="chap-Accumulation.html#fig:Beguinot2015Fig">21.4</a> montre que les extrapolations sont bonnes et très similaires avec les trois méthodes.
La distribution des 500 simulations d’extrapolation est proche de celle des 500 inventaires, avec une plus grande variabilité due à la quantité plus faible de données disponibles.</p>
<p>Le code R nécessaire pour réaliser la figure est :</p>
<p></p>
<div class="sourceCode" id="cb346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ecart-type de la communauté log-normale</span></span>
<span><span class="va">sdlog</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="co"># Nombre d'espèces</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="co"># Tirage des probabilités log-normales (l'espérance est sans importance)</span></span>
<span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/entropart/man/SpeciesDistribution.html">as.ProbaVector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span><span class="op">(</span><span class="va">S</span>, <span class="fl">0</span>, <span class="va">sdlog</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Taille de l'inventaire</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="co"># Niveau d'extrapolation</span></span>
<span><span class="va">extra</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="co"># Nombre de simulations</span></span>
<span><span class="va">nSim</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="co"># Création de nSim inventaires de n individus</span></span>
<span><span class="va">Samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html">rmultinom</a></span><span class="op">(</span><span class="va">nSim</span>, <span class="va">n</span>, <span class="va">Ps</span><span class="op">)</span></span>
<span><span class="co"># Richesse observée</span></span>
<span><span class="va">S0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">Samples</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># Fonction d'extrapolation selon Béguinot</span></span>
<span><span class="va">ExtrapolateB</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Création d'un tableau contenant le nombre d'espèces par abondance</span></span>
<span>  <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/entropart/man/AbdFreqCount.html">AbdFreqCount</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span></span>
<span>  <span class="co"># Calcul des termes de la somme</span></span>
<span>  <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> </span>
<span>              <span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">f</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">f</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">extra</span><span class="op">^</span><span class="va">f</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Extrapolation des inventaires</span></span>
<span><span class="va">eB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Samples</span>, <span class="fl">2</span>, <span class="va">ExtrapolateB</span><span class="op">)</span> <span class="op">+</span> <span class="va">S0</span></span>
<span><span class="co"># Extrapolation selon Chao, Gotelli et al. (2014)</span></span>
<span><span class="va">ei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Samples</span>, <span class="fl">2</span>, <span class="va">Richness</span>, Level <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">extra</span><span class="op">)</span>, </span>
<span>            RCorrection <span class="op">=</span> <span class="st">"Chao1"</span><span class="op">)</span></span>
<span><span class="co"># Fonction d'extrapolation selon Shen et al.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"SPECIES"</span><span class="op">)</span></span>
<span><span class="va">ExtrapolateS</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Nombre d'espèces non observées</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sink.html">sink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Suppression des messages de jackknife()</span></span>
<span>  <span class="va">S0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SPECIES/man/jackknife.html">jackknife</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/entropart/man/AbdFreqCount.html">AbdFreqCount</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Nhat</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Ns</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sink.html">sink</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># restauration de l'affichage normal</span></span>
<span>  <span class="co"># Taux de couverture</span></span>
<span>  <span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/entropart/man/Coverage.html">Coverage</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span></span>
<span>  <span class="co"># Espèces nouvelles</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">S0</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span><span class="va">C</span><span class="op">)</span><span class="op">/</span><span class="va">S0</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">extra</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Extrapolation des inventaires</span></span>
<span><span class="va">eS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Samples</span>, <span class="fl">2</span>, <span class="va">ExtrapolateS</span><span class="op">)</span> <span class="op">+</span> <span class="va">S0</span></span>
<span><span class="co"># Tirage de nSim communautés de taille n(1+extra)</span></span>
<span><span class="va">Communities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html">rmultinom</a></span><span class="op">(</span><span class="va">nSim</span>, <span class="va">n</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">extra</span><span class="op">)</span>, <span class="va">Ps</span><span class="op">)</span></span>
<span><span class="va">richCommunities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">Communities</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># Distribution des résultats</span></span>
<span><span class="va">deCommunities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">richCommunities</span><span class="op">)</span></span>
<span><span class="va">deB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">eB</span><span class="op">)</span></span>
<span><span class="va">dei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">ei</span><span class="op">)</span></span>
<span><span class="va">deS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">eS</span><span class="op">)</span></span>
<span><span class="co"># Figure</span></span>
<span><span class="va">Xlab</span> <span class="op">&lt;-</span> <span class="st">"Nombre d'espèces"</span></span>
<span><span class="va">Ylab</span> <span class="op">&lt;-</span> <span class="st">"Densité de probabilité"</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">richCommunities</span>, <span class="va">eB</span>, <span class="va">ei</span>, <span class="va">eS</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">richCommunities</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">eB</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">ei</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">eS</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Xlab</span>, y <span class="op">=</span> <span class="va">Ylab</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p><span class="citation">Béguinot (<a href="references.html#ref-Beguinot2015a" role="doc-biblioref">2015a</a>)</span> propose également une forme analytique de la SAC extrapolée en combinant l’équation <a href="chap-Accumulation.html#eq:Beguinot2014">(21.1)</a> à l’estimateur jackknife d’ordre 2.
Alors, dans le domaine de validité de l’estimateur jackknife 2, c’est-à-dire quand le nombre de singletons est supérieur à 0,6 fois le nombre de doubletons, la richesse pour <span class="math inline">\(n\)</span> individus est
<span class="math display" id="eq:Beguinot2015a">\[\begin{equation}
  \tag{21.2}
  s^{n}
  = s^{n_0}
  +2s^{n_0}_{1}-s^{n_0}_{2}
  -\left(3s^{n_0}_{1}-2s^{n_0}_{2}\right)*\frac{n_0}{n}
  -\left(s^{n_0}_{2}-s^{n_0}_{1}\right)*\left(\frac{n_0}{n}\right)^2,
\end{equation}\]</span>
où <span class="math inline">\(n_0\)</span> est la taille de l’inventaire de départ.</p>
<p>La méthode est testée ici sur la même communauté log-normale.
500 inventaires de 5000 individus sont réalisés et chacun est extrapolé jusqu’à 25000 individus.</p>
<p></p>
<div class="sourceCode" id="cb347"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extrapolation jusqu'à</span></span>
<span><span class="va">Nmax</span> <span class="op">&lt;-</span> <span class="fl">25000</span></span>
<span><span class="co"># SAC réelle, obtenue par la somme des entropies de Simpson</span></span>
<span><span class="co"># généralisées Calcul de p(1-p)^r pour toutes les espèces</span></span>
<span><span class="co"># (en lignes) et tous les r (en colonnes)</span></span>
<span><span class="va">GSsr</span> <span class="op">&lt;-</span> <span class="va">Ps</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">Nmax</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Ps</span><span class="op">)</span><span class="op">^</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="co"># Simpson généralisé pour tous les r</span></span>
<span><span class="va">GSr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">GSsr</span><span class="op">)</span></span>
<span><span class="co"># SAC: somme cumulée des entropies de Simpson généralisées</span></span>
<span><span class="va">SAC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">GSr</span><span class="op">)</span></span>
<span><span class="co"># Fonction d'extrapolation de la SAC</span></span>
<span><span class="va">ExtraSAC</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Ns</span>, <span class="va">N</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Ns est le vecteur des abondances de l'échantillon, N</span></span>
<span>    <span class="co"># est le vecteur des tailles à extrapoler</span></span>
<span>    <span class="va">n0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Ns</span><span class="op">)</span></span>
<span>    <span class="va">Sn0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Ns</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Ns</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Ns</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="co"># Extrapolation à chaque taille</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span><span class="op">(</span><span class="va">N</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="va">Sn0</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">f1</span> <span class="op">-</span> <span class="va">f2</span> <span class="op">-</span> <span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">f1</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">f2</span><span class="op">)</span> <span class="op">*</span></span>
<span>        <span class="va">n0</span><span class="op">/</span><span class="va">n</span> <span class="op">-</span> <span class="op">(</span><span class="va">f2</span> <span class="op">-</span> <span class="va">f1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">n0</span><span class="op">/</span><span class="va">n</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Taille de l'échantillon</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span><span class="co"># Tirage de nSim inventaires dans la communauté log-normale</span></span>
<span><span class="va">Samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html">rmultinom</a></span><span class="op">(</span><span class="va">nSim</span>, <span class="va">n</span>, <span class="va">Ps</span><span class="op">)</span></span>
<span><span class="co"># Extrapolation des inventaires</span></span>
<span><span class="va">ExtraSACs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Samples</span>, <span class="fl">2</span>, <span class="va">ExtraSAC</span>, <span class="va">n</span><span class="op">:</span><span class="va">Nmax</span><span class="op">)</span></span>
<span><span class="co"># Moyenne et intervalle de confiance à 95%</span></span>
<span><span class="va">Moyenne</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">ExtraSACs</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">Max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">ExtraSACs</span>, <span class="fl">1</span>, <span class="va">quantile</span>, probs <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span></span>
<span><span class="va">Min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">ExtraSACs</span>, <span class="fl">1</span>, <span class="va">quantile</span>, probs <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span></span>
<span><span class="co"># Taille d'échantillon réduite</span></span>
<span><span class="va">nReduit</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="co"># Tirage de nSim inventaires dans la communauté log-normale</span></span>
<span><span class="va">Samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html">rmultinom</a></span><span class="op">(</span><span class="va">nSim</span>, <span class="va">nReduit</span>, <span class="va">Ps</span><span class="op">)</span></span>
<span><span class="co"># Extrapolation des inventaires</span></span>
<span><span class="va">ExtraSACs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Samples</span>, <span class="fl">2</span>, <span class="va">ExtraSAC</span>, <span class="va">nReduit</span><span class="op">:</span><span class="va">Nmax</span><span class="op">)</span></span>
<span><span class="co"># Moyenne</span></span>
<span><span class="va">MoyenneReduit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">ExtraSACs</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>À titre de comparaison, l’extrapolation d’un seul inventaire de 1000 individus est également tentée.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Beguinot2015aFig"></span>
<img src="MesuresBD_files/figure-html/Beguinot2015aFig-1.png" alt="Extrapolation de 500 inventaires de 5000 individus (valeurs moyenne en tireté rouge et enveloppe de confiance à 95 % en gris) superposée à la SAC réelle d’une communauté log-normale de 300 espèces. L’extrapolation (en pointillés bleu) d’un inventaire limité à 1000 individus est sévèrement sous-estimée." width="80%"><p class="caption">
Figure 21.5: Extrapolation de 500 inventaires de 5000 individus (valeurs moyenne en tireté rouge et enveloppe de confiance à 95 % en gris) superposée à la SAC réelle d’une communauté log-normale de 300 espèces. L’extrapolation (en pointillés bleu) d’un inventaire limité à 1000 individus est sévèrement sous-estimée.
</p>
</div>
<p></p>
<p>L’extrapolation fonctionne assez bien (figure <a href="chap-Accumulation.html#fig:Beguinot2015aFig">21.5</a>) tant que l’échantillonnage n’est pas trop faible.
Avec un inventaire de 5000 individus dans cet exemple, l’estimation de la richesse asymptotique par l’estimateur jackknife 2 est correcte, l’extrapolation de la SAC l’est aussi.
En limitant l’inventaire à 1000 individus, l’information disponible est trop limitée.</p>
<p>Le code R nécessaire pour réaliser la figure est :</p>
<p></p>
<div class="sourceCode" id="cb348"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, ymin <span class="op">=</span> <span class="va">Min</span>, ymax <span class="op">=</span> <span class="va">Max</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span><span class="op">:</span><span class="va">Nmax</span>, <span class="va">Min</span>, <span class="va">Max</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">Nmax</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">SAC</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span><span class="op">:</span><span class="va">Nmax</span>, y <span class="op">=</span> <span class="va">Moyenne</span><span class="op">)</span>, </span>
<span>            col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nReduit</span><span class="op">:</span><span class="va">Nmax</span>, y <span class="op">=</span> <span class="va">MoyenneReduit</span><span class="op">)</span>, </span>
<span>            col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Nombre d'individus"</span>, y <span class="op">=</span> <span class="st">"Nombre d'espèces"</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
<div id="influence-de-la-structure-spatiale" class="section level2" number="21.3">
<h2>
<span class="header-section-number">21.3</span> Influence de la structure spatiale<a class="anchor" aria-label="anchor" href="#influence-de-la-structure-spatiale"><i class="fas fa-link"></i></a>
</h2>
<p>Les modèles classiques de courbes aire-espèces supposent un tirage indépendant des individus.
Sur le terrain, par exemple en forêt, l’échantillonnage est continu : s’il existe une structure spatiale comme des agrégats, la probabilité que l’arbre suivant soit d’une espèce donnée dépend de ses voisins, donc de l’arbre précédent.
Intuitivement, on comprend bien que le nouvel arbre de la même espèce apporte moins d’information, ce qui revient à surestimer la taille de l’échantillon ou sous-estimer la richesse pour une taille d’échantillon fixée <span class="citation">(<a href="references.html#ref-Veech2005" role="doc-biblioref">Veech 2005</a>)</span>.</p>
<p><span class="citation">Plotkin, Potts, Leslie, et al. (<a href="references.html#ref-Plotkin2000a" role="doc-biblioref">2000</a>)</span> traitent un problème un peu différent : connaissant le nombre total d’espèces dans les dispositifs de la figure <a href="diversit%C3%A9-r%C3%A9gionale.html#fig:CTFS">22.2</a>, ils tracent la courbe de raréfaction théorique qui considère simplement que la probabilité de ne pas rencontrer une espèce suit une loi binomiale, les tirages étant indépendants.
Ce modèle surestime largement la diversité pour les petites surfaces : la probabilité de ne pas rencontrer une espèce agrégative est sous-estimée.
Le biais diminue quand la surface d’échantillonnage augmente, parce que la taille relative des agrégats diminue.</p>
<p>Les effets de l’agrégation peuvent donc être opposés selon la question posée.
Dans tous les cas, il suffit de considérer qu’un agrégat surestime le nombre d’arbres de son espèce qui devrait être pris en compte dans le cadre d’un modèle à tirages indépendants.</p>
<p>Plotkin et al. proposent une méthode permettant de prendre en compte la structure spatiale pour fournir des modèles de courbes aire-espèces fiables, dans un cadre particulier où le nombre total d’espèces et leur structure spatiale sont connus.
La méthode nécessite une carte des individus.
Le semis de point est considéré comme le résultat d’un processus de Neyman-Scott <span class="citation">(<a href="references.html#ref-Neyman1958" role="doc-biblioref">Neyman et Scott 1958</a>)</span> : des centres d’agrégats sont tirés de façon complètement aléatoire et les individus sont répartis autour des centres selon une loi normale en deux dimensions.
Les paramètres du processus sont estimés à partir du semis de points, puis la courbe aire-espèces est obtenue par simulation du processus.</p>
<p>Le problème est traité de façon plus approfondie par <span class="citation">Picard, Karembe, et Birnbaum (<a href="references.html#ref-Picard2004" role="doc-biblioref">2004</a>)</span> qui s’appuient sur la théorie des processus ponctuels.
En supposant que la distribution spatiale des espèces est homogène (c’est-à-dire stationnaire et isotrope), la forme du domaine échantillonné n’a pas d’importance : l’aire <span class="math inline">\(A\)</span> peut être représentée par un cercle de rayon <span class="math inline">\(r=\sqrt{{A}/{\pi}}\)</span>.
La probabilité d’observer l’espèce <span class="math inline">\(s\)</span> dans <span class="math inline">\(A\)</span> est identique à la probabilité que la distance entre un individu de l’espèce <span class="math inline">\(s\)</span> et un point arbitrairement choisi soit inférieure à <span class="math inline">\(r\)</span>.
Cette probabilité a été largement étudiée et est connue sous le nom de fonction <span class="math inline">\(F\)</span> de <span class="citation">Diggle (<a href="references.html#ref-Diggle1983" role="doc-biblioref">1983</a>)</span>, ou <em>empty space function</em>.
<span class="math inline">\(F_s(r)\)</span> est la fonction d’espace vide de l’espèce <span class="math inline">\(s\)</span>, dont l’argument est la distance <span class="math inline">\(r\)</span>.
Le nombre d’espèces peut être écrit comme la somme des fonctions <span class="math inline">\(F_s\)</span>:</p>
<p><span class="math display" id="eq:SARF">\[\begin{equation}
  \tag{21.3}
  {\mathbb E}\left( S^A \right)  = \sum_s{F_s\left( r \right) }.
\end{equation}\]</span></p>
<p>La fonction <span class="math inline">\(F_s(r)\)</span> est connue pour les processus ponctuels courants <span class="citation">(<a href="references.html#ref-Cressie1993" role="doc-biblioref">N. A. Cressie 1993</a>; <a href="references.html#ref-Stoyan1994" role="doc-biblioref">Stoyan et Stoyan 1994</a>)</span>.
Le processus de Poisson place les individus indépendamment les uns des autres avec la même probabilité partout.
Son seul paramètre est l’intensité <span class="math inline">\(\lambda_s\)</span>, qui donne l’espérance du nombre d’individus de l’espèce <span class="math inline">\(s\)</span> par unité de surface.
Si toutes les espèces sont distribuées selon un processus de Poisson, la courbe aire-espèce est décrite par</p>
<p><span class="math display" id="eq:SARPoisson">\[\begin{equation}
  \tag{21.4}
  {\mathbb E}\left( S^A \right)  = S - \sum_s{e^{-\lambda_s A}}.
\end{equation}\]</span></p>
<p>L’équation <a href="chap-Accumulation.html#eq:SARPoisson">(21.4)</a> est identique au modèle de distribution aléatoire de Coleman en remplaçant la distribution observée des effectifs par espèce par l’intensité du processus de Poisson.
Les formes de <span class="math inline">\(F_s\)</span> sont connues aussi pour des processus agrégatifs, notamment le processus de <span class="citation">Matérn (<a href="references.html#ref-Matern1960" role="doc-biblioref">1960</a>)</span> ou des distributions régulières.
La courbe aire-espèce peut donc être évaluée à partir d’inventaires fournissant la position des individus.
Le processus ponctuel correspondant à chaque espèce peut être inféré pour fournir une forme analytique de la courbe comme dans l’équation <a href="chap-Accumulation.html#eq:SARPoisson">(21.4)</a> ou bien la fonction d’espace vide de chaque espèce peut être estimée à partir des données par la fonction <code>Fest</code> du package <em>spatstat</em> et sommée pour toutes les espèces selon l’équation <a href="chap-Accumulation.html#eq:SARF">(21.3)</a>.</p>
<p>La relation aire-espèce contient au moins autant de paramètres que d’espèces : l’intensité <span class="math inline">\(\lambda_s\)</span> si l’espèce <span class="math inline">\(s\)</span> est distribuée spatialement selon un processus de Poisson, deux paramètres supplémentaires pour le processus de Matérn.
Cette complexité peut être réduite si la distribution des fréquences des espèces (la SAD) est connue.
Picard et al. fournissent les relations pour une SAD en log-séries et une SAD géométrique, avec une distribution spatiale suivant un processus de Poisson : elles ne contiennent que deux paramètres, un lié au nombre total d’individus, et un propre à chaque SAD.
Les formules se compliquent quand la distribution spatiale n’est pas poissonnienne et ne sont pas disponibles quand la SAD (log-normale par exemple) ne prévoit pas le nombre exact d’individus par espèce.</p>
<p>Enfin, il est possible de prendre en compte les espèces non observées.
La relation aire-espèce <a href="chap-Accumulation.html#eq:SARF">(21.3)</a> s’entend pour toutes les espèces.
Elle peut être réécrite sous la forme
<span class="math display" id="eq:SARF2">\[\begin{equation}
  \tag{21.5}
  {\mathbb E}\left( S^A \right)
  = \sum_{s=1}^{S_{\ne 0}}{F_s\left( r \right)}
    + \sum_{s=S_{\ne 0}+1}^{S}{F_s\left( r \right)}.
\end{equation}\]</span></p>
<p>Le premier terme de la somme correspond aux espèces observées, le deuxième aux espèces non observées.
La distribution des espèces non observées peut maintenant être estimée dans certains cas <span class="citation">(<a href="references.html#ref-Chao2014c" role="doc-biblioref">Chao, Hsieh, et al. 2015</a>)</span> et leur distribution spatiale être supposée poissonnienne puisque ce sont des espèces rares <span class="citation">(<a href="references.html#ref-Picard2004" role="doc-biblioref">Picard, Karembe, et Birnbaum 2004</a>)</span>, ce qui ouvre la voie à une meilleure estimation de la courbe.</p>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="chap-Fisher.html"><span class="header-section-number">20</span> Indice \(\alpha\) de Fisher</a></div>
<div class="next"><a href="diversit%C3%A9-r%C3%A9gionale.html"><span class="header-section-number">22</span> Diversité régionale</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-Accumulation"><span class="header-section-number">21</span> Accumulation de la diversité locale</a></li>
<li><a class="nav-link" href="#sec-SAC"><span class="header-section-number">21.1</span> Courbes d’accumulation</a></li>
<li><a class="nav-link" href="#sec-Extrapolation"><span class="header-section-number">21.2</span> Extrapolation</a></li>
<li><a class="nav-link" href="#influence-de-la-structure-spatiale"><span class="header-section-number">21.3</span> Influence de la structure spatiale</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/EricMarcon/MesuresBioDiv2/blob/master/06-Spatial.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/EricMarcon/MesuresBioDiv2/edit/master/06-Spatial.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Mesures de la Biodiversité</strong>" was written by Eric Marcon. It was last built on 22/12/2023.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
