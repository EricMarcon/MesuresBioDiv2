<!DOCTYPE html>
<html lang="fr-FR">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>7 Mesures particulières | Mesures de la Biodiversité</title>
<meta name="author" content="Eric Marcon">
<meta name="description" content="De nombreuses mesures de diversité fonctionnelle ou phylogénétique ont été développées pour combiner le mieux possible la richesse et la régularité de la distribution des espèces dans l’espace des...">
<meta name="generator" content="bookdown 0.42 with bs4_book()">
<meta property="og:title" content="7 Mesures particulières | Mesures de la Biodiversité">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/EricMarcon/MesuresBioDiv2/mesures-particulières.html">
<meta property="og:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<meta property="og:description" content="De nombreuses mesures de diversité fonctionnelle ou phylogénétique ont été développées pour combiner le mieux possible la richesse et la régularité de la distribution des espèces dans l’espace des...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="7 Mesures particulières | Mesures de la Biodiversité">
<meta name="twitter:description" content="De nombreuses mesures de diversité fonctionnelle ou phylogénétique ont été développées pour combiner le mieux possible la richesse et la régularité de la distribution des espèces dans l’espace des...">
<meta name="twitter:image" content="https://github.com/EricMarcon/MesuresBioDiv2/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-C1B3PLBCM6"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-C1B3PLBCM6');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Mesures de la Biodiversité</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Motivation</a></li>
<li><a class="" href="calculs-et-donn%C3%A9es.html">Calculs et données</a></li>
<li><a class="" href="notations.html">Notations</a></li>
<li class="book-part">Notions</li>
<li><a class="" href="chap-Notions.html"><span class="header-section-number">1</span> Notions de Diversité</a></li>
<li><a class="" href="chap-Outils.html"><span class="header-section-number">2</span> Outils</a></li>
<li class="book-part">Diversité neutre d’une communauté</li>
<li><a class="" href="chap-MesuresNeutres.html"><span class="header-section-number">3</span> Mesures neutres de la diversité \(\alpha\) ou \(\gamma\)</a></li>
<li><a class="" href="entropie.html"><span class="header-section-number">4</span> Entropie</a></li>
<li><a class="" href="sec-Equitabilite.html"><span class="header-section-number">5</span> Équitabilité</a></li>
<li class="book-part">Diversité fonctionnelle et phylogénétique</li>
<li><a class="" href="chap-cadrephyfonc.html"><span class="header-section-number">6</span> Cadre</a></li>
<li><a class="active" href="mesures-particuli%C3%A8res.html"><span class="header-section-number">7</span> Mesures particulières</a></li>
<li><a class="" href="chap-Phyloentropie.html"><span class="header-section-number">8</span> Entropie phylogénétique</a></li>
<li><a class="" href="chap-LeinsterCobbold.html"><span class="header-section-number">9</span> Diversité de Leinster et Cobbold</a></li>
<li class="book-part">Diversité beta et décomposition</li>
<li><a class="" href="sec-betaCadre.html"><span class="header-section-number">10</span> Cadre</a></li>
<li><a class="" href="chap-BetaPaires.html"><span class="header-section-number">11</span> Diversité de différentiation</a></li>
<li><a class="" href="chap-DedompHCDT.html"><span class="header-section-number">12</span> Décomposition de l’entropie HCDT</a></li>
<li><a class="" href="d%C3%A9composition-de-la-diversit%C3%A9-phylog%C3%A9n%C3%A9tique-et-fonctionnelle.html"><span class="header-section-number">13</span> Décomposition de la diversité phylogénétique et fonctionnelle</a></li>
<li><a class="" href="tests-de-significativit%C3%A9.html"><span class="header-section-number">14</span> Tests de significativité</a></li>
<li><a class="" href="sec-betaAutres.html"><span class="header-section-number">15</span> Autres approches</a></li>
<li class="book-part">Diversité jointe, diversité structurelle</li>
<li><a class="" href="sec-jointeCadre.html"><span class="header-section-number">16</span> Cadre</a></li>
<li><a class="" href="information-mutuelle.html"><span class="header-section-number">17</span> Information mutuelle</a></li>
<li><a class="" href="chap-DiversiteJointe.html"><span class="header-section-number">18</span> Décomposition de la diversité jointe</a></li>
<li class="book-part">Diversité spatialement explicite</li>
<li><a class="" href="sec-spatialCadre.html"><span class="header-section-number">19</span> Cadre</a></li>
<li><a class="" href="chap-Fisher.html"><span class="header-section-number">20</span> Indice \(\alpha\) de Fisher</a></li>
<li><a class="" href="chap-Accumulation.html"><span class="header-section-number">21</span> Accumulation de la diversité locale</a></li>
<li><a class="" href="diversit%C3%A9-r%C3%A9gionale.html"><span class="header-section-number">22</span> Diversité régionale</a></li>
<li><a class="" href="chap-betasp.html"><span class="header-section-number">23</span> Diversité \(\beta\) spatialement explicite</a></li>
<li class="book-part">Conclusion</li>
<li><a class="" href="sec-conclusionSynthese.html"><span class="header-section-number">24</span> Synthèse</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/EricMarcon/MesuresBioDiv2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="mesures-particulières" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Mesures particulières<a class="anchor" aria-label="anchor" href="#mesures-particuli%C3%A8res"><i class="fas fa-link"></i></a>
</h1>
<div class="Summary">
<p>De nombreuses mesures de diversité fonctionnelle ou phylogénétique ont été développées pour combiner le mieux possible la richesse et la régularité de la distribution des espèces dans l’espace des niches ou la phylogénie.
Certaines (PD, FD, l’entropie quadratique de Rao, <span class="math inline">\(H_p\)</span> et <span class="math inline">\(I_1\)</span>) seront unifiées au chapitre suivant dans le cadre de l’entropie phylogénétique.</p>
</div>
<p>Un certain nombre de mesures de diversité phylogénétiques a émergé dans la littérature.
Elles sont passées en revue ici, en commençant par la diversité fonctionnelle envisagée dans l’espace multidimensionnel des traits.
Les sections suivantes envisagent les espèces dans un arbre phylogénétique.</p>
<div id="richesse-équitabilité-et-divergence-fonctionnelle" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Richesse, équitabilité et divergence fonctionnelle<a class="anchor" aria-label="anchor" href="#richesse-%C3%A9quitabilit%C3%A9-et-divergence-fonctionnelle"><i class="fas fa-link"></i></a>
</h2>
<p><span class="citation">Mason et al. (<a href="references.html#ref-Mason2005">2005</a>)</span> postulent que la diversité fonctionnelle peut être abordée dans trois dimensions indépendantes (<span class="citation">Jost (<a href="references.html#ref-Jost2010">2010b</a>)</span> montrera que l’indépendance n’est pas assurée) :</p>
<ul>
<li>la richesse fonctionnelle, qui indique l’étendue de l’espace des niches fonctionnelles occupé par la <span style="white-space:nowrap">communauté ;</span>
</li>
<li>l’équitabilité de la distribution des espèces dans ces niches (appelée régularité par <span class="citation">Pavoine et Bonsall (<a href="references.html#ref-Pavoine2011">2011</a>)</span><span style="white-space:nowrap">) ;</span>
</li>
<li>la divergence fonctionnelle, qui mesure comment la distribution des espèces dans l’espace des niches maximise la variabilité des caractéristiques fonctionnelles dans la communauté et combine richesse et équitabilité.</li>
</ul>
<p><span class="citation">Schleuter et al. (<a href="references.html#ref-Schleuter2010">2010</a>)</span> font une revue des mesures utilisées dans ce cadre.
Les notations des indices utilisées ici sont les leurs.</p>
<p>Différents traits numériques sont connus pour toutes les espèces de la communauté.
La matrice <span class="math inline">\(\mathbf{X}\)</span> les contient : l’élément <span class="math inline">\(x_{t,s}\)</span> est la valeur moyenne du trait <span class="math inline">\(t\)</span> pour l’espèce <span class="math inline">\(s\)</span>.
On note <span class="math inline">\(\mathbf{T}_s\)</span> le vecteur des valeurs moyennes de chaque trait de l’espèce <span class="math inline">\(s\)</span>.</p>
<div id="richesse-fonctionnelle" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> Richesse fonctionnelle<a class="anchor" aria-label="anchor" href="#richesse-fonctionnelle"><i class="fas fa-link"></i></a>
</h3>
<div id="étendue-fonctionnelle" class="section level4" number="7.1.1.1">
<h4>
<span class="header-section-number">7.1.1.1</span> Étendue fonctionnelle<a class="anchor" aria-label="anchor" href="#%C3%A9tendue-fonctionnelle"><i class="fas fa-link"></i></a>
</h4>
<p>L’étendue fonctionnelle <span class="citation">(<a href="references.html#ref-Mason2005">Mason et al. 2005</a>)</span> mesure l’étendue des valeurs d’un trait occupée par une communauté, normalisée par l’étendue maximale possible :
<span class="math display" id="eq:FRR">\[\begin{equation}
  \tag{7.1}
  \mathit{FR}_R = \dfrac{\max_s(x_{t,s}) - \min_s(x_{t,s})}{X_{t,max} - X_{t,min}},
\end{equation}\]</span></p>
<p>où <span class="math inline">\(\max_s(x_{t,s})\)</span> est la valeur maximale pour toutes les espèces de la matrice de la valeur du trait <span class="math inline">\(t\)</span>, <span class="math inline">\(X_{t,max}\)</span> est sa valeur maximale absolue (les notations sont identiques pour les minima).
Les extrêmes absolus peuvent être ceux de l’ensemble des communautés comparées.
Ils sont toujours sous-estimés : il est toujours possible théoriquement de trouver des valeurs plus extrêmes en augmentant l’effort d’échantillonnage.
L’étendue fonctionnelle peut être moyennée sur plusieurs traits.</p>
<p>Schleuter et al. développent l’indice <span class="math inline">\(\mathit{FR}_{Is}\)</span> pour prendre en compte la variabilité intraspécifique et les valeurs de traits non occupées par des espèces dans l’étendue fonctionnelle.
Les valeurs de traits individuelles sont nécessaires : l’étendue des valeurs d’un trait est définie comme l’union des étendues des valeurs de chaque espèce.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Schleuter2010"></span>
<img src="images/Schleuter2010.png" alt="Fonction d’appartenance de l’espace des niches de Schleuter et al., en une dimension. \(x\), en ordonnée, est la valeur du trait considéré. Chaque espèce est considérée comme un ensemble flou dans l’espace des traits. Quatre espèces sont représentées, avec leur fonction d’appartenance \(f_s(x)\). Le volume de l’espace des traits occupé, \(\mathit{FR}_{Im}\), est obtenu en intégrant les fonctions d’appartenance : c’est la zone grisée de la figure." width="80%"><p class="caption">
Figure 7.1: Fonction d’appartenance de l’espace des niches de Schleuter et al., en une dimension. <span class="math inline">\(x\)</span>, en ordonnée, est la valeur du trait considéré. Chaque espèce est considérée comme un ensemble flou dans l’espace des traits. Quatre espèces sont représentées, avec leur fonction d’appartenance <span class="math inline">\(f_s(x)\)</span>. Le volume de l’espace des traits occupé, <span class="math inline">\(\mathit{FR}_{Im}\)</span>, est obtenu en intégrant les fonctions d’appartenance : c’est la zone grisée de la figure.
</p>
</div>
<p></p>
</div>
<div id="volume-de-niches" class="section level4" number="7.1.1.2">
<h4>
<span class="header-section-number">7.1.1.2</span> Volume de niches<a class="anchor" aria-label="anchor" href="#volume-de-niches"><i class="fas fa-link"></i></a>
</h4>
<p>La définition de la niche écologique de <span class="citation">Hutchinson (<a href="references.html#ref-Hutchinson1957">1957</a>)</span> est l’hypervolume, dans l’espace des ressources environnementales, qu’une espèce peut occuper.
L’espace des traits fonctionnels peut être considéré comme une approximation de l’espace des ressources.
Le volume de l’enveloppe convexe de l’espace des traits occupé par la communauté (<em>convex hull volume</em>) est donc une mesure de richesse fonctionnelle multidimensionnelle.
La prise en compte des trous, c’est-à-dire la restriction du volume à l’espace réellement occupé à l’intérieur de cette enveloppe, est possible grâce à une méthode d’estimation d’hypervolume plus élaborée, implémentée dans le package <em>hypervolume</em> pour R <span class="citation">(<a href="references.html#ref-Blonder2014">Blonder et al. 2014</a>)</span>.</p>
<p>De même que pour l’étendue fonctionnelle, Schleuter et al. développent une mesure proche, <span class="math inline">\(\mathit{FR}_{Im}\)</span>, prenant en compte la variabilité intraspécifique et les espaces non occupés.
Chaque espèce est supposée occuper un espace autour de sa position moyenne dans l’espace des traits, avec une fonction d’appartenance <span class="citation">(<a href="references.html#ref-Zadeh1965">Zadeh 1965</a>)</span> gaussienne multidimensionnelle (une représentation unidimensionnelle se trouve en figure <a href="mesures-particuli%C3%A8res.html#fig:Schleuter2010">7.1</a>, <span class="citation">Schleuter et al. (<a href="references.html#ref-Schleuter2010">2010</a>)</span>) : la fonction d’appartenance, issue de la logique floue, peut être vue comme une densité de probabilité non normalisée.</p>
<p>Les variances et covariances intraspécifiques des traits (rassemblés dans la matrice carrée <span class="math inline">\(\mathbf{\Sigma}_s\)</span> de dimension <span class="math inline">\(t\)</span> pour chaque espèce <span class="math inline">\(s\)</span>) sont nécessaires.
La fonction d’appartenance de l’espèce <span class="math inline">\(s\)</span> dans l’espace des traits est, pour le vecteur <span class="math inline">\(\mathbf{T}\)</span> de valeur de l’ensemble des traits :
<span class="math display">\[\begin{equation}
  f_s(\mathbf{T})= e^{-\frac{1}{2} \left(\mathbf{T}-\mathbf{T}_s \right)^\top \mathbf{\Sigma}_s^{-1}  \left(\mathbf{T}-\mathbf{T}_s \right)}.
\end{equation}\]</span></p>
<p>La richesse fonctionnelle est l’intégrale des valeurs maximales de <span class="math inline">\(f_s\)</span> dans l’ensemble de l’espace des traits :
<span class="math display" id="eq:FRIm">\[\begin{equation}
  \tag{7.2}
  \mathit{FR}_{Im} = \int \max_s\left(f_s(\mathbf{T}) \right) \mathop{d\mathbf{T}}.
\end{equation}\]</span></p>
<p>Après transformation de la matrice de distance en dendrogramme fonctionnel, éventuellement sous la forme d’un arbre-consensus <span class="citation">(<a href="references.html#ref-Mouchet2008">Mouchet et al. 2008</a>)</span>, la longueur totale des branches, FD <span class="citation">(<a href="references.html#ref-Petchey2002">Petchey et Gaston 2002</a>)</span>, est une autre mesure de richesse multidimensionnelle.</p>
</div>
</div>
<div id="equitabilité-fonctionnelle" class="section level3" number="7.1.2">
<h3>
<span class="header-section-number">7.1.2</span> Equitabilité fonctionnelle<a class="anchor" aria-label="anchor" href="#equitabilit%C3%A9-fonctionnelle"><i class="fas fa-link"></i></a>
</h3>
<p>L’équitabilité fonctionnelle, ou régularité <span class="citation">(<a href="references.html#ref-Pavoine2011">Pavoine et Bonsall 2011</a>)</span>, rend compte de l’homogénéité de l’occupation des niches.</p>
<p>L’indice d’équitabilité de <span class="citation">Mouillot, Mason, et al. (<a href="references.html#ref-Mouillot2005a">2005</a>)</span>, que les auteurs nomment “indice de régularité fonctionnelle”, est inspiré de l’indice d’équitabilité de Bulla <a href="sec-Equitabilite.html#eq:Bulla">(5.1)</a>.
C’est un indice unidimensionnel : un seul trait est pris en compte.
Les espèces sont classées par valeur croissante du trait.
L’équitabilité maximale est obtenue si l’écart entre deux valeurs de traits est proportionnel aux abondances cumulées des deux espèces.
La statistique fondamentale est appelée équitabilité pondérée (<em>weighted evenness</em>).
Pour l’intervalle entre l’espèce <span class="math inline">\(s\)</span> et l’espèce <span class="math inline">\(s+1\)</span> :</p>
<p><span class="math display" id="eq:EWs">\[\begin{equation}
  \tag{7.3}
  \mathit{EW}_{s} = \frac{T_{s+1}-T_{s}}{N_{s+1}+N_{s}}.
\end{equation}\]</span></p>
<p>Cette valeur est normalisée : <span class="math inline">\(\mathit{PEW}_{s}={\mathit{EW}_{s}}/{\sum_s{\mathit{EW}_{s}}}\)</span>.
Sa valeur de <span class="math inline">\(\mathit{PEW}_{s}\)</span> attendue pour le maximum d’équitabilité est <span class="math inline">\({1}/{(S-1)}\)</span>.
L’indice est celui de Bulla, appliqué aux <span class="math inline">\(S-1\)</span> intervalles entre espèces :</p>
<p><span class="math display" id="eq:FEs">\[\begin{equation}
  \tag{7.4}
  \mathit{FE}_{s} = \sum_{s=1}^{S-1}{\min(\mathit{PEW}_{s},\frac{1}{S-1})}.
\end{equation}\]</span></p>
<p>L’indice <span class="math inline">\(\mathit{FE}_{s}\)</span> a été étendu pour être multidimensionnel par <span class="citation">Villéger, Mason, et Mouillot (<a href="references.html#ref-Villeger2008a">2008</a>)</span>.
L’arbre recouvrant de longueur minimum (<em>minimum spanning tree</em>) est d’abord calculé à partir des distances euclidiennes entre les espèces dans l’espace des traits : il s’agit de l’arbre de longueur totale minimale reliant tous les points.
La longueur des branches est ensuite traitée de la même façon que <span class="math inline">\(\delta T_s\)</span> précédemment.</p>
<p>Un autre indice, <span class="math inline">\({\Lambda}^+\)</span> <span class="citation">(<a href="references.html#ref-Clarke2001">Clarke et Warwick 2001</a>)</span>, mesure la variance des distances entre paires d’espèces :</p>
<p><span class="math display" id="eq:Clarke2001">\[\begin{equation}
  \tag{7.5}
  {\Lambda}^+ =\frac{\sum_s{\sum_t{{\left(d_{s,t}-\hat{d}\right)}^2}}}{S\left(S-1\right)}.
\end{equation}\]</span></p>
<p>Comme le montrent <span class="citation">Mérigot et Gaertner (<a href="references.html#ref-Merigot2011">2011</a>)</span>, les mesures de régularité n’ont absolument pas les mêmes propriétés que les mesures de diversité : elles peuvent par exemple augmenter quand on retire des espèces originales.</p>
</div>
<div id="divergence-fonctionnelle" class="section level3" number="7.1.3">
<h3>
<span class="header-section-number">7.1.3</span> Divergence fonctionnelle<a class="anchor" aria-label="anchor" href="#divergence-fonctionnelle"><i class="fas fa-link"></i></a>
</h3>
<p>Les mesures de divergence fonctionnelle décrivent la variabilité de position des espèces dans l’espace des traits.
Ce sont tout simplement des mesures de diversité au sens classique du terme.</p>
<p>Quand un seul trait est considéré, la mesure la plus simple est sa variance.
<span class="citation">Mason et al. (<a href="references.html#ref-Mason2003">2003</a>)</span> effectuent une transformation logarithmique de la valeur du trait et pondèrent le calcul de la variance par les probabilités <span class="math inline">\(p_s\)</span>.
Ils transforment finalement le résultat en son arc-tangente pour qu’il soit compris entre 0 et 1.</p>
<p>Schleuter et al. proposent d’utiliser la différence entre le troisième et le premier quartile de la valeur du trait, normalisée par son étendue maximale possible.</p>
<p>FAD a été proposé par <span class="citation">B. Walker, Kinzig, et Langridge (<a href="references.html#ref-Walker1999">1999</a>)</span>, à partir d’une matrice de distances dans l’espace des traits.
<span class="math inline">\(d_{s,t}\)</span> est la distance entre deux espèces indicées par <span class="math inline">\(s\)</span> et <span class="math inline">\(t\)</span>, alors :</p>
<p><span class="math display" id="eq:FAD">\[\begin{equation}
  \tag{7.6}
  \mathit{FAD}=\sum_s{\sum_t{d_{s,t}}}.
\end{equation}\]</span></p>
<p>FAD est très sensible au nombre d’espèces.
Sa version normalisée, MFAD <span class="citation">(<a href="references.html#ref-Schmera2009">Schmera, Erős, et Podani 2009</a>)</span> est</p>
<p><span class="math display" id="eq:MFAD">\[\begin{equation}
  \tag{7.7}
  \mathit{MFAD}=\frac{\sum_s{\sum_t{d_{s,t}}}}{S}.
\end{equation}\]</span></p>
<p>Les deux indices violent l’axiome de jumelage.
À un facteur de normalisation près, ce sont des cas particuliers de l’indice de Rao pour des effectifs égaux.</p>
<p>Le calcul sous R est immédiat avec un arbre au format <code>phylog</code> du package <em>ade4</em>.
Un arbre au format <code>phylo</code> du package <em>ape</em> nécessite une conversion : la fonction <code>Preprocess.Tree</code> du package <em>entropart</em> la réalise.</p>
<p></p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phyTree</span> <span class="op">&lt;-</span> <span class="va">Paracou618.Taxonomy</span></span>
<span><span class="co"># La conversion as.hclust() double les distances. Il faut</span></span>
<span><span class="co"># donc les diviser par deux.</span></span>
<span><span class="va">phyTree</span><span class="op">$</span><span class="va">edge.length</span> <span class="op">&lt;-</span> <span class="va">phyTree</span><span class="op">$</span><span class="va">edge.length</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/emmanuelparadis/ape">"ape"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Attaching package: 'ape'</code></pre>
<pre><code>## The following objects are masked from 'package:spatstat.geom':
## 
##     edges, rotate</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     where</code></pre>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Conversion au format hclust</span></span>
<span><span class="va">hTree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/as.phylo.html">as.hclust.phylo</a></span><span class="op">(</span><span class="va">phyTree</span><span class="op">)</span></span>
<span><span class="co"># Conversion au format phylog</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://pbil.univ-lyon1.fr/ADE-4/">"ade4"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Attaching package: 'ade4'</code></pre>
<pre><code>## The following object is masked from 'package:spatstat.geom':
## 
##     disc</code></pre>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/newick2phylog.html">hclust2phylog</a></span><span class="op">(</span><span class="va">hTree</span><span class="op">)</span></span>
<span><span class="co"># Tree$Wdist contient les valeurs de sqrt(2*distance)</span></span>
<span><span class="op">(</span><span class="va">FAD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">$</span><span class="va">Wdist</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 264159</code></pre>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">MFAD</span> <span class="op">&lt;-</span> <span class="va">FAD</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">$</span><span class="va">leaves</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 621.5506</code></pre>
<p></p>
<p><span class="citation">Kader et Perry (<a href="references.html#ref-Kader2007">2007</a>)</span> regroupent les valeurs de trait par catégories et calculent l’entropie de Simpson des catégories.</p>
<p>Enfin, <span class="citation">Villéger, Mason, et Mouillot (<a href="references.html#ref-Villeger2008a">2008</a>)</span> utilisent la distance euclidienne moyenne des espèces au centre de gravité de la communauté plutôt que la variance.
Précisément, le centre de gravité de la communauté (sans pondération par les fréquences) est calculé.
La distance euclidienne de l’espèce <span class="math inline">\(s\)</span> au centre de gravité est <span class="math inline">\(dG_s\)</span><span style="white-space:nowrap"> ;</span> la moyenne pour toutes les espèces <span class="math inline">\(\bar{dG}\)</span>.
L’écart moyen des individus de la communauté à la distance moyenne est <span class="math inline">\(\Delta d=\sum_s{p_s(dG_s - \bar{dG})}\)</span>.
L’écart moyen absolu est <span class="math inline">\(\Delta |d|=\sum_s{p_s|dG_s - \bar{dG}|}\)</span>.</p>
<p>L’indice est
<span class="math display" id="eq:FDm">\[\begin{equation}
  \tag{7.8}
  \mathit{FD}_{m} = \frac{\Delta d + \bar{dG}}{\Delta |d| +\bar{dG}}.
\end{equation}\]</span></p>
<p>Sa forme lui permet d’être compris entre 0 et 1.</p>
<p><span class="citation">Laliberté et Legendre (<a href="references.html#ref-Laliberte2010">2010</a>)</span> généralisent <span class="math inline">\(\mathit{FD}_{m}\)</span> en proposant l’usage de n’importe quelle dissimilarité entre espèces, obtenue à partir de la méthode de Gower (vue en section <a href="chap-cadrephyfonc.html#sec-DFonctionnelle">6.3</a>), autorisant des variables qualitatives et des données manquantes, au-delà de la seule distance euclidienne entre traits quantitatifs.
Ils fournissent le package <em>FD</em> pour calculer leur indice <span class="math inline">\(\mathit{FDis}\)</span> et ceux de
<span class="citation">Villéger, Mason, et Mouillot (<a href="references.html#ref-Villeger2008a">2008</a>)</span>.</p>
</div>
</div>
<div id="originalité-richesse-et-équitabilité-phylogénétique" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Originalité, richesse et équitabilité phylogénétique<a class="anchor" aria-label="anchor" href="#originalit%C3%A9-richesse-et-%C3%A9quitabilit%C3%A9-phylog%C3%A9n%C3%A9tique"><i class="fas fa-link"></i></a>
</h2>
<p>La littérature de la diversité phylogénétique s’est intéressée tôt à l’originalité taxonomique des espèces parce que les questions traitées concernaient la conservation, concernée par la valeur de l’héritage évolutif <span class="citation">(<a href="references.html#ref-Faith2008">Faith 2008</a>)</span>.</p>
<div id="mesures-spécifiques-doriginalité" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">7.2.1</span> Mesures spécifiques d’originalité<a class="anchor" aria-label="anchor" href="#mesures-sp%C3%A9cifiques-doriginalit%C3%A9"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Vane-Wright, Humphries, et Williams (<a href="references.html#ref-Vane-Wright1991">1991</a>)</span> définissent la distinction taxonomique (<em>taxonomic distinctness</em>) <span class="math inline">\(\mathit{TD}_s\)</span> de chaque espèce comme l’inverse du nombre de noeuds entre elle et la racine de l’arbre phylogénétique, normalisé pour que <span class="math inline">\(\sum_s{\mathit{TD}_s} = 1\)</span>.
Dans l’arbre de la figure <a href="mesures-particuli%C3%A8res.html#fig:ArbreA4">7.2</a>, les valeurs de TD non normalisées sont <span class="math inline">\({1}/{2}\)</span> pour les deux premières espèces et <span class="math inline">\({1}/{3}\)</span> pour les trois autres : la racine de l’arbre est comptabilisée dans le nombre de noeuds.
Les valeurs de <span class="math inline">\(\mathit{TD}_s\)</span> sont respectivement <span class="math inline">\({1}/{4}\)</span> et <span class="math inline">\({1}/{6}\)</span> après normalisation.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ArbreA4"></span>
<img src="images/ArbreA.png" alt="Arbre phylogénétique ou fonctionnel hypothétique. L’arbre comprend 5 espèces dont les probabilités sont notées \(p_s\), 3 périodes de durées \(T_k\) délimitées par les noeuds. Les branches sont notées \(b\) et indicées par la période à laquelle elles se terminent et un numéro d’ordre." width="80%"><p class="caption">
Figure 7.2: Arbre phylogénétique ou fonctionnel hypothétique. L’arbre comprend 5 espèces dont les probabilités sont notées <span class="math inline">\(p_s\)</span>, 3 périodes de durées <span class="math inline">\(T_k\)</span> délimitées par les noeuds. Les branches sont notées <span class="math inline">\(b\)</span> et indicées par la période à laquelle elles se terminent et un numéro d’ordre.
</p>
</div>
<p></p>
<p>La particularité évolutive <span class="citation">(<a href="references.html#ref-Isaac2007">Isaac et al. 2007</a>)</span> (<em>evolutive distinctiveness</em>, <span class="math inline">\(\mathit{ED}_s\)</span>) de l’espèce <span class="math inline">\(s\)</span> est la somme de la longueur des branches qui la relient à la racine de l’arbre, partagées entre tous les descendants de chaque branche.
Pour l’espèce 3 de la figure <a href="mesures-particuli%C3%A8res.html#fig:ArbreA4">7.2</a>, <span class="math inline">\(\mathit{ED}_3\)</span> est égal à <span class="math inline">\(l(b_{1,3})\)</span>, la longueur de la branche terminale propre à l’espèce 3, plus un tiers de la longueur de la branche qui relie la racine de l’arbre à la polytomie dont l’espèce 3 est issue.
Clairement, la diversité phylogénétique PD (section <a href="mesures-particuli%C3%A8res.html#sec-PDFD">7.5</a>) est la somme des particularités évolutives de toutes les espèces de l’arbre.</p>
</div>
<div id="sec-OrigTax" class="section level3" number="7.2.2">
<h3>
<span class="header-section-number">7.2.2</span> Originalité taxonomique de Ricotta<a class="anchor" aria-label="anchor" href="#sec-OrigTax"><i class="fas fa-link"></i></a>
</h3>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:HurlbertCFig"></span>
<img src="MesuresBD_files/figure-html/HurlbertCFig-1.png" alt="Contribution des espèces à l’indice de Hurlbert. Les contributions de 4 espèces d’une communauté à l’indice sont représentées en fonction de la taille de l’échantillon \(n\). Les fréquences des espèces sont lisibles pour \(n = 1\) : une espèce fréquente (probabilité égale à 0,7, supérieure à \(1/S\)), deux espèces peu fréquentes (0,19 et 0,1), et une espèce rare (0,01). Quand \(n\) est assez grand, toutes les contributions tendent vers \(1/S = 1/4\) (ligne horizontale)." width="80%"><p class="caption">
Figure 7.3: Contribution des espèces à l’indice de Hurlbert. Les contributions de 4 espèces d’une communauté à l’indice sont représentées en fonction de la taille de l’échantillon <span class="math inline">\(n\)</span>. Les fréquences des espèces sont lisibles pour <span class="math inline">\(n = 1\)</span> : une espèce fréquente (probabilité égale à 0,7, supérieure à <span class="math inline">\(1/S\)</span>), deux espèces peu fréquentes (0,19 et 0,1), et une espèce rare (0,01). Quand <span class="math inline">\(n\)</span> est assez grand, toutes les contributions tendent vers <span class="math inline">\(1/S = 1/4\)</span> (ligne horizontale).
</p>
</div>
<p></p>
<p><span class="citation">Ricotta (<a href="references.html#ref-Ricotta2004a">2004a</a>)</span> construit un indice paramétrique (permettant de donner plus ou moins d’importance aux espèces rares) à partir de l’espérance du nombre d’espèces tirées dans un échantillon de taille <span class="math inline">\(n\)</span> fixée (l’indice de <span class="citation">Hurlbert (<a href="references.html#ref-Hurlbert1971">1971</a>)</span>) :</p>
<p><span class="math display" id="eq:ESn">\[\begin{equation}
  \tag{7.9}
  {\mathbb E}\left( S^n \right)
  = \sum_s{\left[ 1-\left( 1-p_s \right)^n  \right]}.
\end{equation}\]</span></p>
<p>Ricotta pondère cette espérance par l’originalité taxonomique de chaque espèce, notée <span class="math inline">\(w_s\)</span> et normalise la mesure :
<span class="math display" id="eq:Ricotta2004a">\[\begin{equation}
  \tag{7.10}
  ^n{T}
  = \frac{\sum_s{w_s \left[ 1-\left( 1-p_s \right)^n  \right]}}{{\mathbb E}\left( S^n \right)}.
\end{equation}\]</span></p>
<p>L’originalité taxonomique est définie comme la distance phylogénétique moyenne entre l’espèce <span class="math inline">\(s\)</span> et les autres : <span class="math inline">\(w_s={\sum_s{d_{s,t}}}/{(S-1)}\)</span>.</p>
<p><span class="citation">Weikard, Punt, et Wesseler (<a href="references.html#ref-Weikard2006">2006</a>)</span> montrent que cette définition de <span class="math inline">\(w_s\)</span> ne permet pas de satisfaire l’axiome de monotonicité d’ensemble.
La définition correcte de <span class="math inline">\(w_s=\sum_s{d_{s,t}}\)</span>, validée par <span class="citation">Ricotta (<a href="references.html#ref-Ricotta2006">2006</a>)</span>.</p>
<p>L’interprétation de <span class="math inline">\(^n{T}\)</span> est plus intuitive en inversant la logique de sa construction.</p>
<p><span class="math inline">\(w_s\)</span> est l’originalité de l’espèce <span class="math inline">\(s\)</span>.
<span class="math inline">\({[1-(1-p_s)^n]}/{{\mathbb E}(S^n)}\)</span> est la contribution de l’espèce <span class="math inline">\(s\)</span> à l’espérance du nombre d’espèces, comprise entre 0 et 1.
<span class="math inline">\(^n{T}\)</span> est donc l’originalité moyenne des espèces de la communauté, pondérée par la contribution de chaque espèce à l’espérance du nombre d’espèces observé, dans un échantillon de taille <span class="math inline">\(n\)</span>.
Cette contribution est présentée en figure <a href="mesures-particuli%C3%A8res.html#fig:HurlbertCFig">7.3</a>.</p>
<p>Quand <span class="math inline">\(n=1\)</span>, c’est simplement la fréquence des espèces.
Quand <span class="math inline">\(n\)</span> augmente, le poids des espèces fréquentes (dont la proabilité est supérieure à <span class="math inline">\(\frac{1}{S}\)</span>) diminue alors que celui des espèces intermédiaires augmente.
Ce dernier atteint <span class="math inline">\({1}/{{\mathbb E}(S^n)}\)</span> (une espèce est échantillonnée à coup sûr dès que l’échantillon est assez grand) d’autant plus rapidement que <span class="math inline">\(p_s\)</span> est grand.
Il baisse ensuite alors que les espèces rares atteignent à leur tour progressivement leur poids maximal.</p>
<p>Quand <span class="math inline">\(n \to +\infty\)</span>, le numérateur tend vers FAD, et le dénominateur tend vers le nombre d’espèces : <span class="math inline">\(^n{T}\)</span> tend vers MFAD.</p>
<p>Code R pour la figure <a href="mesures-particuli%C3%A8res.html#fig:HurlbertCFig">7.3</a> :</p>
<p></p>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.19</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Ps</span><span class="op">)</span></span>
<span><span class="va">nRange</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span></span>
<span><span class="co"># Indice de Hurlbert</span></span>
<span><span class="va">ESn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">nRange</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/Hurlbert.html">Hurlbert</a></span><span class="op">(</span><span class="va">Ps</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Préparation du graphique</span></span>
<span><span class="va">Xlab</span> <span class="op">&lt;-</span> <span class="st">"Taille de l'échantillon"</span></span>
<span><span class="va">Ylab</span> <span class="op">&lt;-</span> <span class="st">"Contribution des espèces"</span></span>
<span><span class="co"># Contribution de chaque espece à chaque valeur de n</span></span>
<span><span class="va">Csn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">S</span>, <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">nRange</span>, </span>
<span>              <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">Ps</span><span class="op">[</span><span class="va">s</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">ESn</span><span class="op">)</span></span>
<span><span class="co"># Dataframe contenant les données</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">nRange</span>, <span class="va">Csn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"s07"</span>, <span class="st">"s019"</span>, <span class="st">"s01"</span>, <span class="st">"s001"</span><span class="op">)</span></span>
<span><span class="co"># Graphique</span></span>
<span><span class="va">ESnplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">gather</span><span class="op">(</span><span class="va">df</span>, <span class="va">Sp</span>, <span class="va">Contribution</span>, <span class="op">-</span><span class="va">n</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Contribution</span>, lty<span class="op">=</span><span class="va">Sp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Xlab</span>, y <span class="op">=</span> <span class="va">Ylab</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">ESnplot</span></span></code></pre></div>
<p></p>
</div>
<div id="richesse-phylogénétique" class="section level3" number="7.2.3">
<h3>
<span class="header-section-number">7.2.3</span> Richesse phylogénétique<a class="anchor" aria-label="anchor" href="#richesse-phylog%C3%A9n%C3%A9tique"><i class="fas fa-link"></i></a>
</h3>
<p>La particularité taxonomique moyenne <span class="citation">(<a href="references.html#ref-Warwick1995">Warwick et Clarke 1995</a>)</span> (<em>Average Taxonomic Distinctiveness, AvTD</em>) est la distance moyenne dans l’arbre entre deux espèces choisies au hasard.
C’est donc l’équivalent taxonomique de MFAD.
La variabilité phylogénétique des espèces <span class="citation">(<a href="references.html#ref-Helmus2007">Helmus et al. 2007</a>)</span> (<em>Phylogenetic Species Variability, PSV</em>) est la même mesure, obtenue à partir du modèle d’évolution suivant un mouvement brownien <span class="citation">(<a href="references.html#ref-Felsenstein1985">Felsenstein 1985</a>)</span>.
La distance moyenne entre deux espèces est dans ce cadre proportionnelle à la covariance de leurs traits fonctionnels.
La richesse phylogénétique des espèces, PSR, est PSV multipliée par le nombre d’espèces : c’est l’équivalent taxonomique de FAD.</p>
<p>La diversité FD de Faith (section <a href="mesures-particuli%C3%A8res.html#sec-PDFD">7.5</a>), égale à la somme des longueurs des branches de l’arbre, semble avoir fait consensus, d’où un moindre développement des mesures de richesse que dans la littérature fonctionnelle.</p>
</div>
<div id="indices-de-cadotte" class="section level3" number="7.2.4">
<h3>
<span class="header-section-number">7.2.4</span> Indices de Cadotte<a class="anchor" aria-label="anchor" href="#indices-de-cadotte"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Cadotte et al. (<a href="references.html#ref-Cadotte2010">2010</a>)</span> proposent un ensemble de mesure phylogénétiques : équitabilité, déséquilibre d’abondance et diversité de la particularité evolutive.</p>
<div id="equitabilité-phylogénétique" class="section level4" number="7.2.4.1">
<h4>
<span class="header-section-number">7.2.4.1</span> Equitabilité phylogénétique<a class="anchor" aria-label="anchor" href="#equitabilit%C3%A9-phylog%C3%A9n%C3%A9tique"><i class="fas fa-link"></i></a>
</h4>
<p>Les branches terminales de l’arbre phylogénétique sont ici à la base de la définition de l’équitabilité.
figure <a href="mesures-particuli%C3%A8res.html#fig:ArbreA3">7.4</a>, les branches <span class="math inline">\(b_{1,s}\)</span> sont les segments terminés par une feuille (au bas de l’arbre), c’est-à-dire que leur longueur est la partie de l’arbre que les espèces ne partagent pas.
La mesure d’équitabilité est
<span class="math display">\[\begin{equation}
  \mathit{PAE} = \frac{\mathit{PD} + \sum_s{l(b_{1,s})(n_s-1)}}{\mathit{PD} + (\frac{n}{S}-1)\sum_s{l(b_{1,s})} }.
\end{equation}\]</span></p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ArbreA3"></span>
<img src="images/ArbreA.png" alt="Arbre phylogénétique ou fonctionnel hypothétique." width="80%"><p class="caption">
Figure 7.4: Arbre phylogénétique ou fonctionnel hypothétique.
</p>
</div>
<p></p>
<p><span class="math inline">\(\mathit{PAE}\)</span> vaut 1 quand les espèces sont sont distribuées équitablement pour la longueur des branches.
Une valeur plus grande est obtenue quand les espèces sont concentrées au bout des longues branches, et inversement si <span class="math inline">\(0&lt;\mathit{PAE}&lt;1\)</span>.</p>
</div>
<div id="déséquilibre-dabondance" class="section level4" number="7.2.4.2">
<h4>
<span class="header-section-number">7.2.4.2</span> Déséquilibre d’abondance<a class="anchor" aria-label="anchor" href="#d%C3%A9s%C3%A9quilibre-dabondance"><i class="fas fa-link"></i></a>
</h4>
<p>L’équilibre d’abondance est défini par une distribution aléatoire des espèces par division de l’effectif total à partir de la racine de l’arbre phylogénétique.
En figure <a href="mesures-particuli%C3%A8res.html#fig:ArbreA3">7.4</a>, en partant de la racine, la moitié des individus est supposée se répartir sur chaque branche.
À la période 2, les effectifs de la branche de gauche se partagent en deux parties égales.
À partir du nombre total d’individus de la communauté, <span class="math inline">\(n\)</span>, le nombre attendu d’individus <span class="math inline">\(n_s^0\)</span> de l’espèce <span class="math inline">\(s\)</span> est une fraction de <span class="math inline">\(n\)</span> correspondant au nombre de noeuds et au nombre de branches partant de chaque noeud.
On note <span class="math inline">\(y_{k,s}\)</span> le nombre de branches partant du noeud ancestral de l’espèce <span class="math inline">\(s\)</span> à la période <span class="math inline">\(k\)</span>, s’il existe, <span class="math inline">\(y_{k,s}=1\)</span> sinon :
<span class="math display">\[\begin{equation}
  n_s^0 = \frac{n}{\prod_{k=2}^{K}{y_{k,s}}}.
\end{equation}\]</span></p>
<p>En figure <a href="mesures-particuli%C3%A8res.html#fig:ArbreA3">7.4</a>, pour l’espèce 3, <span class="math inline">\(y_{1,3}=3\)</span> (l’espèce est issue d’une polytomie), <span class="math inline">\(y_{2,3}=1\)</span> (absence de noeud) et <span class="math inline">\(y_{3,3}=2\)</span> (la racine de l’arbre est dichotomique).
On s’attend donc à ce que l’espèce 3 soit représentée par un sixième des individus.</p>
<p>L’indice de déséquilibre d’abondance mesure l’écart à cette distribution théorique :
<span class="math display" id="eq:IAC">\[\begin{equation}
  \tag{7.11}
  \mathit{IAC} = \frac{\sum_s{|n_s - n_s^0|}}{\nu}.
\end{equation}\]</span></p>
<p><span class="math inline">\(\nu\)</span> est le nombre de noeuds de l’arbre (3 dans l’exemple de la figure <a href="mesures-particuli%C3%A8res.html#fig:ArbreA3">7.4</a>).</p>
</div>
<div id="diversité-de-la-particularité-évolutive" class="section level4" number="7.2.4.3">
<h4>
<span class="header-section-number">7.2.4.3</span> Diversité de la particularité évolutive<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-de-la-particularit%C3%A9-%C3%A9volutive"><i class="fas fa-link"></i></a>
</h4>
<p>L’entropie de Shannon peut être appliquée pour mesurer la diversité des particularités évolutives :
<span class="math display" id="eq:HED">\[\begin{equation}
  \tag{7.12}
  H_{\mathit{ED}} = -\sum_s{\frac{\mathit{ED}_s}{\mathit{PD}} \ln\frac{\mathit{ED}_s}{\mathit{PD}}}.
\end{equation}\]</span></p>
<p>L’équitabilité des particularités évolutives est celle de Pielou :</p>
<p><span class="math display" id="eq:EED">\[\begin{equation}
  \tag{7.13}
  E_{\mathit{ED}} = \frac{H_{\mathit{ED}}}{\ln{S}}.
\end{equation}\]</span></p>
<p>Ces mesures ne prennent pas en compte les abondances des espèces.
Pour y remédier, il suffit d’ajouter une période de durée nulle à chaque feuille de l’arbre, correspondant à une polytomie entre les <span class="math inline">\(n_s\)</span> individus de chaque espèce.
La particularité évolutive <span class="math inline">\(\mathit{AED}_s\)</span> des individus de l’espèce <span class="math inline">\(s\)</span>, est calculée en partageant la longueur de chaque branche ancestrale entre le nombre d’individus qui en descendent (et non le nombre d’espèces).
Alors <span class="math inline">\(\mathit{PD} = \sum_s{n_s \mathit{AED}_s}\)</span>.
L’entropie devient
<span class="math display" id="eq:HAED">\[\begin{equation}
  \tag{7.14}
  H_{\mathit{AED}} = -\sum_s{\frac{n_s \mathit{AED}_s}{\mathit{PD}} \ln\frac{n_s \mathit{AED}_s}{\mathit{PD}}}
\end{equation}\]</span>
et l’équitabilité correspondante est
<span class="math display" id="eq:EAED">\[\begin{equation}
  \tag{7.15}
  E_{\mathit{AED}} = \frac{H_{\mathit{AED}}}{\ln{N}}.
\end{equation}\]</span></p>
<p>Ces indices ne mesurent pas la diversité phylogénétique au sens des autres mesures présentées dans ce chapitre.
Ils mesurent la diversité de le particularité évolutive, autrement dit du temps d’évolution accumulé par chaque espèce ou chaque individu.
Pour un nombre d’espèces fixé, <span class="math inline">\(E_{\mathit{ED}}\)</span> atteint son maximum quand les valeurs de <span class="math inline">\(\mathit{ED}_s\)</span> sont toutes identiques.
Un arbre phylogénétique composé d’une seule branche depuis la racine terminé par une polytomie de longueur nulle portant toutes les espèces correspond à cette description.
Dans cet exemple, les espèces ont une divergence évolutive nulle, mais <span class="math inline">\(E_{\mathit{ED}} = S\)</span>, son maximum possible.</p>
</div>
</div>
</div>
<div id="diversité-de-scheiner" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Diversité de Scheiner<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-de-scheiner"><i class="fas fa-link"></i></a>
</h2>
<p><span class="citation">Scheiner (<a href="references.html#ref-Scheiner2012">2012</a>)</span> développe un cadre unifié pour mesurer la diversité spécifique, phylogénétique ou fonctionnelle, séparément ou simultanément.
L’idée générale est que toute quantité partagée par les espèces (le nombre d’individus, le temps d’évolution accumulé, la taille des niches écologique) peut être traduite en nombre de Hill.</p>
<p>La diversité spécifique est simplement <span class="math inline">\(^{q}\!D\)</span>. Scheiner la note <span class="math inline">\(^{q}\!D(A)\)</span>, pour diversité d’abondance.</p>
<p>La diversité phylogénétique <span class="math inline">\(^{q}\!D(P)\)</span> ne prend pas en compte les abondances mais mesure la diversité de la divergence évolutive des espèces.
La divergence totale dans un arbre phylogénétique (pas forcément ultramétrique) est la longueur totale des branches (c’est-à-dire FD).
Elle est répartie entre toutes les espèces : la longueur de chaque branche (représentant une quantité d’évolution) est partagée à parts égales entre les espèces qui en descendent.
La divergence de l’espèce 1 de la figure <a href="mesures-particuli%C3%A8res.html#fig:Arbre">7.7</a> est <span class="math inline">\(T1+T2\)</span>, la longueur de la branche terminale, plus <span class="math inline">\({T3}/{2}\)</span>, parce que la branche est partagée par les espèces 1 et 2.
La divergence de l’espèce 1, est donc <span class="math inline">\(L_1 = T1+T2+{T3}/{2}\)</span>.
La part de la divergence de l’espèce <span class="math inline">\(s\)</span> est <span class="math inline">\(l_s = {L_s}/{FD}\)</span>.
La diversité phylogénétique est le nombre de Hill des divergences :</p>
<p><span class="math display" id="eq:HillDivergences">\[\begin{equation}
  \tag{7.16}
  ^{q}\!D = {\left(\sum^S_{s=1}{l_s^q}\right)}^{\frac{1}{1-q}}.
\end{equation}\]</span></p>
<p>La diversité fonctionnelle <span class="math inline">\(^{q}\!D(F)\)</span> est la diversité des tailles des niches. La taille de la niche est définie par Scheiner comme le volume de l’hypersphère (dans l’espace des traits fonctionnels de dimension <span class="math inline">\(m\)</span>) centrée sur chaque espèce dont le rayon est la moitié de la distance à l’espèce la plus proche pour que les sphères ne se superposent pas.
Une meilleure définition <span class="citation">(<a href="references.html#ref-Presley2014">Presley, Scheiner, et Willig 2014</a>)</span> de la taille de la niche est la somme des distances aux autres espèces : <span class="math inline">\(t_s = \sum_t{d_{s,t}}\)</span>. La part de chaque espèce est <span class="math inline">\(f_s={t_s}/{\sum_t{t_t}}\)</span> et la définition de la diversité fonctionnelle est</p>
<p><span class="math display" id="eq:DqT">\[\begin{equation}
  \tag{7.17}
  ^{q}\!D(T) = {\left(\sum^S_{s=1}{f_s^q}\right)}^{\frac{1}{1-q}}.
\end{equation}\]</span></p>
<p>La diversité peut prendre en compte plusieurs composantes, pas exemple l’abondance et la phylogénie pour définir</p>
<p><span class="math display" id="eq:qDAP">\[\begin{equation}
  \tag{7.18}
  ^{q}\!D(AP) = {\left(\sum^S_{s=1}{\left(\frac{n_s L_s}{\sum^S_{t=1}{n_t L_t}}\right)^q}\right)}^{\frac{1}{1-q}}.
\end{equation}\]</span></p>
<p>La diversité d’abondance et phylogénétique est la diversité des divergences pondérées par les effectifs des espèces.
La mesure de biodiversité de Scheiner, incluant les trois composantes, est</p>
<p><span class="math display" id="eq:qDAF">\[\begin{equation}
  \tag{7.19}
  ^{q}\!D(APF) = {\left(\sum^S_{s=1}{\left(\frac{n_s L_s t_s}{\sum^S_{t=1}{n_t L_t t_t}}\right)^q}\right)}^{\frac{1}{1-q}}.
\end{equation}\]</span></p>
<p>Son interprétation est moins immédiate.
Chaque espèce est associée à une fraction d’une des trois dimensions de la diversité (abondance, temps d’évolution cumulé, taille des niches).
Elle occupe un parallélépipède de dimensions <span class="math inline">\((p_s, l_s, f_s)\)</span> dans le cube de dimension 1 qui les contient toutes.
Cette représentation ne donne pas d’importance particulière à l’abondance, et peut être appliquée à un nombre quelconque de dimensions.
La mesure de biodiversité est la diversité des volumes occupés par les espèces, normalisés par leur somme (qui n’est pas égale à 1).</p>
<p>En se limitant à deux dimensions pour la lisibilité, la figure <a href="mesures-particuli%C3%A8res.html#fig:ScheinerPsfsFig">7.5</a> présente les rectangles correspondant à la diversité d’abondance et fonctionnelle occupés par les espèces de la méta-communauté <code>Paracou618</code>, classées par fréquences décroissantes.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ScheinerPsfsFig"></span>
<img src="MesuresBD_files/figure-html/ScheinerPsfsFig-1.png" alt="Rectangles de surface fréquence \(\times\) taille de niche des espèces de la méta-communauté Paracou618. La diversité de Scheiner \(^{q}\!D(AF)\) est la diversité de leur surface." width="80%"><p class="caption">
Figure 7.5: Rectangles de surface fréquence <span class="math inline">\(\times\)</span> taille de niche des espèces de la méta-communauté <code>Paracou618</code>. La diversité de Scheiner <span class="math inline">\(^{q}\!D(AF)\)</span> est la diversité de leur surface.
</p>
</div>
<p></p>
<p>Code R :</p>
<p></p>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Probabilités</span></span>
<span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Ps</span><span class="op">[</span><span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Ps</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">Ps</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Fréquences cumulées</span></span>
<span><span class="va">PsCum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">Ps</span><span class="op">)</span></span>
<span><span class="va">Xgauche</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">PsCum</span><span class="op">)</span></span>
<span><span class="va">Xdroite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">PsCum</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Matrice de distances fonctionnelles</span></span>
<span><span class="va">DistanceMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Paracou618.dist</span><span class="op">)</span></span>
<span><span class="co"># Mise en correspondance de la matrice et du vecteur de probabilités</span></span>
<span><span class="va">DistanceMatrix</span> <span class="op">&lt;-</span> <span class="va">DistanceMatrix</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Ps</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Ps</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Taille des niches</span></span>
<span><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">DistanceMatrix</span><span class="op">)</span></span>
<span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="va">ts</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span><span class="co"># Fréquences cumulées</span></span>
<span><span class="va">fsCum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span></span>
<span><span class="va">Ybas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">fsCum</span><span class="op">)</span></span>
<span><span class="va">Yhaut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">fsCum</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Rectangles occupés par chaque espèce</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Xgauche</span>, <span class="va">Ybas</span>, <span class="va">Xdroite</span>, <span class="va">Yhaut</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_rect</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xmin<span class="op">=</span> <span class="va">Xgauche</span>, xmax<span class="op">=</span> <span class="va">Xdroite</span>, ymin<span class="op">=</span> <span class="va">Ybas</span>, ymax<span class="op">=</span> <span class="va">Yhaut</span><span class="op">)</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Fréquence"</span>, y<span class="op">=</span><span class="st">"Niche"</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>La diversité d’abondance et fonctionnelle est la diversité de la surface des rectangles :</p>
<p></p>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Surface</span> <span class="op">&lt;-</span> <span class="va">Ps</span> <span class="op">*</span> <span class="va">fs</span></span>
<span><span class="va">Rs</span> <span class="op">&lt;-</span> <span class="va">Surface</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Surface</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/Diversity.html">Diversity</a></span><span class="op">(</span><span class="va">Rs</span>, q <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     None 
## 71.72482</code></pre>
<p></p>
<p>Le profil de diversité d’abondance et fonctionnelle est en figure <a href="mesures-particuli%C3%A8res.html#fig:ProfilDqAFFig">7.6</a>.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ProfilDqAFFig"></span>
<img src="MesuresBD_files/figure-html/ProfilDqAFFig-1.png" alt="Profil de diversité d’abondance et fonctionnelle de Scheiner de la méta-communauté Paracou618. Pointillés longs : diversité d’abondance ; pointillés courts : diversité fonctionnelle ; trait plein : diversité d’abondance et fonctionnelle." width="80%"><p class="caption">
Figure 7.6: Profil de diversité d’abondance et fonctionnelle de Scheiner de la méta-communauté <code>Paracou618</code>. Pointillés longs : diversité <span style="white-space:nowrap">d’abondance ;</span> pointillés courts : diversité <span style="white-space:nowrap">fonctionnelle ;</span> trait plein : diversité d’abondance et fonctionnelle.
</p>
</div>
<p></p>
<p>Code R :</p>
<p></p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/CommunityProfile.html">CommunityProfile</a></span><span class="op">(</span><span class="va">Diversity</span>, <span class="va">Rs</span><span class="op">)</span>, </span>
<span>         xlab<span class="op">=</span><span class="st">"Ordre de diversité"</span>, ylab<span class="op">=</span><span class="st">"Diversité"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame.list</a></span><span class="op">(</span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/CommunityProfile.html">CommunityProfile</a></span><span class="op">(</span><span class="va">Diversity</span>, <span class="va">Ps</span><span class="op">)</span><span class="op">)</span>, </span>
<span>          mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame.list</a></span><span class="op">(</span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/CommunityProfile.html">CommunityProfile</a></span><span class="op">(</span><span class="va">Diversity</span>, <span class="va">fs</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>La notion de diversité phylogénétique ou fonctionnelle traitée par Scheiner est assez différente de celles vues précédemment parce qu’elle considère toutes les dimensions de façon symétrique : l’ordre de diversité, <span class="math inline">\(q\)</span>, s’applique à toutes les dimensions.
Si <span class="math inline">\(q\)</span> est grand, les espèces dont le produit des dimensions de la diversité est petit (que l’espèce soit rare, ait une divergence phylogénétique faible ou une niche étroite) sont négligées, alors que <span class="math inline">\(q\)</span> n’affecte que la fréquence dans le cadre de la phylodiversité <span class="math inline">\(^{q}\!\bar{D}\)</span> ou la banalité pour <span class="math inline">\(^q\!D^{\mathbf{Z}}\)</span>.</p>
</div>
<div id="diversité-de-solow-et-polasky" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Diversité de Solow et Polasky<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-de-solow-et-polasky"><i class="fas fa-link"></i></a>
</h2>
<p><span class="citation">Solow et Polasky (<a href="references.html#ref-Solow1994">1994</a>)</span> relient la richesse fonctionnelle ou phylogénétique à la probabilité de trouver au moins une espèce intéressante (par exemple, capable de fournir une molécule utile) dans une communauté.</p>
<p>Les distances entre espèces sont supposées connues, qu’elles soient fonctionnelle, phylogénétique ou autre.
La probabilité qu’une espèce quelconque soit intéressante est fixée à <span class="math inline">\(p\)</span>, par exemple à partir de l’expérience passée (si une espèce criblée sur 100 fournit une molécule utile, <span class="math inline">\(p=1\%\)</span>).
En absence d’information sur les espèces, <span class="math inline">\(p\)</span> est <em>a priori</em> identique pour toutes mais on suppose une corrélation entre les probabilités dépendant de la distance entre les espèces.
Formellement, une fonction de similarité entre les espèces <span class="math inline">\(s\)</span> et <span class="math inline">\(t\)</span> est définie : <span class="math inline">\(z_{s,t}=f(d_{s,t})\)</span>.
Cette fonction est décroissante entre 1 (quand la distance est nulle) et 0 (à distance <span style="white-space:nowrap">infinie) ;</span> par exemple <span class="math inline">\(f(d_{s,t}) = e^{-u d_{s,t}}\)</span> où <span class="math inline">\(u\)</span> est une constante strictement positive.
La matrice <span class="math inline">\(\mathbf{Z}\)</span> réunit les éléments <span class="math inline">\(z_{s,t}\)</span>.</p>
<p>On définit ensuite la variable de Bernoulli <span class="math inline">\(B_s\)</span> (d’espérance <span class="math inline">\(p_s\)</span>) qui vaut 1 si l’espèce <span class="math inline">\(s\)</span> est intéressante.
<span class="math inline">\(z_{s,t}\)</span> est, par construction du modèle, la corrélation entre <span class="math inline">\(B_s\)</span> et <span class="math inline">\(B_t\)</span> : deux espèces très proches ont la même probabilité d’être intéressante, deux espèces très éloignées ont des probabilités indépendantes.
La probabilité qu’au moins une espèce soit intéressante est minorée par <span class="math inline">\(p^2 \mathbf{1}_S' \mathbf{Z}^{-1} \mathbf{1}_S\)</span>, où <span class="math inline">\(\mathbf{1}_S\)</span> est le vecteur de longueur <span class="math inline">\(S\)</span> ne contenant que des 1, <span class="math inline">\('\)</span> indique la transposée et <span class="math inline">\(\mathbf{Z}^{-1}\)</span> est la matrice inverse de <span class="math inline">\(\mathbf{Z}\)</span> (son existence est garantie puisque <span class="math inline">\(\mathbf{Z}\)</span> est une matrice de variance-covariance).
La valeur de <span class="math inline">\(p\)</span> est incertaine et sans grand intérêt.</p>
<p><span class="math inline">\(V = \mathbf{1}_S' \mathbf{Z}^{-1} \mathbf{1}_S\)</span> est la mesure de diversité de Solow et Polasky.
Elle rend compte de la dispersion des espèces : moins les espèces sont similaires, plus la probabilité que l’une d’elle au moins soit intéressante est élevée, conditionnellement au nombre d’espèces et à <span class="math inline">\(p\)</span>.
Si les espèces sont infiniment éloignées les unes des autres, <span class="math inline">\(\mathbf{Z}\)</span> est la matrice identité et la diversité est égale à la richesse : <span class="math inline">\(V\)</span> est donc un nombre effectif d’espèces, c’est-à-dire le nombre d’espèces totalement dissimilaires nécessaires pour obtenir la diversité observée.
À l’opposé, si toutes les espèces sont identiques, <span class="math inline">\(\mathbf{Z}\)</span> ne contient que des 1 et la diversité vaut 1.</p>
</div>
<div id="sec-PDFD" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> FD et PD<a class="anchor" aria-label="anchor" href="#sec-PDFD"><i class="fas fa-link"></i></a>
</h2>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Arbre"></span>
<img src="images/Arbre.png" alt="Arbre phylogénétique ou fonctionnel hypothétique. (a) Arbre complet. 5 espèces sont présentes (\(S = 5\)). Une période de l’arbre est définie entre deux noeuds successifs : l’arbre contient \(K = 3\) périodes. Les hauteurs des périodes sont notées \(T_k\). À chaque période correspond un arbre plus simple : (b) pour la période 2, (c) pour la période 3 dans lequel les espèces originales sont regroupées. Le nombre de feuilles de ces arbres est noté \(L_k\). Les probabilités pour un individu d’appartenir à une feuille sont notées \(u_{k,l}\)." width="80%"><p class="caption">
Figure 7.7: Arbre phylogénétique ou fonctionnel hypothétique. (a) Arbre complet. 5 espèces sont présentes (<span class="math inline">\(S = 5\)</span>). Une période de l’arbre est définie entre deux noeuds successifs : l’arbre contient <span class="math inline">\(K = 3\)</span> périodes. Les hauteurs des périodes sont notées <span class="math inline">\(T_k\)</span>. À chaque période correspond un arbre plus simple : (b) pour la période 2, (c) pour la période 3 dans lequel les espèces originales sont regroupées. Le nombre de feuilles de ces arbres est noté <span class="math inline">\(L_k\)</span>. Les probabilités pour un individu d’appartenir à une feuille sont notées <span class="math inline">\(u_{k,l}\)</span>.
</p>
</div>
<p></p>
<p>Si la dissimilarité entre les espèces est représentée par un dendrogramme, les indices de diversité les plus simples sont la diversité phylogénétique <span class="citation">(<a href="references.html#ref-Faith1992">Faith 1992</a>)</span> et sa transposition, la diversité fonctionnelle <span class="citation">(<a href="references.html#ref-Petchey2002">Petchey et Gaston 2002</a>)</span>.</p>
<p>Étant donné un arbre contenant toutes les espèces ou tous les individus étudiés, PD ou FD sont égaux à la somme de la longueur des branches (figure <a href="mesures-particuli%C3%A8res.html#fig:Arbre">7.7</a> : <span class="math inline">\(\mathit{PD}=5\times T_1 + 3\times T_2 + 2\times T_3)\)</span>.
Si les noeuds de l’arbre phylogénétique sont datés, PD peut être considéré comme une accumulation de temps d’évolution par la communauté étudiée : <span class="citation">Sol et al. (<a href="references.html#ref-Sol2017">2017</a>)</span> montrent par exemple que les milieux urbanisés ont un déficit de 450 millions d’années d’évolution dans les communautés d’oiseaux relativement aux environnements naturels voisins.</p>
<p>Dans le cas particulier ou toutes les branches sont de longueur 1, c’est-à-dire que toutes les espèces sont liées à la même racine (on dira que l’arbre est parfaitement régulier), PD et FD sont égales à la richesse spécifique.</p>
<p>Le package <em>entropart</em> fournit la fonction <code>PDFD</code> :</p>
<p></p>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vecteur des probabilités</span></span>
<span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Ps</span></span>
<span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/PDFD.html">PDFD</a></span><span class="op">(</span><span class="va">Ps</span>, <span class="va">Paracou618.Taxonomy</span><span class="op">)</span></span></code></pre></div>
<pre><code>## None 
##  395</code></pre>
<p></p>
<p><span class="citation">Chao, Chiu, et al. (<a href="references.html#ref-Chao2014b">2015</a>)</span> fournissent un estimateur de PD (ou FD) permettant de l’estimer sans biais pour un échantillon plus petit que celui observé et de façon fiable pour un échantillon de taille double au maximum. Ces estimateurs permettent de tracer des courbes de raréfaction et d’extrapolation.</p>
<p>En même temps que Faith, <span class="citation">Weitzman (<a href="references.html#ref-Weitzman1992">1992</a>)</span> a établi une fonction de diversité identique à PD.
À partir d’une matrice de dissimilarités entre espèces, un arbre est construit par la méthode suivante.
Les deux espèces les plus proches sont rassemblées.
L’une d’elles, celle qui diminue le moins la longueur totale des branches de l’arbre final en la retirant, est l’espèce de <em>lien</em>, l’autre est l’espèce <em>représentative</em> du clade.
L’espèce de lien est retirée et le regroupement poursuivi entre les deux nouvelles espèces les plus proches.
À chaque étape, l’espèce de lien est retirée jusqu’au regroupement final entre les deux dernières espèces.
La difficulté est que l’arbre final n’est pas connu aux premiers stades de regroupement donc tous les arbres doivent être testés pour trouver la solution unique.
La diversité est la somme des distances entre les espèces de lien et leur espèce représentative, c’est-à-dire la longueur totale des branches de l’arbre obtenu.
L’application à la conservation est que les espèces représentatives doivent être favorisées par rapport aux espèces de <span style="white-space:nowrap">lien ;</span> en d’autres termes, les espèces dont les branches sont les plus courtes dans l’arbre sont celles qui apportent le moins de diversité.
Ce résultat est assez évident quand on dispose d’un arbre phylogénétique.
L’originalité de la méthode de Weitzman est de fournir un algorithme pour créer l’arbre à partir d’une matrice de distances qui est cohérent avec la mesure de diversité appliquée.</p>
<p>La mesure de diversité peut être combinée avec une probabilité d’extinction de chaque espèce (à dire d’expert) pour calculer l’espérance de la diversité à une échéance donnée <span class="citation">(<a href="references.html#ref-Weitzman1993">Weitzman 1993</a>)</span> : <span class="math inline">\(2^S\)</span> arbres peuvent être construit en faisant disparaître certaines des <span class="math inline">\(S\)</span> espèces de la communauté, la probabilité de chaque arbre est calculable à partir des probabilités d’extinction de chaque espèce (supposées indépendantes) et l’espérance de diversité est simplement la moyenne des diversités de chaque arbre pondérée par sa probabilité.
L’espérance de la perte de diversité peut être calculée de façon plus simple <span class="citation">(<a href="references.html#ref-Witting1995">Witting et Loeschcke 1995</a>)</span>, comme la moyenne de la longueur des branches pondérée par la probabilité de leur disparition, qui est le produit de la probabilité de disparition de toutes les espèces descendant de la branche.</p>
<p>Diverses optimisations économiques sont possibles, dont le choix des espèces à protéger à partir de l’élasticité de la diversité, c’est-à-dire le gain de diversité entraîné par la diminution de la probabilité de disparition de chaque espèce : les espèces ayant la plus grande élasticité sont celles sur lesquelles les efforts auront les plus grands résultats.</p>
</div>
<div id="sec-Rao" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Indice de Rao<a class="anchor" aria-label="anchor" href="#sec-Rao"><i class="fas fa-link"></i></a>
</h2>
<p>L’indice de Rao est une mesure de divergence pondérée. Son utilisation s’est largement développée depuis le début des années 2000 <span class="citation">(<a href="references.html#ref-Izsak2000">Izsák et Papp 2000</a>; <a href="references.html#ref-Shimatani2001a">Shimatani 2001b</a>; <a href="references.html#ref-Botta-Dukat2005">Botta-Dukát 2005</a>; <a href="references.html#ref-Escalas2013">Escalas et al. 2013</a>)</span> en raison de ses propriétés particulièrement intéressantes.</p>
<div id="principe" class="section level3" number="7.6.1">
<h3>
<span class="header-section-number">7.6.1</span> Principe<a class="anchor" aria-label="anchor" href="#principe"><i class="fas fa-link"></i></a>
</h3>
<p>À partir de relevés fournissant la fréquence de chaque espèce par communauté et d’une matrice de dissimilarité entre paires d’espèces, l’indice de <span class="citation">Rao (<a href="references.html#ref-Rao1982">1982</a>)</span> donne la dissimilarité moyenne entre deux individus choisis au hasard.</p>
<p>L’indice de Rao est souvent appelé “entropie quadratique” en raison de sa forme mathématique.</p>
</div>
<div id="formalisation" class="section level3" number="7.6.2">
<h3>
<span class="header-section-number">7.6.2</span> Formalisation<a class="anchor" aria-label="anchor" href="#formalisation"><i class="fas fa-link"></i></a>
</h3>
<p>Les espèces sont prises deux à deux et sont donc notées ici <span class="math inline">\(s'\)</span> et <span class="math inline">\(s''\)</span>.</p>
<p>On note <span class="math inline">\(\mathbf{\Delta}\)</span> la matrice de dissimilarité dont les éléments sont <span class="math inline">\(\delta_{s's''}\)</span>, la dissimilarité entre l’espèce <span class="math inline">\(s'\)</span> et l’espèce <span class="math inline">\(s''\)</span>.
Il n’est pas nécessaire à ce stade que <span class="math inline">\(\mathbf{\Delta}\)</span> soit une distance.
<span class="math inline">\(\mathbf{p}\)</span> est le vecteur des probabilités dont <span class="math inline">\(p_{s'}\)</span> et <span class="math inline">\(p_{s''}\)</span> sont des éléments :</p>
<p>L’indice de Rao est</p>
<p><span class="math display" id="eq:Rao">\[\begin{equation}
  \tag{7.20}
  H_{\mathbf{\Delta}}\left(\mathbf{p}\right)=\sum_{s'}{\sum_{s''}{p_{s'}}}p_{s''}\delta_{s's''}.
\end{equation}\]</span></p>
</div>
<div id="propriétés" class="section level3" number="7.6.3">
<h3>
<span class="header-section-number">7.6.3</span> Propriétés<a class="anchor" aria-label="anchor" href="#propri%C3%A9t%C3%A9s"><i class="fas fa-link"></i></a>
</h3>
<p>La définition de la distance est essentielle :</p>
<ul>
<li>en fixant <span class="math inline">\(\delta_{s's''}=1\)</span> si deux espèces sont différentes, on obtient l’indice de Simpson.
Sa valeur peut être interprétée comme la probabilité qu’une paire d’individus choisie au hasard soit de deux espèces <span style="white-space:nowrap">différentes ;</span>
</li>
<li>Dans un espace unidimensionnel où la valeur <span class="math inline">\(y_s\)</span> associée à l’espèce <span class="math inline">\(s\)</span> est une variable quantitative <span class="math inline">\(Y\)</span>, choisir <span class="math inline">\(\delta_{s's''}={{\left(y_k-y_l\right)}^2}/{2}\)</span> rend l’indice de Rao égal à la variance de <span class="math inline">\(Y\)</span>.</li>
</ul>
<p><span class="citation">Pavoine, Ollier, et Pontier (<a href="references.html#ref-Pavoine2005c">2005</a>)</span> ont montré que l’utilisation de distances ordinaires fait que la valeur maximale de l’entropie quadratique pour un effectif donné est obtenue en éliminant les espèces intermédiaires en ne retenant que les espèces extrêmes (le résultat est évident en une dimension : la variance est maximale en ne retenant que les valeurs extrêmes d’un échantillon).
Ce résultat est contraire aux propriétés attendues d’un indice de diversité.
Les auteurs ont établi que l’utilisation de distances ultramétriques corrige ce défaut.
L’indice atteint alors son maximum pour des fréquences d’autant plus grandes que l’espèce est originale <span class="citation">(<a href="references.html#ref-Pavoine2005a">Pavoine, Ollier, et Dufour 2005</a>)</span>.</p>
<p>L’estimation empirique de l’indice se fait simplement en estimant les probabilités par les fréquences.
Le biais d’estimation est très faible <span class="citation">(<a href="references.html#ref-Marcon2014a">Marcon et al. 2014</a>)</span> : par analogie avec l’estimateur de l’indice de Simpson, les espèces rares interviennent peu.</p>
</div>
<div id="calcul-sous-r" class="section level3" number="7.6.4">
<h3>
<span class="header-section-number">7.6.4</span> Calcul sous R<a class="anchor" aria-label="anchor" href="#calcul-sous-r"><i class="fas fa-link"></i></a>
</h3>
<p>Le package <em>entropart</em> fournit la fonction <code>Rao</code> :</p>
<p></p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vecteur des probabilités</span></span>
<span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Ps</span></span>
<span><span class="fu"><a href="https://ericmarcon.github.io/entropart/reference/Rao.html">Rao</a></span><span class="op">(</span><span class="va">Ps</span>, <span class="va">Paracou618.Taxonomy</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     None 
## 2.878133</code></pre>
<p></p>
<p>Le package <em>ADE4</em> permet le calcul avec la fonction <code>divc</code> qui utilise un format différent pour les probabilités et surtout la matrice des racines carrées du double des distances de l’objet <code>phylog</code> (chaque élément de <code>\$Wdist</code> vaut <span class="math inline">\(\sqrt{2\delta_{s's''}}\)</span>.
Cette particularité d’<em>ADE4</em> vient de l’analyse multivariée <span class="citation">(<a href="references.html#ref-Champely2002">Champely et Chessel 2002</a>)</span> : l’entropie quadratique de Rao peut être représentée dans l’espace euclidien engendré par une matrice de distances <span class="math inline">\(\mathbf{D}\)</span> entre espèces (par une Analyse en Coordonnées Principales, PCoA).
L’inertie des points représentants les espèces, précisément la moyenne des carrés des distances entre les espèces et leur centre de gravité (les probabilités <span class="math inline">\(\mathbf{p}\)</span> des espèces constituent leur poids), est alors égale à l’entropie de Rao <span class="math inline">\(H_{\mathbf{\Delta}}\left(\mathbf{p}\right)\)</span>, où la matrice de distances <span class="math inline">\(\mathbf{\Delta}\)</span> est <span class="math inline">\({\mathbf{D}^{\circ2}}/{2}\)</span> : les valeurs de <span class="math inline">\(\mathbf{\Delta}\)</span> valent la moitié du carré de celles de <span class="math inline">\(\mathbf{D}\)</span>.
Cette représentation est étendue dans la double analyse en composantes principales de <span class="citation">Pavoine, Dufour, et Chessel (<a href="references.html#ref-Pavoine2004">2004</a>)</span>, section <a href="chap-DedompHCDT.html#sec-RaoDisc">12.5</a>.</p>
<p>Dans <em>ADE4</em>, les arbres phylogénétiques sont donc stockés sous la forme d’objets de type <code>phylog</code> où la matrice des distances (<code>\$Wdist</code>) est <span class="math inline">\(\mathbf{D}\)</span> mais les longueurs des branches de l’arbre (<code>\$droot</code>) correspondent aux valeurs de <span class="math inline">\(\mathbf{\Delta}\)</span>.</p>
<p></p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://pbil.univ-lyon1.fr/ADE-4/">"ade4"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/divc.html">divc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">Ps</span><span class="op">)</span>, <span class="va">Paracou618.Taxonomy</span><span class="op">$</span><span class="va">Wdist</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    diversity
## Ps 0.9854485</code></pre>
<p></p>
<p><code>divc</code> peut traiter plusieurs communautés <span style="white-space:nowrap">simultanément ;</span> <code>Rao</code> peut être utilisé avec la fonction <code>apply</code> :</p>
<p></p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/divc.html">divc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Psi</span><span class="op">)</span>, <span class="va">Paracou618.Taxonomy</span><span class="op">$</span><span class="va">Wdist</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      diversity
## P006 0.9727197
## P018 0.9794563</code></pre>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Paracou618.MC</span><span class="op">$</span><span class="va">Psi</span>, <span class="fl">2</span>, <span class="va">Rao</span>, Tree <span class="op">=</span> <span class="va">Paracou618.Taxonomy</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     P006     P018 
## 2.820856 2.876405</code></pre>
<p></p>
</div>
<div id="sec-MaxTheorique" class="section level3" number="7.6.5">
<h3>
<span class="header-section-number">7.6.5</span> Maximum théorique<a class="anchor" aria-label="anchor" href="#sec-MaxTheorique"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Pavoine, Ollier, et Dufour (<a href="references.html#ref-Pavoine2005a">2005</a>)</span> ont défini l’originalité d’une espèce comme sa fréquence maximisant l’entropie quadratique, sachant la matrice de distances entre espèces.
Les espèces les plus originales sont celles ayant le moins d’espèces proches dans la classification.</p>
<p>L’originalité n’est pas intéressante dans une taxonomie : une phylogénie doit être créée pour illustrer cette notion.
Le fichier <code>rao.traits.csv</code> contient une espèce par ligne, identifiée par le champ <code>Code</code>, et un certain nombre de valeurs de traits en colonnes.</p>
<p></p>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lecture des données: traits pour 34 espèces</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv2</a></span><span class="op">(</span><span class="st">"data/rao.traits.csv"</span>, row.names <span class="op">=</span> <span class="fl">1</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">-&gt;</span></span>
<span>    <span class="va">traits</span></span></code></pre></div>
<p></p>
<p>Le résultat est un <em>data frame</em> nommé <code>traits</code> à 8 lignes (espèces) et 6 colonnes (traits) :</p>
<p></p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aperçu</span></span>
<span><span class="va">traits</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<pre><code>##          SLA       Am       Gm
## Ess 10.10341 97.88627 1.454455
## Me  14.27473 63.52255 1.493502
## S1  13.71211 73.57748 1.963457
## Sr  10.71081 68.03988 1.305796</code></pre>
<p></p>
<p>La matrice de distances est créée par classification automatique hiérarchique.</p>
<p></p>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ACP sur les traits foliaires</span></span>
<span><span class="va">pcaf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">traits</span>, scale <span class="op">=</span> <span class="cn">T</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:PCAFFig"></span>
<img src="MesuresBD_files/figure-html/PCAFFig-1.png" alt="Analyse en composante principale des traits foliaires" width="80%"><p class="caption">
Figure 7.8: Analyse en composante principale des traits foliaires
</p>
</div>
<p></p>
<p><code>pcaf</code> (figure <a href="mesures-particuli%C3%A8res.html#fig:PCAFFig">7.8</a>) est une liste qui contient les résultats de l’ACP, à utiliser pour la classification :</p>
<p></p>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CAH Ward des traits foliaires</span></span>
<span><span class="va">hf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">pcaf</span><span class="op">$</span><span class="va">tab</span><span class="op">)</span>, <span class="st">"ward.D"</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>Code R pour la figure <a href="mesures-particuli%C3%A8res.html#fig:PCAFFig">7.8</a> :</p>
<p></p>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/scatter.html">scatter</a></span><span class="op">(</span><span class="va">pcaf</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:HclustFig"></span>
<img src="MesuresBD_files/figure-html/HclustFig-1.png" alt="Arbre phylogénétique issu de la classification automatique." width="80%"><p class="caption">
Figure 7.9: Arbre phylogénétique issu de la classification automatique.
</p>
</div>
<p></p>
<p>Le résultat de la classification est un objet <code>hclust</code> (figure <a href="mesures-particuli%C3%A8res.html#fig:HclustFig">7.9</a> qui doit être transformé en <code>phylog</code> pour la suite de l’analyse :</p>
<p></p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Transformation de l'arbre du format hclust au format</span></span>
<span><span class="co"># phylog</span></span>
<span><span class="va">phyf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/newick2phylog.html">hclust2phylog</a></span><span class="op">(</span><span class="va">hf</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>Code R pour la figure <a href="mesures-particuli%C3%A8res.html#fig:HclustFig">7.9</a> :</p>
<p></p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">hf</span>, h <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>Le résultat est en figure <a href="mesures-particuli%C3%A8res.html#fig:PhylogRaoFig">7.10</a>.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:PhylogRaoFig"></span>
<img src="MesuresBD_files/figure-html/PhylogRaoFig-1.png" alt="Présentation de l’arbre phylogénétique avec la contribution de chacune des variables." width="80%"><p class="caption">
Figure 7.10: Présentation de l’arbre phylogénétique avec la contribution de chacune des variables.
</p>
</div>
<p></p>
<p>Code R pour la figure <a href="mesures-particuli%C3%A8res.html#fig:PhylogRaoFig">7.10</a> :</p>
<p></p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/table.phylog.html">table.phylog</a></span><span class="op">(</span><span class="va">pcaf</span><span class="op">$</span><span class="va">tab</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">phyf</span><span class="op">$</span><span class="va">leaves</span><span class="op">)</span>, <span class="op">]</span>, <span class="va">phyf</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>La limite des distances ultramétriques est leur tendance à déformer le jeu de points <span class="citation">(<a href="references.html#ref-Pavoine2005a">Pavoine, Ollier, et Dufour 2005</a>)</span>.
Dans cet exemple, les deux premiers axes de l’ACP rendent compte de presque toute l’inertie.
Le nuage de points est pratiquement contenu dans un plan alors que sa représentation en distance ultramétrique est une hypersphère en 7 dimensions.</p>
<p>Le calcul de l’originalité des espèces utilise la fonction <code>originality</code> (figure <a href="mesures-particuli%C3%A8res.html#fig:originalityFig">7.11</a>).</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:originalityFig"></span>
<img src="MesuresBD_files/figure-html/originalityFig-1.png" alt="Originalité des espèces." width="80%"><p class="caption">
Figure 7.11: Originalité des espèces.
</p>
</div>
<p></p>
<p>Code R pour la figure <a href="mesures-particuli%C3%A8res.html#fig:originalityFig">7.11</a> :</p>
<p></p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dotchart.phylog.html">dotchart.phylog</a></span><span class="op">(</span><span class="va">phyf</span>, <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/originality.html">originality</a></span><span class="op">(</span><span class="va">phyf</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>La fonction a pour paramètres l’objet <code>phylog</code> contenant la classification et le numéro de la méthode de calcul à utiliser, 5 pour l’entropie quadratique.
Sa représentation graphique est faite par <code>dotchart.phylog</code> :</p>
<p>L’originalité ne repose que sur l’arbre, pas sur la fréquence des espèces.</p>
<p>Si la distance utilisée n’est pas ultramétrique, il existe plusieurs distributions possibles d’espèces qui maximisent la diversité <span class="citation">(<a href="references.html#ref-Pavoine2009">Pavoine et Bonsall 2009</a>)</span>, le concept d’originalité n’a pas de sens dans ce cas.</p>
<p>La valeur de l’entropie quadratique dépend de la hauteur de l’arbre.
Plusieurs normalisations ont été proposées : par sa valeur maximale ou par la diversité de Simpson (correspondant à un arbre dont toutes les espèces seraient équidistantes) <span class="citation">(<a href="references.html#ref-Ricotta2005c">Ricotta et Avena 2005</a>)</span>, ou en fixant la hauteur de l’arbre à 1 <span class="citation">(<a href="references.html#ref-Marcon2014b">Marcon et Hérault 2015a</a>)</span>.</p>
</div>
</div>
<div id="diversité-et-moyenne" class="section level2" number="7.7">
<h2>
<span class="header-section-number">7.7</span> Diversité et moyenne<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-et-moyenne"><i class="fas fa-link"></i></a>
</h2>
<p><span class="citation">Garnier et al. (<a href="references.html#ref-Garnier2004">2004</a>)</span> définissent la moyenne pondérée d’un trait à l’échelle de la communauté (CWM : <em>Community Weigthed Mean</em>), simplement égal à la moyenne de la valeur du trait pondérée par la fréquence des espèces :</p>
<p><span class="math display" id="eq:CWM">\[\begin{equation}
  \tag{7.21}
  \mathit{CWM} = \sum_s{p_s y_s}.
\end{equation}\]</span></p>
<p>CWM n’est pas une mesure de diversité fonctionnelle, bien qu’il ait été utilisé parfois en tant que tel <span class="citation">(<a href="references.html#ref-Lavorel2008">Lavorel et al. 2008</a>)</span>, mais une mesure de la composition de la communauté.
CWM peut être étendu à plusieurs traits : le vecteur formé par les valeurs de CWM pour chaque trait correspond au centre de gravité de la communauté représentée dans l’espace des traits.
L’entropie quadratique de Rao mesure la dispersion des espèces autour de ce point : les deux mesures se complètent donc <span class="citation">(<a href="references.html#ref-Ricotta2011">Ricotta et Moretti 2011</a>)</span>.</p>
</div>
<div id="variations-sur-lentropie-quadratique" class="section level2" number="7.8">
<h2>
<span class="header-section-number">7.8</span> Variations sur l’entropie quadratique<a class="anchor" aria-label="anchor" href="#variations-sur-lentropie-quadratique"><i class="fas fa-link"></i></a>
</h2>
<p><span class="citation">Izsák et Pavoine (<a href="references.html#ref-Izsak2011">2011</a>)</span> proposent deux variantes de l’indice de Rao dans lesquelles la distance entre espèces dépend de leurs probabilités :</p>
<p><span class="math display" id="eq:L1">\[\begin{equation}
  \tag{7.22}
  L_1 = \sum_{s}{\sum_{t}{p_{s}p_{t}{\left(p_{s}-p_{t}\right)}^2}};
\end{equation}\]</span></p>
<p><span class="math display" id="eq:L2">\[\begin{equation}
  \tag{7.23}
  L_2=\sum_{s}{\sum_{t}{p_{s}p_{t}{\left(\ln{p_{s}}-\ln{p_{t}}\right)}^2}}.
\end{equation}\]</span></p>
<p>Ces indices sont proposés pour leurs propriétés mathématiques, assurant l’existence de sa décomposition, sans support écologique bien établi.</p>
<p><span class="math inline">\(\mathbf{\Delta}\)</span> est la matrice de dissimilarité dont les éléments sont <span class="math inline">\(\delta_{s,t}\)</span>, la dissimilarité entre l’espèce <span class="math inline">\(s\)</span> et l’espèce <span class="math inline">\(t\)</span>.
R. C. Guiasu et S. Guiasu <span class="citation">(<a href="references.html#ref-Guiasu2011">2011</a>, <a href="references.html#ref-Guiasu2012">2012</a>)</span> proposent l’indice <span class="math inline">\(\mathit{{GS}_{D}}\)</span> pour ses propriétés mathématiques et fournissent sa décomposition :</p>
<p><span class="math display" id="eq:Guiasu">\[\begin{equation}
  \tag{7.24}
  \mathit{{GS}_{D}}=\sum_{s}{\sum_{t}{\delta_{s,t}p_{s}}}p_{t}\left(1-p_{s}p_{t}\right).
\end{equation}\]</span></p>
</div>
<div id="diversité-fonctionnelle-de-chiu-et-chao" class="section level2" number="7.9">
<h2>
<span class="header-section-number">7.9</span> Diversité fonctionnelle de Chiu et Chao<a class="anchor" aria-label="anchor" href="#diversit%C3%A9-fonctionnelle-de-chiu-et-chao"><i class="fas fa-link"></i></a>
</h2>
<p><span class="citation">Chiu et Chao (<a href="references.html#ref-Chiu2014b">2014</a>)</span> proposent de pondérer l’entropie quadratique par la distance entre les paires d’espèces et obtiennent un nombre de Hill permettant de mesurer la diversité fonctionnelle à partir d’une matrice de dissimilarité :</p>
<p><span class="math display" id="eq:Chiu2014bDq">\[\begin{equation}
  \tag{7.25}
  ^{q}\!D\left(Q\right)
  = \left[\sum_s{\sum_t{\frac{\delta_{s,t}}{Q}\left(p_s p_t\right)^q}}\right]^\frac{1}{2\left(1-q\right)};
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Chiu2014bD1">\[\begin{equation}
  \tag{7.26}
  ^{1}\!D\left(Q\right)
  = e^{\frac{1}{2}\left[\sum_s{\sum_t{p_s p_t\frac{\delta_{s,t}}{Q}\ln{p_s p_t}}}\right]}.
\end{equation}\]</span></p>
<p>La notation <span class="math inline">\(^{q}\!D(Q)\)</span> fait référence à l’entropie quadratique <span class="math inline">\(Q = {^{2}\!\bar{H}}(T)\)</span>.
Une approche complémentaire est développée ci-dessous.
Chiu et Chao notent que <span class="math inline">\(\mathit{{GS}_{D}} = Q - ^{q}\!D(Q)\)</span>.</p>
<p>La définition de Chiu et Chao revient à calculer l’entropie des paires d’individus à partir de la fonction d’information
<span class="math display">\[I(p_s p_t) = \ln_q[\frac{(\frac{\delta_{s,t}}{Q})^{\frac{1}{1-q}}}{p_s p_t}]\]</span>
pour <span class="math inline">\(q \ne 1\)</span> et
<span class="math display">\[I(p_s p_t) = \ln[\frac{1}{(p_s p_t)^{\frac{\delta_{s,t}}{Q}}}]\]</span>
pour <span class="math inline">\(q=1\)</span>.
Le nombre effectif de paires est <span class="math inline">\([^{q}\!D(Q)]^2\)</span>. Le nombre effectif d’espèces est donc <span class="math inline">\(^{q}\!D(Q)\)</span>.</p>
<p>Le nombre effectif de paires est le nombres de paires équifréquentes dont la distance entre les deux espèces est <span class="math inline">\(Q\)</span>. Le problème de cette approche est que les paires constituées de la même espèce doivent aussi avoir une distance <span class="math inline">\(\delta_{s,s}\)</span> égale à <span class="math inline">\(Q\)</span>. Chiu et Chao considèrent ce point comme la possibilité de prendre en compte la variabilité intraspécifique, mais elle doit être identique à la variabilité interspécifique, ce qui n’est pas très convaincant. En absence de variabilité intraspécifique, Chiu et Chao redéfinissent la distance de référence : <span class="math inline">\(\delta_{s,s}=0\)</span> et <span class="math inline">\(\delta_{s,t}=(\frac{D}{D-1})Q\)</span>. Il n’est donc pas possible de comparer le nombre effectif d’espèces de deux communautés différentes puisque la définition même du nombre effectif dépend de la diversité, ce qui invalide cette définition de la diversité fonctionnelle.</p>
<p>Enfin, cette définition de la diversité ne respecte pas le principe de <span class="citation">Solow, Polasky, et Broadus (<a href="references.html#ref-Solow1993">1993</a>)</span> selon lequel le remplacement d’une partie des effectifs d’une espèce par le même nombre d’individus d’une espèce différente mais fonctionnellement identique ne doit pas faire varier la diversité <span class="citation">(<a href="references.html#ref-Botta-Dukat2017">Botta-Dukát 2018</a>)</span>.</p>
</div>
<div id="sec-HpI1" class="section level2" number="7.10">
<h2>
<span class="header-section-number">7.10</span> <span class="math inline">\(H_p\)</span> et <span class="math inline">\(I_1\)</span><a class="anchor" aria-label="anchor" href="#sec-HpI1"><i class="fas fa-link"></i></a>
</h2>
<p>Simultanément, <span class="citation">Pavoine, Love, et Bonsall (<a href="references.html#ref-Pavoine2009a">2009</a>)</span> et <span class="citation">Allen, Kon, et Bar-Yam (<a href="references.html#ref-Allen2009">2009</a>)</span> ont proposé la généralisation de l’indice de Shannon à la diversité phylogénétique.
La présentation de Allen et al. est donnée ici, celle de Pavoine et al., plus générale, sera détaillée dans le paragraphe suivant.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ArbreA2"></span>
<img src="images/ArbreA.png" alt="Arbre phylogénétique ou fonctionnel hypothétique." width="80%"><p class="caption">
Figure 7.12: Arbre phylogénétique ou fonctionnel hypothétique.
</p>
</div>
<p></p>
<p>Étant donné une phylogénie, comme celle de la figure <a href="mesures-particuli%C3%A8res.html#fig:ArbreA2">7.12</a>, on définit une branche <span class="math inline">\(b_{k,l}\)</span> comme un segment terminé par une feuille (au bas de l’arbre) ou un noeud (dans l’arbre).
<span class="math inline">\(k\)</span> indique la période de l’arbre à laquelle la branche se termine, <span class="math inline">\(l\)</span> le numéro d’ordre.
Une branche n’existe que si elle se termine effectivement par un noeud ou une feuille : il n’y a pas de branche <span class="math inline">\(b_{2,1}\)</span> par exemple.
Sa probabilité <span class="math inline">\(p(b_{k,l})\)</span> est la somme des probabilités des feuilles de la branche, c’est-à-dire <span class="math inline">\(u_{k,l}\)</span>, et <span class="math inline">\(l(b)\)</span> est sa longueur.
Sur la figure, la branche commençant en haut de l’arbre et se terminant au noeud réunissant les espèces 3 à 5 a une valeur <span class="math inline">\(p(b_{2,3})\)</span> égale à la somme des probabilités d’occurrence des espèces 3 à 5 alors que <span class="math inline">\(p(b_{1,1})\)</span> est seulement la probabilité de l’espèce 1.
Leurs longueurs respectives sont <span class="math inline">\(T_2+T_3\)</span> et <span class="math inline">\(T_1+T_2\)</span>.
L’arbre possède 7 branches.</p>
<p>L’indice d’entropie phylogénétique est</p>
<p><span class="math display" id="eq:Hp">\[\begin{equation}
  \tag{7.27}
  H_p =-\sum_{b}{l(b)p(b)\ln{p}(b)}.
\end{equation}\]</span></p>
<p>Dans un arbre parfaitement régulier, toutes les branches sont de longueur 1 et <span class="math inline">\(H_p\)</span> est l’indice de Shannon.</p>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="chap-cadrephyfonc.html"><span class="header-section-number">6</span> Cadre</a></div>
<div class="next"><a href="chap-Phyloentropie.html"><span class="header-section-number">8</span> Entropie phylogénétique</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#mesures-particuli%C3%A8res"><span class="header-section-number">7</span> Mesures particulières</a></li>
<li>
<a class="nav-link" href="#richesse-%C3%A9quitabilit%C3%A9-et-divergence-fonctionnelle"><span class="header-section-number">7.1</span> Richesse, équitabilité et divergence fonctionnelle</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#richesse-fonctionnelle"><span class="header-section-number">7.1.1</span> Richesse fonctionnelle</a></li>
<li><a class="nav-link" href="#equitabilit%C3%A9-fonctionnelle"><span class="header-section-number">7.1.2</span> Equitabilité fonctionnelle</a></li>
<li><a class="nav-link" href="#divergence-fonctionnelle"><span class="header-section-number">7.1.3</span> Divergence fonctionnelle</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#originalit%C3%A9-richesse-et-%C3%A9quitabilit%C3%A9-phylog%C3%A9n%C3%A9tique"><span class="header-section-number">7.2</span> Originalité, richesse et équitabilité phylogénétique</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#mesures-sp%C3%A9cifiques-doriginalit%C3%A9"><span class="header-section-number">7.2.1</span> Mesures spécifiques d’originalité</a></li>
<li><a class="nav-link" href="#sec-OrigTax"><span class="header-section-number">7.2.2</span> Originalité taxonomique de Ricotta</a></li>
<li><a class="nav-link" href="#richesse-phylog%C3%A9n%C3%A9tique"><span class="header-section-number">7.2.3</span> Richesse phylogénétique</a></li>
<li><a class="nav-link" href="#indices-de-cadotte"><span class="header-section-number">7.2.4</span> Indices de Cadotte</a></li>
</ul>
</li>
<li><a class="nav-link" href="#diversit%C3%A9-de-scheiner"><span class="header-section-number">7.3</span> Diversité de Scheiner</a></li>
<li><a class="nav-link" href="#diversit%C3%A9-de-solow-et-polasky"><span class="header-section-number">7.4</span> Diversité de Solow et Polasky</a></li>
<li><a class="nav-link" href="#sec-PDFD"><span class="header-section-number">7.5</span> FD et PD</a></li>
<li>
<a class="nav-link" href="#sec-Rao"><span class="header-section-number">7.6</span> Indice de Rao</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#principe"><span class="header-section-number">7.6.1</span> Principe</a></li>
<li><a class="nav-link" href="#formalisation"><span class="header-section-number">7.6.2</span> Formalisation</a></li>
<li><a class="nav-link" href="#propri%C3%A9t%C3%A9s"><span class="header-section-number">7.6.3</span> Propriétés</a></li>
<li><a class="nav-link" href="#calcul-sous-r"><span class="header-section-number">7.6.4</span> Calcul sous R</a></li>
<li><a class="nav-link" href="#sec-MaxTheorique"><span class="header-section-number">7.6.5</span> Maximum théorique</a></li>
</ul>
</li>
<li><a class="nav-link" href="#diversit%C3%A9-et-moyenne"><span class="header-section-number">7.7</span> Diversité et moyenne</a></li>
<li><a class="nav-link" href="#variations-sur-lentropie-quadratique"><span class="header-section-number">7.8</span> Variations sur l’entropie quadratique</a></li>
<li><a class="nav-link" href="#diversit%C3%A9-fonctionnelle-de-chiu-et-chao"><span class="header-section-number">7.9</span> Diversité fonctionnelle de Chiu et Chao</a></li>
<li><a class="nav-link" href="#sec-HpI1"><span class="header-section-number">7.10</span> \(H_p\) et \(I_1\)</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/EricMarcon/MesuresBioDiv2/blob/master/03-Phylodiversite.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/EricMarcon/MesuresBioDiv2/edit/master/03-Phylodiversite.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Mesures de la Biodiversité</strong>" was written by Eric Marcon. It was last built on 01/02/2025.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
